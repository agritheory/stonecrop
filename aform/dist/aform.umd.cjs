(function(m,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(m=typeof globalThis<"u"?globalThis:m||self,n(m["@agritheory/aform"]={},m.Vue))})(this,function(m,n){"use strict";const ne={id:"checkbox-container"},oe=["id","readonly","required"],le={id:"custom-checkbox"},ae=["for"],re=["innerHTML"],se=n.defineComponent({__name:"ACheckbox",props:{label:null,value:null,required:{type:Boolean},readOnly:{type:Boolean},uuid:null,validation:{default:()=>({errorMessage:"&nbsp;"})}},emits:["update:value"],setup(e,{emit:t}){const l=e,o=n.computed({get(){return l.value},set(a){t("update:value",a)}});return(a,r)=>(n.openBlock(),n.createElementBlock("div",null,[n.createElementVNode("label",ne,[n.withDirectives(n.createElementVNode("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>n.isRef(o)?o.value=s:null),type:"checkbox",id:e.uuid,class:"checkbox",readonly:e.readOnly,required:e.required},null,8,oe),[[n.vModelCheckbox,n.unref(o)]]),n.createElementVNode("span",le,n.toDisplayString(n.unref(o)),1)]),n.createElementVNode("label",{for:e.uuid,id:"checkbox-label"},n.toDisplayString(e.label),9,ae),n.withDirectives(n.createElementVNode("p",{innerHTML:e.validation.errorMessage},null,8,re),[[n.vShow,e.validation.errorMessage]])]))}}),Je="",E=(e,t)=>{const l=e.__vccOpts||e;for(const[o,a]of t)l[o]=a;return l},S=E(se,[["__scopeId","data-v-743cd4db"]]),ce=n.createElementVNode("div",null,[n.createElementVNode("input",{type:"text"}),n.createElementVNode("input",{type:"text"}),n.createElementVNode("input",{type:"text"})],-1),V=n.defineComponent({__name:"AComboBox",props:["event","cellData","tableID"],setup(e){return(t,l)=>{const o=n.resolveComponent("ATableModal");return n.openBlock(),n.createBlock(o,{event:e.event,cellData:e.cellData,class:"amodal"},{default:n.withCtx(()=>[ce]),_:1},8,["event","cellData"])}}});var B;const O=typeof window<"u",ie=e=>typeof e=="string",de=()=>{};O&&(B=window==null?void 0:window.navigator)!=null&&B.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function L(e){return typeof e=="function"?e():n.unref(e)}function ue(e){return e}function fe(e){return n.getCurrentScope()?(n.onScopeDispose(e),!0):!1}function C(e){var t;const l=L(e);return(t=l==null?void 0:l.$el)!=null?t:l}const N=O?window:void 0;function pe(...e){let t,l,o,a;if(ie(e[0])||Array.isArray(e[0])?([l,o,a]=e,t=N):[t,l,o,a]=e,!t)return de;Array.isArray(l)||(l=[l]),Array.isArray(o)||(o=[o]);const r=[],s=()=>{r.forEach(f=>f()),r.length=0},c=(f,_,g,u)=>(f.addEventListener(_,g,u),()=>f.removeEventListener(_,g,u)),i=n.watch(()=>[C(t),L(a)],([f,_])=>{s(),f&&r.push(...l.flatMap(g=>o.map(u=>c(f,g,u,_))))},{immediate:!0,flush:"post"}),d=()=>{i(),s()};return fe(d),d}const $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F="__vueuse_ssr_handlers__";$[F]=$[F]||{};function me(e,{window:t=N,scrollTarget:l}={}){const o=n.ref(!1),a=()=>{if(!t)return;const r=t.document,s=C(e);if(!s)o.value=!1;else{const c=s.getBoundingClientRect();o.value=c.top<=(t.innerHeight||r.documentElement.clientHeight)&&c.left<=(t.innerWidth||r.documentElement.clientWidth)&&c.bottom>=0&&c.right>=0}};return n.watch(()=>C(e),()=>a(),{immediate:!0,flush:"post"}),t&&pe(l||t,"scroll",a,{capture:!1,passive:!0}),o}var P;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(P||(P={}));var ye=Object.defineProperty,H=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,q=(e,t,l)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,be=(e,t)=>{for(var l in t||(t={}))ge.call(t,l)&&q(e,l,t[l]);if(H)for(var l of H(t))he.call(t,l)&&q(e,l,t[l]);return e};be({linear:ue},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const h=e=>{let t=me(e).value;return t=t&&e.offsetHeight>0,t},b=e=>e.tabIndex>=0,R=e=>{const t=e.target;return A(t)},A=e=>{var t;let l;if(e instanceof HTMLTableCellElement){const o=(t=e.parentElement)==null?void 0:t.previousElementSibling;if(o){const a=Array.from(o.children)[e.cellIndex];a&&(l=a)}}else if(e instanceof HTMLTableRowElement){const o=e.previousElementSibling;o&&(l=o)}return l&&(!b(l)||!h(l))?A(l):l},_e=e=>{var t;const l=e.target;let o;if(l instanceof HTMLTableCellElement){const a=(t=l.parentElement)==null?void 0:t.parentElement;if(a){const r=a.firstElementChild.children[l.cellIndex];r&&(o=r)}}else if(l instanceof HTMLTableRowElement){const a=l.parentElement;if(a){const r=a.firstElementChild;r&&(o=r)}}return o&&(!b(o)||!h(o))?I(o):o},U=e=>{const t=e.target;return I(t)},I=e=>{var t;let l;if(e instanceof HTMLTableCellElement){const o=(t=e.parentElement)==null?void 0:t.nextElementSibling;if(o){const a=Array.from(o.children)[e.cellIndex];a&&(l=a)}}else if(e instanceof HTMLTableRowElement){const o=e.nextElementSibling;o&&(l=o)}return l&&(!b(l)||!h(l))?I(l):l},ke=e=>{var t;const l=e.target;let o;if(l instanceof HTMLTableCellElement){const a=(t=l.parentElement)==null?void 0:t.parentElement;if(a){const r=a.lastElementChild.children[l.cellIndex];r&&(o=r)}}else if(l instanceof HTMLTableRowElement){const a=l.parentElement;if(a){const r=a.lastElementChild;r&&(o=r)}}return o&&(!b(o)||!h(o))?A(o):o},j=e=>{const t=e.target;return v(t)},v=e=>{var t;let l;if(e.previousElementSibling)l=e.previousElementSibling;else{const o=(t=e.parentElement)==null?void 0:t.previousElementSibling;l=o==null?void 0:o.lastElementChild}return l&&(!b(l)||!h(l))?v(l):l},Q=e=>{const t=e.target;return T(t)},T=e=>{var t;let l;if(e.nextElementSibling)l=e.nextElementSibling;else{const o=(t=e.parentElement)==null?void 0:t.nextElementSibling;l=o==null?void 0:o.firstElementChild}return l&&(!b(l)||!h(l))?T(l):l},Y=e=>{const t=e.target.parentElement.firstElementChild;return t&&(!b(t)||!h(t))?T(t):t},W=e=>{const t=e.target.parentElement.lastElementChild;return t&&(!b(t)||!h(t))?v(t):t},x=["alt","control","shift","meta"],Ee={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"},z={"keydown.up":e=>{const t=R(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.down":e=>{const t=U(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.left":e=>{const t=j(e);e.preventDefault(),e.stopPropagation(),t&&t.focus()},"keydown.right":e=>{const t=Q(e);e.preventDefault(),e.stopPropagation(),t&&t.focus()},"keydown.control.up":e=>{const t=_e(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.control.down":e=>{const t=ke(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.control.left":e=>{const t=Y(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.control.right":e=>{const t=W(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.end":e=>{const t=W(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.enter":e=>{if(e.target instanceof HTMLTableCellElement){e.preventDefault(),e.stopPropagation();const t=U(e);t&&t.focus()}},"keydown.shift.enter":e=>{if(e.target instanceof HTMLTableCellElement){e.preventDefault(),e.stopPropagation();const t=R(e);t&&t.focus()}},"keydown.home":e=>{const t=Y(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.tab":e=>{const t=Q(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())},"keydown.shift.tab":e=>{const t=j(e);t&&(e.preventDefault(),e.stopPropagation(),t.focus())}};function we(e){const t=o=>{let a=null;o.parent&&(typeof o.parent=="string"?a=document.querySelector(o.parent):o.parent instanceof Element?a=o.parent:a=o.parent.value);let r=[];if(o.selectors)if(typeof o.selectors=="string")r=a?Array.from(a.querySelectorAll(o.selectors)):Array.from(document.querySelectorAll(o.selectors));else if(o.selectors instanceof Element)r.push(o.selectors);else if(Array.isArray(o.selectors.value))for(const s of o.selectors.value)s instanceof Element?r.push(s):r.push(s.$el);else r.push(o.selectors.value);else r=Array.from(a.children).filter(s=>b(s)&&h(s));return r},l=o=>a=>{const r=Ee[a.key]||a.key.toLowerCase();if(x.includes(r))return;const s=o.handlers||z;for(const c of Object.keys(s)){const[i,...d]=c.split(".");if(i==="keydown"&&d.includes(r)){const f=s[c],_=d.filter(u=>x.includes(u)),g=x.some(u=>{const D=u.charAt(0).toUpperCase()+u.slice(1);return a.getModifierState(D)});if(_.length>0){if(g){for(const u of x)if(d.includes(u)){const D=u.charAt(0).toUpperCase()+u.slice(1);a.getModifierState(D)&&f(a)}}}else g||f(a)}}};n.onMounted(()=>{for(const o of e){const a=t(o);for(const r of a)r.addEventListener("keydown",l(o))}}),n.onBeforeUnmount(()=>{for(const o of e){const a=t(o);for(const r of a)r.removeEventListener("keydown",l(o))}})}const De=["event","colIndex","rowIndex","tableid"],xe={colspan:"5"},Ce=["onClick"],Ae=n.defineComponent({__name:"ADate",props:{colIndex:null,rowIndex:null,tableid:null,event:null,indent:null,readonly:{type:Boolean}},setup(e){const t=e,l=n.inject(t.tableid),o=6,a=7,r=new Date,s=n.ref(),c=n.ref(),i=n.ref(),d=n.ref([]);n.onMounted(async()=>{let p=l.cellData(t.colIndex,t.rowIndex);p?(p instanceof Date||(p=new Date(p)),s.value=p,c.value=s.value.getMonth(),i.value=s.value.getFullYear()):(c.value=r.getMonth(),i.value=r.getFullYear()),f(),await n.nextTick();const w=document.getElementsByClassName("selecteddate");if(w.length>0)w[0].focus();else{const y=document.getElementsByClassName("todaysdate");y.length>0&&y[0].focus()}}),n.watch([c,i],()=>{f()});const f=()=>{d.value=[];const p=new Date(i.value,c.value,1),w=p.getDay(),y=p.setDate(p.getDate()-w);for(let k of Array(43).keys())d.value.push(y+k*864e5)},_=()=>{i.value-=1},g=()=>{i.value+=1},u=()=>{c.value==0?(c.value=11,_()):c.value-=1},D=()=>{c.value==11?(c.value=0,g()):c.value+=1},ee=p=>{if(c.value===r.getMonth())return r.toDateString()===new Date(p).toDateString()},te=p=>new Date(p).toDateString()===new Date(s.value).toDateString(),Ye=(p,w)=>{s.value=new Date(d.value[w]),We()},We=()=>{l.setCellData(t.rowIndex,t.colIndex,s.value.getTime())},ze=n.computed(()=>new Date(i.value,c.value,1).toLocaleDateString(void 0,{year:"numeric",month:"long"}));return we([{parent:"table.adate",selectors:"td",handlers:{...z,"keydown.pageup":u,"keydown.shift.pageup":_,"keydown.pagedown":D,"keydown.shift.pagedown":g}}]),(p,w)=>e.readonly?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,event:e.event,colIndex:e.colIndex,rowIndex:e.rowIndex,tableid:e.tableid,class:"adate",tabindex:"0",ref:"adatepicker"},[n.createElementVNode("table",null,[n.createElementVNode("tr",null,[n.createElementVNode("td",{onClick:u,tabindex:-1},"<"),n.createElementVNode("th",xe,n.toDisplayString(n.unref(ze)),1),n.createElementVNode("td",{onClick:D,tabindex:-1},">")]),(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(o,y=>n.createElementVNode("tr",{key:y},[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(a,k=>n.createElementVNode("td",{key:(y-1)*a+k,contenteditable:!1,spellcheck:!1,tabindex:0,style:n.normalizeStyle({border:te(d.value[(y-1)*a+k])?"2px solid var(--focus-cell-outline)":"none",borderBottomColor:ee(d.value[(y-1)*a+k])?"var(--focus-cell-outline)":"none"}),onClick:n.withModifiers(Ge=>Ye(Ge,(y-1)*a+k),["prevent","stop"]),class:n.normalizeClass({todaysdate:ee(d.value[(y-1)*a+k]),selecteddate:te(d.value[(y-1)*a+k])})},n.toDisplayString(new Date(d.value[(y-1)*a+k]).getDate()),15,Ce)),64))])),64))])],8,De))}}),Xe="",G=E(Ae,[["__scopeId","data-v-fcdc102d"]]),Ie=n.defineComponent({__name:"CollapseButton",props:{collapsed:{type:Boolean}},setup(e){return(t,l)=>(n.openBlock(),n.createElementBlock("button",{class:n.normalizeClass(["collapse-button",e.collapsed?"rotated":"unrotated"])},"×",2))}}),Ze="",ve=E(Ie,[["__scopeId","data-v-6f1c1b45"]]),Te=n.defineComponent({__name:"AForm",props:{modelValue:null,data:null,readonly:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=n.ref(l.data||{}),a=s=>{let c={};for(const[i,d]of Object.entries(s))["component","fieldtype"].includes(i)||(c[i]=d),i==="rows"&&d&&d.length===0&&(c.rows=o.value[s.fieldname]);return c},r=n.computed({get:()=>l.modelValue.map((s,c)=>n.computed({get(){return s.value},set:i=>{l.modelValue[c].value=i,t("update:modelValue",l.modelValue)}})),set:()=>{}});return(s,c)=>(n.openBlock(),n.createElementBlock("form",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(e.modelValue,(i,d)=>(n.openBlock(),n.createBlock(n.resolveDynamicComponent(i.component),n.mergeProps({key:d,schema:i,modelValue:n.unref(r)[d].value,"onUpdate:modelValue":f=>n.unref(r)[d].value=f,data:o.value[i.fieldname],readonly:e.readonly},a(i)),null,16,["schema","modelValue","onUpdate:modelValue","data","readonly"]))),128))]))}}),et="",M=E(Te,[["__scopeId","data-v-74d66cf2"]]),Me=n.defineComponent({__name:"AFieldset",props:{schema:null,label:null,collapsible:{type:Boolean},data:null},setup(e){const t=e,l=n.ref(t.data||[]);let o=n.ref(!1),a=n.ref(t.collapsible);const r=n.ref(t.schema);function s(c){c.preventDefault(),a.value&&(o.value=!o.value)}return(c,i)=>(n.openBlock(),n.createElementBlock("fieldset",null,[n.createElementVNode("legend",{onClick:s,onSubmit:s},[n.createTextVNode(n.toDisplayString(e.label)+" ",1),n.unref(a)?(n.openBlock(),n.createBlock(ve,{key:0,collapsed:n.unref(o)},null,8,["collapsed"])):n.createCommentVNode("",!0)],32),n.renderSlot(c.$slots,"default",{collapsed:n.unref(o)},()=>[n.withDirectives(n.createVNode(M,{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=d=>r.value=d),data:l.value},null,8,["modelValue","data"]),[[n.vShow,!n.unref(o)]])],!0)]))}}),tt="",J=E(Me,[["__scopeId","data-v-cad9b578"]]),Se=["id","disabled","required"],Ve=["for"],Be=["innerHTML"],Oe=n.defineComponent({__name:"ANumericInput",props:{label:null,modelValue:null,required:{type:Boolean},readonly:{type:Boolean},uuid:null,validation:{default:()=>({errorMessage:"&nbsp;"})}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=n.computed({get:()=>l.modelValue,set:a=>{t("update:modelValue",a)}});return(a,r)=>(n.openBlock(),n.createElementBlock("div",null,[n.withDirectives(n.createElementVNode("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>n.isRef(o)?o.value=s:null),type:"number",id:e.uuid,disabled:e.readonly,required:e.required},null,8,Se),[[n.vModelText,n.unref(o)]]),n.createElementVNode("label",{for:e.uuid},n.toDisplayString(e.label),9,Ve),n.withDirectives(n.createElementVNode("p",{innerHTML:e.validation.errorMessage},null,8,Be),[[n.vShow,e.validation.errorMessage]])]))}}),nt="",K=E(Oe,[["__scopeId","data-v-be33e6c4"]]),X={date:"##/##/####",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"};function Le(e){try{return Function(`"use strict";return (${e})`)()}catch{}}function Ne(e){var l;let t=e.value;if(t){const o=Le(t);if(o){const a=e.instance.locale;t=o(a)}}else{const a=(l=e.instance.schema.fieldtype)==null?void 0:l.toLowerCase();a&&X[a]&&(t=X[a])}return t}function $e(e,t){t||(t="#");let l=e;const o=[t,"/","-","(",")"," "];for(const a of o)l=l.replaceAll(a,"");return l}function Fe(e,t,l){l||(l="#");let o=t;for(const a of e){const r=o.indexOf(l);if(r!==-1){const s=o.substring(0,r),c=o.substring(r+1);o=s+a+c}}return o.slice(0,t.length)}function Pe(e,t){const l=Ne(t);if(!l)return;const o="#",a=e.value,r=$e(a,o);if(r){const s=Fe(r,l,o);t.instance.maskFilled&&(t.instance.maskFilled=!s.includes(o)),e.value=s}else e.value=l}const He=n.defineComponent({name:"ATextInput",props:{schema:{type:Object,required:!0},label:{type:String,required:!0},modelValue:{type:null},mask:{type:String},required:{type:Boolean},readonly:{type:Boolean},uuid:{type:String},validation:{type:Object,default:()=>({errorMessage:"&nbsp;"})}},setup(e,t){const l=n.ref(!1),o=n.inject("locale","");return{inputText:n.computed({get(){return e.modelValue},set(r){t.emit("update:modelValue",r)}}),locale:o,maskFilled:l}},directives:{mask:Pe}}),ot="",qe=["id","disabled","maxlength","required"],Re=["for"],Ue=["innerHTML"];function je(e,t,l,o,a,r){const s=n.resolveDirective("mask");return n.openBlock(),n.createElementBlock("div",null,[n.withDirectives(n.createElementVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.inputText=c),id:e.uuid,disabled:e.readonly,maxlength:e.mask?e.maskFilled&&e.mask.length:void 0,required:e.required},null,8,qe),[[n.vModelText,e.inputText],[s,e.mask]]),n.createElementVNode("label",{for:e.uuid},n.toDisplayString(e.label),9,Re),n.withDirectives(n.createElementVNode("p",{innerHTML:e.validation.errorMessage},null,8,Ue),[[n.vShow,e.validation.errorMessage]])])}const Z=E(He,[["render",je],["__scopeId","data-v-76dba9b8"]]);function Qe(e){e.component("ACheckbox",S),e.component("ACombobox",V),e.component("ADate",G),e.component("AFieldset",J),e.component("AForm",M),e.component("ANumericInput",K),e.component("ATextInput",Z)}m.ACheckbox=S,m.AComboBox=V,m.ADate=G,m.AFieldset=J,m.AForm=M,m.ANumericInput=K,m.ATextInput=Z,m.install=Qe,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=aform.umd.cjs.map
