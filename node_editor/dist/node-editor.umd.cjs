(function(de,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(de=typeof globalThis<"u"?globalThis:de||self,r(de["@agritheory/node_editor"]={},de.Vue))})(this,function(de,r){"use strict";var wr=Object.defineProperty,br=(e,t,n)=>t in e?wr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pt=(e,t,n)=>(br(e,typeof t!="symbol"?t+"":t,n),n),xn;const _n=typeof window<"u",xr=e=>typeof e<"u",_r=e=>typeof e=="boolean",me=e=>typeof e=="function",kr=e=>typeof e=="number",tt=e=>typeof e=="string",Er=()=>{};_n&&((xn=window==null?void 0:window.navigator)!=null&&xn.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Se(e){return typeof e=="function"?e():r.unref(e)}function Nr(e,t){function n(...o){e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})}return n}const kn=e=>e();function Sr(e=kn){const t=r.ref(!0);function n(){t.value=!1}function o(){t.value=!0}return{isActive:t,pause:n,resume:o,eventFilter:(...a)=>{t.value&&e(...a)}}}function En(e,t=!1,n="Timeout"){return new Promise((o,a)=>{setTimeout(t?()=>a(n):o,e)})}function Cr(e){return e}function Nn(e,t){let n,o,a;const l=r.ref(!0),i=()=>{l.value=!0,a()};r.watch(e,i,{flush:"sync"});const s=me(t)?t:t.get,u=me(t)?void 0:t.set,c=r.customRef((d,f)=>(o=d,a=f,{get(){return l.value&&(n=s(),l.value=!1),o(),n},set(h){u==null||u(h)}}));return Object.isExtensible(c)&&(c.trigger=i),c}function L(){const e=[],t=n=>{const o=e.indexOf(n);o!==-1&&e.splice(o,1)};return{on:n=>(e.push(n),{off:()=>t(n)}),off:t,trigger:n=>{e.forEach(o=>o(n))}}}function Ve(e){return r.getCurrentScope()?(r.onScopeDispose(e),!0):!1}function Sn(e,t=!0){r.getCurrentInstance()?r.onMounted(e):t?e():r.nextTick(e)}function Rt(e,t=!1){function n(f,{flush:h="sync",deep:g=!1,timeout:x,throwOnTimeout:E}={}){let N=null;const y=[new Promise(b=>{N=r.watch(e,$=>{f($)!==t&&(N==null||N(),b($))},{flush:h,deep:g,immediate:!0})})];return x!=null&&y.push(En(x,E).then(()=>Se(e)).finally(()=>N==null?void 0:N())),Promise.race(y)}function o(f,h){if(!r.isRef(f))return n($=>$===f,h);const{flush:g="sync",deep:x=!1,timeout:E,throwOnTimeout:N}=h??{};let y=null;const b=[new Promise($=>{y=r.watch([e,f],([w,P])=>{t!==(w===P)&&(y==null||y(),$(w))},{flush:g,deep:x,immediate:!0})})];return E!=null&&b.push(En(E,N).then(()=>Se(e)).finally(()=>(y==null||y(),Se(e)))),Promise.race(b)}function a(f){return n(h=>!!h,f)}function l(f){return o(null,f)}function i(f){return o(void 0,f)}function s(f){return n(Number.isNaN,f)}function u(f,h){return n(g=>{const x=Array.from(g);return x.includes(f)||x.includes(Se(f))},h)}function c(f){return d(1,f)}function d(f=1,h){let g=-1;return n(()=>(g+=1,g>=f),h)}return Array.isArray(Se(e))?{toMatch:n,toContains:u,changed:c,changedTimes:d,get not(){return Rt(e,!t)}}:{toMatch:n,toBe:o,toBeTruthy:a,toBeNull:l,toBeNaN:s,toBeUndefined:i,changed:c,changedTimes:d,get not(){return Rt(e,!t)}}}function Ce(e){return Rt(e)}var Cn=Object.getOwnPropertySymbols,Mr=Object.prototype.hasOwnProperty,Br=Object.prototype.propertyIsEnumerable,Pr=(e,t)=>{var n={};for(var o in e)Mr.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&Cn)for(var o of Cn(e))t.indexOf(o)<0&&Br.call(e,o)&&(n[o]=e[o]);return n};function Rr(e,t,n={}){const o=n,{eventFilter:a=kn}=o,l=Pr(o,["eventFilter"]);return r.watch(e,Nr(a,t),l)}var $r=Object.defineProperty,zr=Object.defineProperties,Tr=Object.getOwnPropertyDescriptors,nt=Object.getOwnPropertySymbols,Mn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,Pn=(e,t,n)=>t in e?$r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ir=(e,t)=>{for(var n in t||(t={}))Mn.call(t,n)&&Pn(e,n,t[n]);if(nt)for(var n of nt(t))Bn.call(t,n)&&Pn(e,n,t[n]);return e},Vr=(e,t)=>zr(e,Tr(t)),Or=(e,t)=>{var n={};for(var o in e)Mn.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&nt)for(var o of nt(e))t.indexOf(o)<0&&Bn.call(e,o)&&(n[o]=e[o]);return n};function Me(e,t,n={}){const o=n,{eventFilter:a}=o,l=Or(o,["eventFilter"]),{eventFilter:i,pause:s,resume:u,isActive:c}=Sr(a);return{stop:Rr(e,t,Vr(Ir({},l),{eventFilter:i})),pause:s,resume:u,isActive:c}}function Rn(e){var t;const n=Se(e);return(t=n==null?void 0:n.$el)!=null?t:n}const $t=_n?window:void 0;function zt(...e){let t,n,o,a;if(tt(e[0])||Array.isArray(e[0])?([n,o,a]=e,t=$t):[t,n,o,a]=e,!t)return Er;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const l=[],i=()=>{l.forEach(d=>d()),l.length=0},s=(d,f,h)=>(d.addEventListener(f,h,a),()=>d.removeEventListener(f,h,a)),u=r.watch(()=>Rn(t),d=>{i(),d&&l.push(...n.flatMap(f=>o.map(h=>s(d,f,h))))},{immediate:!0,flush:"post"}),c=()=>{u(),i()};return Ve(c),c}const Ar=e=>typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0;function $n(...e){let t,n,o={};e.length===3?(t=e[0],n=e[1],o=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,n=e[0],o=e[1]):(t=e[0],n=e[1]):(t=!0,n=e[0]);const{target:a=$t,eventName:l="keydown",passive:i=!1}=o,s=Ar(t);return zt(a,l,u=>{s(u)&&n(u)},i)}function Dr(e,t=null){const n=r.getCurrentInstance();let o=()=>{};const a=r.customRef((l,i)=>(o=i,{get(){var s,u;return l(),(u=(s=n==null?void 0:n.proxy)==null?void 0:s.$refs[e])!=null?u:t},set(){}}));return Sn(o),r.onUpdated(o),a}function Xr(e,t=!1){const n=r.ref(),o=()=>n.value=!!e();return o(),Sn(o,t),n}function Lr(e){return JSON.parse(JSON.stringify(e))}const zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Tn="__vueuse_ssr_handlers__";zn[Tn]=zn[Tn]||{};var In=Object.getOwnPropertySymbols,Hr=Object.prototype.hasOwnProperty,jr=Object.prototype.propertyIsEnumerable,Yr=(e,t)=>{var n={};for(var o in e)Hr.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&In)for(var o of In(e))t.indexOf(o)<0&&jr.call(e,o)&&(n[o]=e[o]);return n};function Fr(e,t,n={}){const o=n,{window:a=$t}=o,l=Yr(o,["window"]);let i;const s=Xr(()=>a&&"ResizeObserver"in a),u=()=>{i&&(i.disconnect(),i=void 0)},c=r.watch(()=>Rn(e),f=>{u(),s.value&&a&&f&&(i=new ResizeObserver(t),i.observe(f,l))},{immediate:!0,flush:"post"}),d=()=>{u(),c()};return Ve(d),{isSupported:s,stop:d}}var Vn;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Vn||(Vn={}));var Ur=Object.defineProperty,On=Object.getOwnPropertySymbols,Zr=Object.prototype.hasOwnProperty,Wr=Object.prototype.propertyIsEnumerable,An=(e,t,n)=>t in e?Ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kr=(e,t)=>{for(var n in t||(t={}))Zr.call(t,n)&&An(e,n,t[n]);if(On)for(var n of On(t))Wr.call(t,n)&&An(e,n,t[n]);return e};Kr({linear:Cr},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});function Oe(e,t,n,o={}){var a,l,i;const{clone:s=!1,passive:u=!1,eventName:c,deep:d=!1,defaultValue:f}=o,h=r.getCurrentInstance(),g=n||(h==null?void 0:h.emit)||((a=h==null?void 0:h.$emit)==null?void 0:a.bind(h))||((i=(l=h==null?void 0:h.proxy)==null?void 0:l.$emit)==null?void 0:i.bind(h==null?void 0:h.proxy));let x=c;t||(t="modelValue"),x=c||x||`update:${t.toString()}`;const E=y=>s?me(s)?s(y):Lr(y):y,N=()=>xr(e[t])?E(e[t]):f;if(u){const y=N(),b=r.ref(y);return r.watch(()=>e[t],$=>b.value=E($)),r.watch(b,$=>{($!==e[t]||d)&&g(x,$)},{deep:d}),b}else return r.computed({get(){return N()},set(y){g(x,y)}})}const Gr=()=>({edgesChange:L(),nodesChange:L(),nodeDoubleClick:L(),nodeClick:L(),nodeMouseEnter:L(),nodeMouseMove:L(),nodeMouseLeave:L(),nodeContextMenu:L(),nodeDragStart:L(),nodeDrag:L(),nodeDragStop:L(),nodesInitialized:L(),miniMapNodeClick:L(),miniMapNodeDoubleClick:L(),miniMapNodeMouseEnter:L(),miniMapNodeMouseMove:L(),miniMapNodeMouseLeave:L(),connect:L(),connectStart:L(),connectEnd:L(),paneReady:L(),move:L(),moveStart:L(),moveEnd:L(),selectionDragStart:L(),selectionDrag:L(),selectionDragStop:L(),selectionContextMenu:L(),paneScroll:L(),paneClick:L(),paneContextMenu:L(),paneMouseEnter:L(),paneMouseMove:L(),paneMouseLeave:L(),edgeContextMenu:L(),edgeMouseEnter:L(),edgeMouseMove:L(),edgeMouseLeave:L(),edgeDoubleClick:L(),edgeClick:L(),edgeUpdateStart:L(),edgeUpdate:L(),edgeUpdateEnd:L(),updateNodeInternals:L()});function qr(e,t){r.onBeforeMount(()=>{for(const[n,o]of Object.entries(t.value)){const a=l=>{e(n,l)};o.on(a),Ve(()=>{o.off(a)})}})}const Qr=["production","prod"],re=(e,...t)=>{Qr.includes(process.env.NODE_ENV||"")||console.warn(`[Vue Flow]: ${e}`,...t)},Ae=()=>typeof window<"u"?window:{chrome:!1},Dn=e=>({...e.computedPosition||{x:0,y:0},width:e.dimensions.width||0,height:e.dimensions.height||0}),Tt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},De=e=>({width:e.offsetWidth,height:e.offsetHeight}),It=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Vt=(e,t)=>({x:It(e.x,t[0][0],t[1][0]),y:It(e.y,t[0][1],t[1][1])}),Ot=e=>{const t=e.getRootNode(),n=Ae();return"elementFromPoint"in t?t:n.document},Xe=e=>e&&"id"in e&&"source"in e&&"target"in e,At=e=>Xe(e)&&"sourceNode"in e&&"targetNode"in e,Xn=e=>e&&"id"in e&&!Xe(e),ye=e=>Xn(e)&&"computedPosition"in e,Jr=e=>!!e.width&&!!e.height&&!!e.x&&!!e.y,ea=(e,t,n)=>{var o;let a=n;return ye(e)||(a={type:(o=e.type)!=null?o:"default",dimensions:r.markRaw({width:0,height:0}),handleBounds:{source:[],target:[]},computedPosition:r.markRaw({z:0,...e.position}),draggable:void 0,selectable:void 0,connectable:void 0,...n,data:J(e.data)?e.data:{},events:r.markRaw(J(e.events)?e.events:{})}),{...a,...e,id:e.id.toString()}},Ln=(e,t)=>{var n,o,a,l;const i=J(e.events)?e.events:t!=null&&t.events&&J(t==null?void 0:t.events)?t==null?void 0:t.events:{},s=J(e.data)?e.data:t!=null&&t.data&&J(t==null?void 0:t.data)?t==null?void 0:t.data:{};return t=At(e)?t:{...t,sourceHandle:(e.sourceHandle?e.sourceHandle.toString():void 0)||(t==null?void 0:t.sourceHandle),targetHandle:(e.targetHandle?e.targetHandle.toString():void 0)||(t==null?void 0:t.targetHandle),type:(o=(n=e.type)!=null?n:t==null?void 0:t.type)!=null?o:"default",source:e.source.toString()||(t==null?void 0:t.source),target:e.target.toString()||(t==null?void 0:t.target),z:t==null?void 0:t.z,sourceX:t==null?void 0:t.sourceX,sourceY:t==null?void 0:t.sourceY,targetX:t==null?void 0:t.targetX,targetY:t==null?void 0:t.targetY,updatable:(a=e.updatable)!=null?a:t==null?void 0:t.updatable,selectable:(l=e.selectable)!=null?l:t==null?void 0:t.selectable,data:s,events:r.markRaw(i),label:(e.label&&!tt(e.label)?r.markRaw(e.label):e.label)||(t==null?void 0:t.label),interactionWidth:e.interactionWidth||(t==null?void 0:t.interactionWidth)},Object.assign({id:e.id.toString()},e,t)},Hn=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`vueflow__edge-${e}${t??""}-${n}${o??""}`,jn=(e,t)=>t.some(n=>Xe(n)&&n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Dt=({x:e,y:t},{x:n,y:o,zoom:a},l,[i,s])=>{const u={x:(e-n)/a,y:(t-o)/a};return l?{x:i*Math.round(u.x/i),y:s*Math.round(u.y/s)}:u},ta=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Yn=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),na=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Fn=e=>{const t=e.reduce((n,{computedPosition:o={x:0,y:0},dimensions:a={width:0,height:0}}={})=>ta(n,Yn({...o,...a})),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return na(t)},Un=(e,t,{x:n,y:o,zoom:a}={x:0,y:0,zoom:1},l=!1,i=!1)=>{const s={x:(t.x-n)/a,y:(t.y-o)/a,width:t.width/a,height:t.height/a};return e.filter(u=>{const{computedPosition:c={x:0,y:0},dimensions:d={width:0,height:0},selectable:f}=u;if(i&&!f)return!1;const h={...c,width:d.width||0,height:d.height||0},g=Tt(s,h),x=typeof d.width>"u"||typeof d.height>"u"||d.width===0||d.height===0,E=l&&g>0,N=d.width*d.height;return x||E||g>=N})},ot=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Zn=(e,t,n,o,a,l=.1,i={x:0,y:0})=>{var s,u;const c=t/(e.width*(1+l)),d=n/(e.height*(1+l)),f=Math.min(c,d),h=It(f,o,a),g=e.x+e.width/2,x=e.y+e.height/2,E=t/2-g*h+((s=i.x)!=null?s:0),N=n/2-x*h+((u=i.y)!=null?u:0);return{x:E,y:N,zoom:h}},oa=(e,t)=>({x:t.x+e.x,y:t.y+e.y,z:(e.z>t.z?e.z:t.z)+1}),Wn=(e,t)=>{if(!e.parentNode)return!1;const n=t(e.parentNode);return n?n.selected?!0:Wn(n,t):!1},we=e=>typeof e>"u"?"":typeof e=="string"?e:Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&"),J=e=>typeof r.unref(e)<"u",ra=(e,t)=>{if(!e.source||!e.target)return re("Can't create edge. An edge needs a source and a target."),!1;let n;return Xe(e)?n={...e}:n={...e,id:Hn(e)},n=Ln(n),jn(n,t)?!1:n},aa=(e,t,n)=>{if(!t.source||!t.target)return re("Can't create new edge. An edge needs a source and a target."),!1;const o=n.find(l=>At(l)&&l.id===e.id);if(!o)return re(`The old edge with id=${e.id} does not exist.`),!1;const a={...e,id:Hn(t),source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle};return n.splice(n.indexOf(o),1,a),a},Kn=(e,t,n,o)=>{const a={},l=e.map(i=>{const s=ea(i,o,{...t(i.id),parentNode:i.parentNode});return i.parentNode&&(a[i.parentNode]=!0),s});return l.forEach(i=>{const s=[...l,...n];if(i.parentNode&&!s.find(u=>u.id===i.parentNode)&&re(`Parent node ${i.parentNode} not found`),i.parentNode||a[i.id]){a[i.id]&&(i.isParent=!0);const u=i.parentNode?t(i.parentNode):void 0;u&&(u.isParent=!0)}}),l};var H=(e=>(e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom",e))(H||{}),be=(e=>(e.Bezier="default",e.SimpleBezier="simple-bezier",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e))(be||{}),Be=(e=>(e.Strict="strict",e.Loose="loose",e))(Be||{}),rt=(e=>(e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal",e))(rt||{});const Gn=Symbol("vueFlow"),qn=Symbol("nodeId"),Qn=Symbol("nodeRef"),la=Symbol("edgeId"),ia=Symbol("edgeRef"),at=Symbol("slots");function sa(e){const t=e??r.inject(qn,""),n=r.inject(Qn,null),{findNode:o,getEdges:a}=te(),l=o(t);if(!l)throw new Error(`[vue-flow]: useNode - Node with id ${t} not found!`);return{id:t,nodeEl:n,node:l,parentNode:r.computed(()=>l.parentNode?o(l.parentNode):void 0),connectedEdges:r.computed(()=>ot([l],a.value))}}const Le=(e,t,n,o,a,l,i,s,u)=>{var c,d;const f=e.touches?e.touches[0].clientX:e.clientX,h=e.touches?e.touches[0].clientY:e.clientY,g=i.elementFromPoint(f,h),x=(g==null?void 0:g.classList.contains("target"))||!1,E=(g==null?void 0:g.classList.contains("source"))||!1,N={elementBelow:g,isValid:!1,connection:{source:"",target:"",sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(g&&(x||E)&&(N.isHoveringHandle=!0,t===Be.Strict?n&&E||!n&&x:!0)){const y=(c=g.getAttribute("data-nodeid"))!=null?c:"",b=(d=g.getAttribute("data-handleid"))!=null?d:"",$=n?y:o,w=n?b:a,P=n?o:y,m={source:$,sourceHandle:w,target:P,targetHandle:n?a:b};N.connection=m,N.isValid=(me(l)?l(m,{edges:s,sourceNode:u($),targetNode:u(P)}):y!==o||b!==a)||!N.connection.target||!N.connection.source}return N},lt=e=>{e==null||e.classList.remove("vue-flow__handle-valid"),e==null||e.classList.remove("vue-flow__handle-connecting")};function Jn({handleId:e,nodeId:t,isValidConnection:n,type:o,elementEdgeUpdaterType:a,onEdgeUpdateEnd:l,onEdgeUpdate:i}){const s=te(),u=r.toRef(s,"edges"),c=r.toRef(s,"connectOnClick"),d=r.toRef(s,"nodesConnectable"),f=r.toRef(s,"connectionClickStartHandle"),h=r.toRef(s,"connectionMode"),g=r.toRef(s,"emits"),x=r.toRef(s,"startConnection"),E=r.toRef(s,"updateConnection"),N=r.toRef(s,"endConnection"),y=r.toRef(s,"getNode"),b=r.toRef(s,"vueFlowRef"),$=r.computed(()=>r.unref(o)==="target");let w;const P=k=>{if(k.button!==0)return;const C=Ot(k.target);if(!C)return;let R=n;const A=y.value(r.unref(t));if(A&&(typeof A.connectable>"u"?d.value:A.connectable)===!1)return;n||A&&(R=$.value?A.isValidSourcePos:A.isValidTargetPos);const F=C.elementFromPoint(k.clientX,k.clientY),Z=F==null?void 0:F.classList.contains("target"),q=F==null?void 0:F.classList.contains("source");if(!b.value||!Z&&!q&&!a)return;const v=a??(Z?"target":"source"),z=b.value.getBoundingClientRect();x.value({nodeId:r.unref(t),handleId:r.unref(e),type:r.unref(v)},{x:k.clientX-z.left,y:k.clientY-z.top},k);function _(V){E.value({x:V.clientX-z.left,y:V.clientY-z.top});const{connection:D,elementBelow:S,isValid:O,isHoveringHandle:X}=Le(V,h.value,r.unref($.value),r.unref(t),r.unref(e),R,C,u.value,y.value);if(!X)return lt(w);D.source!==D.target&&S&&(w=S,S.classList.add("vue-flow__handle-connecting"),S.classList.toggle("vue-flow__handle-valid",O))}function B(V){const{connection:D,isValid:S}=Le(V,h.value,r.unref($.value),r.unref(t),r.unref(e),R,C,u.value,y.value),O=D.source===D.target;S&&!O&&(i?i(D):g.value.connect(D)),a&&(l==null||l()),lt(w),N.value(V),C.removeEventListener("mousemove",_),C.removeEventListener("mouseup",B)}C.addEventListener("mousemove",_),C.addEventListener("mouseup",B)},m=r.ref({x:0,y:0});return{onMouseDown:P,onTouchStart:k=>{const C=k.touches[0].clientX,R=k.touches[0].clientY,A=Ot(k.target);if(!A)return;let F=n;const Z=y.value(r.unref(t));if(Z&&(typeof Z.connectable>"u"?d.value:Z.connectable)===!1)return;n||Z&&(F=$.value?Z.isValidSourcePos:Z.isValidTargetPos);const q=A.elementFromPoint(C,R),v=q==null?void 0:q.classList.contains("target"),z=q==null?void 0:q.classList.contains("source");if(!b.value||!v&&!z&&!a)return;const _=a??(v?"target":"source"),B=b.value.getBoundingClientRect();x.value({nodeId:r.unref(t),handleId:r.unref(e),type:r.unref(_)},{x:C-B.left,y:R-B.top},k);function V(S){E.value({x:S.touches[0].clientX-B.left,y:S.touches[0].clientY-B.top}),m.value={x:S.touches[0].clientX,y:S.touches[0].clientY};const{connection:O,elementBelow:X,isValid:G,isHoveringHandle:K}=Le(S,h.value,r.unref($.value),r.unref(t),r.unref(e),F,A,u.value,y.value);if(!K)return lt(w);O.source!==O.target&&X&&(w=X,X.classList.add("vue-flow__handle-connecting"),X.classList.toggle("vue-flow__handle-valid",G))}function D(S){const{connection:O,isValid:X}=Le({clientX:m.value.x,clientY:m.value.y},h.value,r.unref($.value),r.unref(t),r.unref(e),F,A,u.value,y.value),G=O.source===O.target;X&&!G&&(i?i(O):g.value.connect(O)),a&&(l==null||l()),lt(w),N.value(S),m.value={x:0,y:0},A.removeEventListener("touchmove",V),A.removeEventListener("touchend",D)}A.addEventListener("touchmove",V),A.addEventListener("touchend",D)},onClick:k=>{var C;if(c.value)if(!f.value)x.value({nodeId:r.unref(t),type:r.unref(o),handleId:r.unref(e)},void 0,k,!0);else{let R=n??(()=>!0);const A=y.value(r.unref(t));if(A&&(typeof A.connectable>"u"?d.value:A.connectable)===!1)return;n||A&&(R=(C=$.value?A.isValidSourcePos:A.isValidTargetPos)!=null?C:()=>!0);const F=Ot(k.target),{connection:Z,isValid:q}=Le(k,h.value,f.value.type==="target",f.value.nodeId,f.value.handleId||null,R,F,u.value,y.value),v=Z.source===Z.target;q&&!v&&g.value.connect(Z),N.value(k,!0)}}}}const ua=["data-handleid","data-nodeid","data-handlepos"],ca={name:"Handle"},Pe=r.defineComponent({...ca,props:{id:null,type:null,position:{default:()=>"top"},isValidConnection:null,connectable:{type:[Boolean,String,Function],default:!0}},setup(e){const t=r.createPropsRestProxy(e,["position","connectable","id","isValidConnection"]),n=r.toRef(t,"type","source"),o=te(),a=r.toRef(o,"connectionStartHandle");r.toRef(o,"connectionMode");const l=r.toRef(o,"vueFlowRef"),i=r.toRef(o,"nodesConnectable"),{id:s,node:u,nodeEl:c,connectedEdges:d}=sa(),f=r.ref(),h=r.computed(()=>{var y;return(y=e.id)!=null?y:`${s}__handle-${e.position}`}),{onMouseDown:g,onTouchStart:x,onClick:E}=Jn({nodeId:s,handleId:h.value,isValidConnection:e.isValidConnection,type:n}),N=r.computed(()=>tt(e.connectable)&&e.connectable==="single"?!d.value.some(y=>{const b=y[`${n.value}Handle`];return y[n.value]!==s?!1:b?b===h.value:!0}):me(e.connectable)?e.connectable(u,d.value):J(e.connectable)?e.connectable:i.value);return r.onMounted(()=>{var y,b;const $=(y=u.handleBounds[n.value])==null?void 0:y.find(A=>A.id===h.value);if(!l.value||$)return;const w=l.value.querySelector(".vue-flow__transformationpane");if(!c||!f.value||!w)return;const P=c.value.getBoundingClientRect(),m=f.value.getBoundingClientRect(),k=window.getComputedStyle(w),{m22:C}=new window.DOMMatrixReadOnly(k.transform),R={id:h.value,position:e.position,x:(m.left-P.left)/C,y:(m.top-P.top)/C,...De(f.value)};u.handleBounds[n.value]=[...(b=u.handleBounds[n.value])!=null?b:[],R]}),(y,b)=>(r.openBlock(),r.createElementBlock("div",{ref_key:"handle",ref:f,"data-handleid":h.value,"data-nodeid":r.unref(s),"data-handlepos":e.position,class:r.normalizeClass(["vue-flow__handle nodrag",[`vue-flow__handle-${e.position}`,`vue-flow__handle-${h.value}`,{source:r.unref(n)!=="target",target:r.unref(n)==="target",connectable:r.unref(N),connecting:a.value&&a.value.nodeId===r.unref(s)&&a.value.handleId===h.value&&a.value.type===r.unref(n)}]]),onMousedown:b[0]||(b[0]=(...$)=>r.unref(g)&&r.unref(g)(...$)),onTouchstart:b[1]||(b[1]=(...$)=>r.unref(x)&&r.unref(x)(...$)),onClick:b[2]||(b[2]=(...$)=>r.unref(E)&&r.unref(E)(...$))},[r.renderSlot(y.$slots,"default",{id:e.id})],42,ua))}}),Xt=function({sourcePosition:e=H.Bottom,targetPosition:t=H.Top,label:n,connectable:o=!0,isValidTargetPos:a,isValidSourcePos:l}){return[r.h(Pe,{type:"target",position:t,connectable:o,isValidConnection:a}),typeof n!="string"&&n?r.h(n):r.h("div",{innerHTML:n}),r.h(Pe,{type:"source",position:e,connectable:o,isValidConnection:l})]};Xt.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable"],Xt.inheritAttrs=!1;const da=Xt,Lt=function({sourcePosition:e=H.Bottom,label:t,connectable:n=!0,isValidSourcePos:o}){return[typeof t!="string"&&t?r.h(t):r.h("div",{innerHTML:t}),r.h(Pe,{type:"source",position:e,connectable:n,isValidConnection:o})]};Lt.props=["sourcePosition","label","isValidSourcePos","connectable"],Lt.inheritAttrs=!1;const fa=Lt,Ht=function({targetPosition:e=H.Top,label:t,connectable:n=!0,isValidTargetPos:o}){return[r.h(Pe,{type:"target",position:e,connectable:n,isValidConnection:o}),typeof t!="string"&&t?r.h(t):r.h("div",{innerHTML:t})]};Ht.props=["targetPosition","label","isValidTargetPos","connectable"],Ht.inheritAttrs=!1;const ha=Ht,pa=()=>({doubleClick:L(),click:L(),mouseEnter:L(),mouseMove:L(),mouseLeave:L(),contextMenu:L(),dragStart:L(),drag:L(),dragStop:L()});function ga(e,t){const n=pa();return n.doubleClick.on(o=>{var a,l;t.nodeDoubleClick(o),(l=(a=e.events)==null?void 0:a.doubleClick)==null||l.call(a,o)}),n.click.on(o=>{var a,l;t.nodeClick(o),(l=(a=e.events)==null?void 0:a.click)==null||l.call(a,o)}),n.mouseEnter.on(o=>{var a,l;t.nodeMouseEnter(o),(l=(a=e.events)==null?void 0:a.mouseEnter)==null||l.call(a,o)}),n.mouseMove.on(o=>{var a,l;t.nodeMouseMove(o),(l=(a=e.events)==null?void 0:a.mouseMove)==null||l.call(a,o)}),n.mouseLeave.on(o=>{var a,l;t.nodeMouseLeave(o),(l=(a=e.events)==null?void 0:a.mouseLeave)==null||l.call(a,o)}),n.contextMenu.on(o=>{var a,l;t.nodeContextMenu(o),(l=(a=e.events)==null?void 0:a.contextMenu)==null||l.call(a,o)}),n.dragStart.on(o=>{var a,l;t.nodeDragStart(o),(l=(a=e.events)==null?void 0:a.dragStart)==null||l.call(a,o)}),n.drag.on(o=>{var a,l;t.nodeDrag(o),(l=(a=e.events)==null?void 0:a.drag)==null||l.call(a,o)}),n.dragStop.on(o=>{var a,l;t.nodeDragStop(o),(l=(a=e.events)==null?void 0:a.dragStop)==null||l.call(a,o)}),Object.entries(n).reduce((o,[a,l])=>(o.emit[a]=l.trigger,o.on[a]=l.on,o),{emit:{},on:{}})}const eo=(e,t,n)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return;const a=Array.from(o),l=t.getBoundingClientRect();return a.map(i=>{const s=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),position:i.getAttribute("data-handlepos"),x:(s.left-l.left)/n,y:(s.top-l.top)/n,...De(i)}})},to=(e,t,n,o,a)=>{a.value=!1,e.selected?e.selected&&t&&o([e]):n([e])};var no;const ma=typeof window<"u",it=e=>typeof e=="number";ma&&((no=window==null?void 0:window.navigator)!=null&&no.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function oo(e,t,n){let o=e;do{if(o&&o.matches(t))return!0;if(o===n.value)return!1;o=o.parentElement}while(o);return!1}function ya(e,t,n,o){return e.filter(a=>(a.selected||a.id===o)&&(!a.parentNode||!Wn(a,n))).map(a=>{var l,i;return r.markRaw({id:a.id,position:a.computedPosition||{x:0,y:0,z:0},distance:{x:t.x-((l=a.computedPosition)==null?void 0:l.x)||0,y:t.y-((i=a.computedPosition)==null?void 0:i.y)||0},from:a.computedPosition,extent:a.extent,parentNode:a.parentNode,dimensions:a.dimensions})})}function jt({id:e,dragItems:t,getNode:n}){const o=t.map(a=>({...n.value(a.id)}));return[e?o.find(a=>a.id===e):o[0],o]}function ro(e,t,n){let o=e.extent||t;if(e.extent==="parent")e.parentNode&&n&&e.dimensions.width&&e.dimensions.height?o=n&&it(n.computedPosition.x)&&it(n.computedPosition.y)&&it(n.dimensions.width)&&it(n.dimensions.height)?[[n.computedPosition.x,n.computedPosition.y],[n.computedPosition.x+n.dimensions.width-e.dimensions.width,n.computedPosition.y+n.dimensions.height-e.dimensions.height]]:o:(re("Only child nodes can use a parent extent."),o=t);else if(e.extent&&n){const a=n.computedPosition.x,l=n.computedPosition.y;o=[[e.extent[0][0]+a,e.extent[0][1]+l],[e.extent[1][0]+a,e.extent[1][1]+l]]}return o}var va={value:()=>{}};function st(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new ut(n)}function ut(e){this._=e}function wa(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",a=n.indexOf(".");if(a>=0&&(o=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}ut.prototype=st.prototype={constructor:ut,on:function(e,t){var n=this._,o=wa(e+"",n),a,l=-1,i=o.length;if(arguments.length<2){for(;++l<i;)if((a=(e=o[l]).type)&&(a=ba(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<i;)if(a=(e=o[l]).type)n[a]=ao(n[a],e.name,t);else if(t==null)for(a in n)n[a]=ao(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ut(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),o=0,a,l;o<a;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],o=0,a=l.length;o<a;++o)l[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],a=0,l=o.length;a<l;++a)o[a].value.apply(t,n)}};function ba(e,t){for(var n=0,o=e.length,a;n<o;++n)if((a=e[n]).name===t)return a.value}function ao(e,t,n){for(var o=0,a=e.length;o<a;++o)if(e[o].name===t){e[o]=va,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Yt="http://www.w3.org/1999/xhtml";const lo={svg:"http://www.w3.org/2000/svg",xhtml:Yt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ct(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),lo.hasOwnProperty(t)?{space:lo[t],local:e}:e}function xa(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Yt&&t.documentElement.namespaceURI===Yt?t.createElement(e):t.createElementNS(n,e)}}function _a(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function io(e){var t=ct(e);return(t.local?_a:xa)(t)}function ka(){}function Ft(e){return e==null?ka:function(){return this.querySelector(e)}}function Ea(e){typeof e!="function"&&(e=Ft(e));for(var t=this._groups,n=t.length,o=new Array(n),a=0;a<n;++a)for(var l=t[a],i=l.length,s=o[a]=new Array(i),u,c,d=0;d<i;++d)(u=l[d])&&(c=e.call(u,u.__data__,d,l))&&("__data__"in u&&(c.__data__=u.__data__),s[d]=c);return new oe(o,this._parents)}function Na(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Sa(){return[]}function so(e){return e==null?Sa:function(){return this.querySelectorAll(e)}}function Ca(e){return function(){return Na(e.apply(this,arguments))}}function Ma(e){typeof e=="function"?e=Ca(e):e=so(e);for(var t=this._groups,n=t.length,o=[],a=[],l=0;l<n;++l)for(var i=t[l],s=i.length,u,c=0;c<s;++c)(u=i[c])&&(o.push(e.call(u,u.__data__,c,i)),a.push(u));return new oe(o,a)}function uo(e){return function(){return this.matches(e)}}function co(e){return function(t){return t.matches(e)}}var Ba=Array.prototype.find;function Pa(e){return function(){return Ba.call(this.children,e)}}function Ra(){return this.firstElementChild}function $a(e){return this.select(e==null?Ra:Pa(typeof e=="function"?e:co(e)))}var za=Array.prototype.filter;function Ta(){return Array.from(this.children)}function Ia(e){return function(){return za.call(this.children,e)}}function Va(e){return this.selectAll(e==null?Ta:Ia(typeof e=="function"?e:co(e)))}function Oa(e){typeof e!="function"&&(e=uo(e));for(var t=this._groups,n=t.length,o=new Array(n),a=0;a<n;++a)for(var l=t[a],i=l.length,s=o[a]=[],u,c=0;c<i;++c)(u=l[c])&&e.call(u,u.__data__,c,l)&&s.push(u);return new oe(o,this._parents)}function fo(e){return new Array(e.length)}function Aa(){return new oe(this._enter||this._groups.map(fo),this._parents)}function dt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}dt.prototype={constructor:dt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Da(e){return function(){return e}}function Xa(e,t,n,o,a,l){for(var i=0,s,u=t.length,c=l.length;i<c;++i)(s=t[i])?(s.__data__=l[i],o[i]=s):n[i]=new dt(e,l[i]);for(;i<u;++i)(s=t[i])&&(a[i]=s)}function La(e,t,n,o,a,l,i){var s,u,c=new Map,d=t.length,f=l.length,h=new Array(d),g;for(s=0;s<d;++s)(u=t[s])&&(h[s]=g=i.call(u,u.__data__,s,t)+"",c.has(g)?a[s]=u:c.set(g,u));for(s=0;s<f;++s)g=i.call(e,l[s],s,l)+"",(u=c.get(g))?(o[s]=u,u.__data__=l[s],c.delete(g)):n[s]=new dt(e,l[s]);for(s=0;s<d;++s)(u=t[s])&&c.get(h[s])===u&&(a[s]=u)}function Ha(e){return e.__data__}function ja(e,t){if(!arguments.length)return Array.from(this,Ha);var n=t?La:Xa,o=this._parents,a=this._groups;typeof e!="function"&&(e=Da(e));for(var l=a.length,i=new Array(l),s=new Array(l),u=new Array(l),c=0;c<l;++c){var d=o[c],f=a[c],h=f.length,g=Ya(e.call(d,d&&d.__data__,c,o)),x=g.length,E=s[c]=new Array(x),N=i[c]=new Array(x),y=u[c]=new Array(h);n(d,f,E,N,y,g,t);for(var b=0,$=0,w,P;b<x;++b)if(w=E[b]){for(b>=$&&($=b+1);!(P=N[$])&&++$<x;);w._next=P||null}}return i=new oe(i,o),i._enter=s,i._exit=u,i}function Ya(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fa(){return new oe(this._exit||this._groups.map(fo),this._parents)}function Ua(e,t,n){var o=this.enter(),a=this,l=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?l.remove():n(l),o&&a?o.merge(a).order():a}function Za(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,a=n.length,l=o.length,i=Math.min(a,l),s=new Array(a),u=0;u<i;++u)for(var c=n[u],d=o[u],f=c.length,h=s[u]=new Array(f),g,x=0;x<f;++x)(g=c[x]||d[x])&&(h[x]=g);for(;u<a;++u)s[u]=n[u];return new oe(s,this._parents)}function Wa(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],a=o.length-1,l=o[a],i;--a>=0;)(i=o[a])&&(l&&i.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(i,l),l=i);return this}function Ka(e){e||(e=Ga);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,o=n.length,a=new Array(o),l=0;l<o;++l){for(var i=n[l],s=i.length,u=a[l]=new Array(s),c,d=0;d<s;++d)(c=i[d])&&(u[d]=c);u.sort(t)}return new oe(a,this._parents).order()}function Ga(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Qa(){return Array.from(this)}function Ja(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],a=0,l=o.length;a<l;++a){var i=o[a];if(i)return i}return null}function el(){let e=0;for(const t of this)++e;return e}function tl(){return!this.node()}function nl(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var a=t[n],l=0,i=a.length,s;l<i;++l)(s=a[l])&&e.call(s,s.__data__,l,a);return this}function ol(e){return function(){this.removeAttribute(e)}}function rl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function al(e,t){return function(){this.setAttribute(e,t)}}function ll(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function il(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function sl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ul(e,t){var n=ct(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?rl:ol:typeof t=="function"?n.local?sl:il:n.local?ll:al)(n,t))}function ho(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function cl(e){return function(){this.style.removeProperty(e)}}function dl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function fl(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function hl(e,t,n){return arguments.length>1?this.each((t==null?cl:typeof t=="function"?fl:dl)(e,t,n??"")):Re(this.node(),e)}function Re(e,t){return e.style.getPropertyValue(t)||ho(e).getComputedStyle(e,null).getPropertyValue(t)}function pl(e){return function(){delete this[e]}}function gl(e,t){return function(){this[e]=t}}function ml(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function yl(e,t){return arguments.length>1?this.each((t==null?pl:typeof t=="function"?ml:gl)(e,t)):this.node()[e]}function po(e){return e.trim().split(/^|\s+/)}function Ut(e){return e.classList||new go(e)}function go(e){this._node=e,this._names=po(e.getAttribute("class")||"")}go.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function mo(e,t){for(var n=Ut(e),o=-1,a=t.length;++o<a;)n.add(t[o])}function yo(e,t){for(var n=Ut(e),o=-1,a=t.length;++o<a;)n.remove(t[o])}function vl(e){return function(){mo(this,e)}}function wl(e){return function(){yo(this,e)}}function bl(e,t){return function(){(t.apply(this,arguments)?mo:yo)(this,e)}}function xl(e,t){var n=po(e+"");if(arguments.length<2){for(var o=Ut(this.node()),a=-1,l=n.length;++a<l;)if(!o.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?bl:t?vl:wl)(n,t))}function _l(){this.textContent=""}function kl(e){return function(){this.textContent=e}}function El(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Nl(e){return arguments.length?this.each(e==null?_l:(typeof e=="function"?El:kl)(e)):this.node().textContent}function Sl(){this.innerHTML=""}function Cl(e){return function(){this.innerHTML=e}}function Ml(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Bl(e){return arguments.length?this.each(e==null?Sl:(typeof e=="function"?Ml:Cl)(e)):this.node().innerHTML}function Pl(){this.nextSibling&&this.parentNode.appendChild(this)}function Rl(){return this.each(Pl)}function $l(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zl(){return this.each($l)}function Tl(e){var t=typeof e=="function"?e:io(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Il(){return null}function Vl(e,t){var n=typeof e=="function"?e:io(e),o=t==null?Il:typeof t=="function"?t:Ft(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Ol(){var e=this.parentNode;e&&e.removeChild(this)}function Al(){return this.each(Ol)}function Dl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Xl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ll(e){return this.select(e?Xl:Dl)}function Hl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function jl(e){return function(t){e.call(this,t,this.__data__)}}function Yl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Fl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,a=t.length,l;n<a;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++o]=l;++o?t.length=o:delete this.__on}}}function Ul(e,t,n){return function(){var o=this.__on,a,l=jl(t);if(o){for(var i=0,s=o.length;i<s;++i)if((a=o[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=t;return}}this.addEventListener(e.type,l,n),a={type:e.type,name:e.name,value:t,listener:l,options:n},o?o.push(a):this.__on=[a]}}function Zl(e,t,n){var o=Yl(e+""),a,l=o.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,c=s.length,d;u<c;++u)for(a=0,d=s[u];a<l;++a)if((i=o[a]).type===d.type&&i.name===d.name)return d.value}return}for(s=t?Ul:Fl,a=0;a<l;++a)this.each(s(o[a],t,n));return this}function vo(e,t,n){var o=ho(e),a=o.CustomEvent;typeof a=="function"?a=new a(t,n):(a=o.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Wl(e,t){return function(){return vo(this,e,t)}}function Kl(e,t){return function(){return vo(this,e,t.apply(this,arguments))}}function Gl(e,t){return this.each((typeof t=="function"?Kl:Wl)(e,t))}function*ql(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],a=0,l=o.length,i;a<l;++a)(i=o[a])&&(yield i)}var wo=[null];function oe(e,t){this._groups=e,this._parents=t}function He(){return new oe([[document.documentElement]],wo)}function Ql(){return this}oe.prototype=He.prototype={constructor:oe,select:Ea,selectAll:Ma,selectChild:$a,selectChildren:Va,filter:Oa,data:ja,enter:Aa,exit:Fa,join:Ua,merge:Za,selection:Ql,order:Wa,sort:Ka,call:qa,nodes:Qa,node:Ja,size:el,empty:tl,each:nl,attr:ul,style:hl,property:yl,classed:xl,text:Nl,html:Bl,raise:Rl,lower:zl,append:Tl,insert:Vl,remove:Al,clone:Ll,datum:Hl,on:Zl,dispatch:Gl,[Symbol.iterator]:ql};function ae(e){return typeof e=="string"?new oe([[document.querySelector(e)]],[document.documentElement]):new oe([[e]],wo)}function Jl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function se(e,t){if(e=Jl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const ei={passive:!1},je={capture:!0,passive:!1};function Zt(e){e.stopImmediatePropagation()}function $e(e){e.preventDefault(),e.stopImmediatePropagation()}function bo(e){var t=e.document.documentElement,n=ae(e).on("dragstart.drag",$e,je);"onselectstart"in t?n.on("selectstart.drag",$e,je):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function xo(e,t){var n=e.document.documentElement,o=ae(e).on("dragstart.drag",null);t&&(o.on("click.drag",$e,je),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ft=e=>()=>e;function Wt(e,{sourceEvent:t,subject:n,target:o,identifier:a,active:l,x:i,y:s,dx:u,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Wt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ti(e){return!e.ctrlKey&&!e.button}function ni(){return this.parentNode}function oi(e,t){return t??{x:e.x,y:e.y}}function ri(){return navigator.maxTouchPoints||"ontouchstart"in this}function ai(){var e=ti,t=ni,n=oi,o=ri,a={},l=st("start","drag","end"),i=0,s,u,c,d,f=0;function h(w){w.on("mousedown.drag",g).filter(o).on("touchstart.drag",N).on("touchmove.drag",y,ei).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(w,P){if(!(d||!e.call(this,w,P))){var m=$(this,t.call(this,w,P),w,P,"mouse");!m||(ae(w.view).on("mousemove.drag",x,je).on("mouseup.drag",E,je),bo(w.view),Zt(w),c=!1,s=w.clientX,u=w.clientY,m("start",w))}}function x(w){if($e(w),!c){var P=w.clientX-s,m=w.clientY-u;c=P*P+m*m>f}a.mouse("drag",w)}function E(w){ae(w.view).on("mousemove.drag mouseup.drag",null),xo(w.view,c),$e(w),a.mouse("end",w)}function N(w,P){if(e.call(this,w,P)){var m=w.changedTouches,k=t.call(this,w,P),C=m.length,R,A;for(R=0;R<C;++R)(A=$(this,k,w,P,m[R].identifier,m[R]))&&(Zt(w),A("start",w,m[R]))}}function y(w){var P=w.changedTouches,m=P.length,k,C;for(k=0;k<m;++k)(C=a[P[k].identifier])&&($e(w),C("drag",w,P[k]))}function b(w){var P=w.changedTouches,m=P.length,k,C;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),k=0;k<m;++k)(C=a[P[k].identifier])&&(Zt(w),C("end",w,P[k]))}function $(w,P,m,k,C,R){var A=l.copy(),F=se(R||m,P),Z,q,v;if((v=n.call(w,new Wt("beforestart",{sourceEvent:m,target:h,identifier:C,active:i,x:F[0],y:F[1],dx:0,dy:0,dispatch:A}),k))!=null)return Z=v.x-F[0]||0,q=v.y-F[1]||0,function z(_,B,V){var D=F,S;switch(_){case"start":a[C]=z,S=i++;break;case"end":delete a[C],--i;case"drag":F=se(V||B,P),S=i;break}A.call(_,w,new Wt(_,{sourceEvent:B,subject:v,target:h,identifier:C,active:S,x:F[0]+Z,y:F[1]+q,dx:F[0]-D[0],dy:F[1]-D[1],dispatch:A}),k)}}return h.filter=function(w){return arguments.length?(e=typeof w=="function"?w:ft(!!w),h):e},h.container=function(w){return arguments.length?(t=typeof w=="function"?w:ft(w),h):t},h.subject=function(w){return arguments.length?(n=typeof w=="function"?w:ft(w),h):n},h.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:ft(!!w),h):o},h.on=function(){var w=l.on.apply(l,arguments);return w===l?h:w},h.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,h):Math.sqrt(f)},h}function _o(e){const t=r.effectScope(),n=t.run(()=>{const o=te(),a=r.toRef(o,"viewport"),l=r.toRef(o,"snapToGrid"),i=r.toRef(o,"snapGrid"),s=r.toRef(o,"noDragClassName"),u=r.toRef(o,"nodes"),c=r.toRef(o,"nodeExtent"),d=r.toRef(o,"getNode"),f=r.toRef(o,"multiSelectionActive"),h=r.toRef(o,"nodesSelectionActive"),g=r.toRef(o,"selectNodesOnDrag"),x=r.toRef(o,"removeSelectedElements"),E=r.toRef(o,"addSelectedNodes"),N=r.toRef(o,"updateNodePositions"),y=e,b=r.toRef(y,"onStart"),$=r.toRef(y,"onDrag"),w=r.toRef(y,"onStop"),P=r.toRef(y,"el"),m=r.toRef(y,"disabled",!1),k=r.toRef(y,"id"),C=r.ref(!1);let R=r.ref(),A=r.ref({x:void 0,y:void 0}),F=r.ref();const Z=v=>v??l.value?i.value:void 0,q=(v,z)=>{const _=v.sourceEvent.touches?v.sourceEvent.touches[0].clientX:v.sourceEvent.clientX,B=v.sourceEvent.touches?v.sourceEvent.touches[0].clientY:v.sourceEvent.clientY;return Dt({x:_,y:B},a.value,!!z,z??i.value)};return r.watch([()=>m.value,()=>P.value],()=>{if(P.value){const v=ae(P.value),z=k.value?d.value(k.value):void 0;m.value?v.on(".drag",null):(F.value=ai().on("start",_=>{!g.value&&!f.value&&k.value&&(z!=null&&z.selected||x.value()),z&&!m.value&&g.value&&to(z,f.value,E.value,x.value,h);const B=q(_,Z(z==null?void 0:z.snapGrid));if(R.value=ya(u.value,B,d.value,k.value),b.value&&R.value){const[V,D]=jt({id:k.value,dragItems:R.value,getNode:d});b.value(_.sourceEvent,V,D)}}).on("drag",_=>{const B=Z(z==null?void 0:z.snapGrid),V=q(_,B);let D=!1;if((A.value.x!==V.x||A.value.y!==V.y)&&R.value){if(A.value=V,R.value=R.value.map(S=>{const O={x:V.x-S.distance.x,y:V.y-S.distance.y};if(l.value&&B){const[G,K]=B;O.x=G*Math.round(O.x/G),O.y=K*Math.round(O.y/K)}const X=ro(S,c.value,S.parentNode?d.value(S.parentNode):void 0);return D=D||S.position.x!==O.x||S.position.y!==O.y,S.position=X?Vt(O,X):O,S}),!D)return;if(N.value(R.value,!0,!0),$.value){const[S,O]=jt({id:k.value,dragItems:R.value,getNode:d});C.value=!0,$.value(_.sourceEvent,S,O)}}_.on("end",S=>{if(C.value=!1,w.value&&R.value){N.value(R.value,!1,!1);const[O,X]=jt({id:k.value,dragItems:R.value,getNode:d});C.value=!1,w.value(S.sourceEvent,O,X)}})}).on("end",()=>{C.value=!1}).filter(_=>{const B=_.target;return!_.button&&(!s.value||!oo(B,`.${s.value}`,P)&&(!(z!=null&&z.dragHandle)||oo(B,z.dragHandle,P)))}),v.call(F.value))}}),C});return Ve(()=>t.stop()),n}const li=["data-id"],ii={name:"Node",inheritAttrs:!1},si=r.defineComponent({...ii,props:{id:null,draggable:{type:Boolean},selectable:{type:Boolean},connectable:null,snapGrid:null,type:{type:[null,Function,Object,Boolean]},name:null,node:null,resizeObserver:null},setup(e){const t=r.createPropsRestProxy(e,["id","type","name","draggable","selectable","connectable"]);r.provide(qn,e.id);const n=te(),o=r.toRef(n,"edges"),a=r.toRef(n,"noPanClassName"),l=r.toRef(n,"selectNodesOnDrag"),i=r.toRef(n,"nodesSelectionActive"),s=r.toRef(n,"multiSelectionActive"),u=r.toRef(n,"emits"),c=r.toRef(n,"getNode"),d=r.toRef(n,"removeSelectedElements"),f=r.toRef(n,"addSelectedNodes"),h=r.toRef(n,"updateNodeDimensions"),g=r.toRef(n,"onUpdateNodeInternals"),x=r.toRef(n,"getIntersectingNodes"),E=r.toRef(n,"getNodeTypes"),N=r.toRef(n,"nodeExtent"),y=r.toRef(n,"onNodesInitialized"),b=Oe(t,"node"),$=r.computed(()=>b.value.parentNode?c.value(b.value.parentNode):void 0),w=r.computed(()=>ot([b.value],o.value)),P=r.ref(),m=r.ref(!1);r.provide(Qn,P);const{emit:k,on:C}=ga(b.value,u.value),R=_o({id:e.id,el:P,disabled:r.computed(()=>!e.draggable),onStart(S,O,X){k.dragStart({event:S,node:O,nodes:X,intersections:x.value(O)})},onDrag(S,O,X){k.drag({event:S,node:O,nodes:X,intersections:x.value(O)})},onStop(S,O,X){k.dragStop({event:S,node:O,nodes:X,intersections:x.value(O)})}}),A=r.computed(()=>b.value.class instanceof Function?b.value.class(b.value):b.value.class),F=r.computed(()=>{const S=(b.value.style instanceof Function?b.value.style(b.value):b.value.style)||{},O=b.value.width instanceof Function?b.value.width(b.value):b.value.width,X=b.value.height instanceof Function?b.value.height(b.value):b.value.height;return O&&(S.width=typeof O=="string"?O:`${O}px`),X&&(S.height=typeof X=="string"?X:`${X}px`),S});g.value(S=>{S.includes(e.id)&&q()}),r.onMounted(()=>{t.resizeObserver.observe(P.value)}),r.onBeforeUnmount(()=>{t.resizeObserver.unobserve(P.value)}),r.watch([()=>b.value.type,()=>b.value.sourcePosition,()=>b.value.targetPosition],()=>{h.value([{id:e.id,nodeElement:P.value,forceUpdate:!0}])},{flush:"post"}),r.watch([()=>b.value.position.x,()=>b.value.position.y,()=>{var S;return(S=$.value)==null?void 0:S.computedPosition.x},()=>{var S;return(S=$.value)==null?void 0:S.computedPosition.y},()=>{var S;return(S=$.value)==null?void 0:S.computedPosition.z},()=>b.value.selected,()=>b.value.dimensions,()=>{var S;return(S=$.value)==null?void 0:S.dimensions}],([S,O,X,G,K])=>{const ee={x:S,y:O,z:(kr(F.value.zIndex)?F.value.zIndex:0)+(b.value.selected?1e3:0)};Z(ee,X&&G?{x:X,y:G,z:K||0}:void 0)},{flush:"post",immediate:!0});function Z(S,O){let X=S;O&&(X=oa({x:O.x,y:O.y,z:O.z},S)),b.value.computedPosition=X}y.value(()=>{m.value=!0}),r.onMounted(()=>{Ce(m).toBe(!0).then(()=>{var S,O;const X=ro(b.value,N.value,$.value),G=Vt(b.value.computedPosition,X);b.value.computedPosition={...b.value.computedPosition,...G},b.value.position={x:b.value.computedPosition.x-(((S=$.value)==null?void 0:S.computedPosition.x)||0),y:b.value.computedPosition.y-(((O=$.value)==null?void 0:O.computedPosition.y)||0)}})});function q(){P.value&&h.value([{id:e.id,nodeElement:P.value,forceUpdate:!0}]),Z({x:b.value.position.x,y:b.value.position.y,z:b.value.computedPosition.z?b.value.computedPosition.z:b.value.selected?1e3:0},$.value?{...$.value.computedPosition}:void 0)}function v(S){R!=null&&R.value||k.mouseEnter({event:S,node:b.value,connectedEdges:w.value})}function z(S){R!=null&&R.value||k.mouseMove({event:S,node:b.value,connectedEdges:w.value})}function _(S){R!=null&&R.value||k.mouseLeave({event:S,node:b.value,connectedEdges:w.value})}function B(S){return k.contextMenu({event:S,node:b.value,connectedEdges:w.value})}function V(S){return k.doubleClick({event:S,node:b.value,connectedEdges:w.value})}function D(S){e.selectable&&(!l.value||!e.draggable)&&to(b.value,s.value,f.value,d.value,i),k.click({event:S,node:b.value,connectedEdges:w.value})}return(S,O)=>{var X;return r.openBlock(),r.createElementBlock("div",{ref_key:"nodeElement",ref:P,class:r.normalizeClass(["vue-flow__node",[`vue-flow__node-${e.type===!1?"default":e.name}`,a.value,{dragging:r.unref(R),selected:b.value.selected,selectable:e.selectable},r.unref(A)]]),style:r.normalizeStyle({zIndex:(X=b.value.computedPosition.z)!=null?X:0,transform:`translate(${b.value.computedPosition.x}px,${b.value.computedPosition.y}px)`,pointerEvents:e.selectable||e.draggable?"all":"none",...r.unref(F)}),"data-id":b.value.id,onMouseenter:v,onMousemove:z,onMouseleave:_,onContextmenu:B,onClick:D,onDblclick:V},[(r.openBlock(),r.createBlock(r.resolveDynamicComponent(e.type===!1?E.value.default:e.type),{id:b.value.id,type:b.value.type,data:b.value.data,events:{...b.value.events,...r.unref(C)},selected:!!b.value.selected,connectable:e.connectable,position:b.value.position,dimensions:b.value.dimensions,"is-valid-target-pos":b.value.isValidTargetPos,"is-valid-source-pos":b.value.isValidSourcePos,"parent-node":b.value.parentNode,dragging:r.unref(R),"z-index":b.value.computedPosition.z,"target-position":b.value.targetPosition,"source-position":b.value.sourcePosition,label:b.value.label,"drag-handle":b.value.dragHandle,onUpdateNodeInternals:q},null,40,["id","type","data","events","selected","connectable","position","dimensions","is-valid-target-pos","is-valid-source-pos","parent-node","dragging","z-index","target-position","source-position","label","drag-handle"]))],46,li)}}}),ui=["transform"],ci=["width","height","x","y","rx","ry"],di=["y"],fi={name:"EdgeText"},hi=r.defineComponent({...fi,props:{x:null,y:null,label:null,labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(e){let t=r.ref({x:0,y:0,width:0,height:0});const n=r.ref(null),o=()=>{if(!n.value)return;const l=n.value.getBBox();(l.width!==t.value.width||l.height!==t.value.height)&&(t.value=l)};r.onMounted(o),r.watch([()=>e.x,()=>e.y,n,()=>e.label],o);const a=r.computed(()=>`translate(${e.x-t.value.width/2} ${e.y-t.value.height/2})`);return(l,i)=>(r.openBlock(),r.createElementBlock("g",{transform:r.unref(a),class:"vue-flow__edge-textwrapper"},[e.labelShowBg?(r.openBlock(),r.createElementBlock("rect",{key:0,class:"vue-flow__edge-textbg",width:`${t.value.width+2*e.labelBgPadding[0]}px`,height:`${t.value.height+2*e.labelBgPadding[1]}px`,x:-e.labelBgPadding[0],y:-e.labelBgPadding[1],style:r.normalizeStyle(e.labelBgStyle),rx:e.labelBgBorderRadius,ry:e.labelBgBorderRadius},null,12,ci)):r.createCommentVNode("",!0),r.createElementVNode("text",r.mergeProps(l.$attrs,{ref_key:"el",ref:n,class:"vue-flow__edge-text",y:t.value.height/2,dy:"0.3em",style:e.labelStyle}),[r.renderSlot(l.$slots,"default",{},()=>[r.unref(tt)(e.label)?(r.openBlock(),r.createElementBlock(r.Fragment,{key:1},[r.createTextVNode(r.toDisplayString(e.label),1)],64)):(r.openBlock(),r.createBlock(r.resolveDynamicComponent(e.label),{key:0}))])],16,di)],8,ui))}}),Kt=function({path:e,label:t,labelX:n,labelY:o,labelBgBorderRadius:a,labelBgPadding:l,labelBgStyle:i,labelShowBg:s=!0,labelStyle:u,markerStart:c,markerEnd:d,style:f,interactionWidth:h=20}){return[r.h("path",{style:f,d:e,class:"vue-flow__edge-path","marker-end":d,"marker-start":c}),h?r.h("path",{d:e,fill:"none","stroke-opacity":0,"stroke-width":h}):null,t?r.h(hi,{x:n,y:o,label:t,labelStyle:u,labelShowBg:s,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:a}):null]};Kt.props=["path","labelX","labelY","label","labelBgBorderRadius","labelBgPadding","labelBgStyle","labelShowBg","labelStyle","markerStart","markerEnd","style","interactionWidth"],Kt.inheritAttrs=!1;const ht=Kt;function ko({sourceX:e,sourceY:t,targetX:n,targetY:o}){const a=Math.abs(n-e)/2,l=n<e?n+a:n-a,i=Math.abs(o-t)/2,s=o<t?o+i:o-i;return[l,s,a,i]}function Eo({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:i,targetControlY:s}){const u=e*.125+a*.375+i*.375+n*.125,c=t*.125+l*.375+s*.375+o*.125,d=Math.abs(u-e),f=Math.abs(c-t);return[u,c,d,f]}function pt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function No({pos:e,x1:t,y1:n,x2:o,y2:a,c:l}){let i,s;switch(e){case H.Left:i=t-pt(t-o,l),s=n;break;case H.Right:i=t+pt(o-t,l),s=n;break;case H.Top:i=t,s=n-pt(n-a,l);break;case H.Bottom:i=t,s=n+pt(a-n,l);break}return[i,s]}function Gt({sourceX:e,sourceY:t,sourcePosition:n=H.Bottom,targetX:o,targetY:a,targetPosition:l=H.Top,curvature:i=.25}){const[s,u]=No({pos:n,x1:e,y1:t,x2:o,y2:a,c:i}),[c,d]=No({pos:l,x1:o,y1:a,x2:e,y2:t,c:i}),[f,h,g,x]=Eo({sourceX:e,sourceY:t,targetX:o,targetY:a,sourceControlX:s,sourceControlY:u,targetControlX:c,targetControlY:d});return[`M${e},${t} C${s},${u} ${c},${d} ${o},${a}`,f,h,g,x]}const qt=function({sourcePosition:e=H.Bottom,targetPosition:t=H.Top,...n}){const[o,a,l]=Gt({sourcePosition:e,targetPosition:t,...n});return r.h(ht,{path:o,labelX:a,labelY:l,...n})};qt.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","style","interactionWidth"],qt.inheritAttrs=!1;const pi=qt;function So({pos:e,x1:t,y1:n,x2:o,y2:a}){let l,i;switch(e){case H.Left:case H.Right:l=.5*(t+o),i=n;break;case H.Top:case H.Bottom:l=t,i=.5*(n+a);break}return[l,i]}function Co({sourceX:e,sourceY:t,sourcePosition:n=H.Bottom,targetX:o,targetY:a,targetPosition:l=H.Top}){const[i,s]=So({pos:n,x1:e,y1:t,x2:o,y2:a}),[u,c]=So({pos:l,x1:o,y1:a,x2:e,y2:t}),[d,f,h,g]=Eo({sourceX:e,sourceY:t,targetX:o,targetY:a,sourceControlX:i,sourceControlY:s,targetControlX:u,targetControlY:c});return[`M${e},${t} C${i},${s} ${u},${c} ${o},${a}`,d,f,h,g]}const Qt=function({sourcePosition:e=H.Bottom,targetPosition:t=H.Top,...n}){const[o,a,l]=Co({sourcePosition:e,targetPosition:t,...n});return r.h(ht,{path:o,labelX:a,labelY:l,...n})};Qt.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","style","interactionWidth"],Qt.inheritAttrs=!1;const gi=Qt,Mo={[H.Left]:{x:-1,y:0},[H.Right]:{x:1,y:0},[H.Top]:{x:0,y:-1},[H.Bottom]:{x:0,y:1}},mi=({source:e,sourcePosition:t=H.Bottom,target:n})=>t===H.Left||t===H.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Bo=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2);function yi({source:e,sourcePosition:t=H.Bottom,target:n,targetPosition:o=H.Top,center:a,offset:l}){const i=Mo[t],s=Mo[o],u={x:e.x+i.x*l,y:e.y+i.y*l},c={x:n.x+s.x*l,y:n.y+s.y*l},d=mi({source:u,sourcePosition:t,target:c}),f=d.x!==0?"x":"y",h=d[f];let g=[],x,E;const[N,y,b,$]=ko({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*s[f]===-1){x=a.x||N,E=a.y||y;const w=[{x,y:u.y},{x,y:c.y}],P=[{x:u.x,y:E},{x:c.x,y:E}];i[f]===h?g=f==="x"?w:P:g=f==="x"?P:w}else{const w=[{x:u.x,y:c.y}],P=[{x:c.x,y:u.y}];if(f==="x"?g=i.x===h?P:w:g=i.y===h?w:P,t!==o){const m=f==="x"?"y":"x",k=i[f]===s[m],C=u[m]>c[m],R=u[m]<c[m];(i[f]===1&&(!k&&C||k&&R)||i[f]!==1&&(!k&&R||k&&C))&&(g=f==="x"?w:P)}x=g[0].x,E=g[0].y}return[[e,u,...g,c,n],x,E,b,$]}function vi(e,t,n,o){const a=Math.min(Bo(e,t)/2,Bo(t,n)/2,o),{x:l,y:i}=t;if(e.x===l&&l===n.x||e.y===i&&i===n.y)return`L${l} ${i}`;if(e.y===i){const c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${l+a*c},${i}Q ${l},${i} ${l},${i+a*d}`}const s=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${l},${i+a*u}Q ${l},${i} ${l+a*s},${i}`}function Jt({sourceX:e,sourceY:t,sourcePosition:n=H.Bottom,targetX:o,targetY:a,targetPosition:l=H.Top,borderRadius:i=5,centerX:s,centerY:u,offset:c=20}){const[d,f,h,g,x]=yi({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:a},targetPosition:l,center:{x:s,y:u},offset:c});return[d.reduce((E,N,y)=>{let b="";return y>0&&y<d.length-1?b=vi(d[y-1],N,d[y+1],i):b=`${y===0?"M":"L"}${N.x} ${N.y}`,E+=b,E},""),f,h,g,x]}const en=function({sourcePosition:e=H.Bottom,targetPosition:t=H.Top,...n}){const[o,a,l]=Jt({sourcePosition:e,targetPosition:t,...n});return r.h(ht,{path:o,labelX:a,labelY:l,...n})};en.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","style","interactionWidth"],en.inheritAttrs=!1;const Po=en,tn=function(e){return r.h(Po,{...e,borderRadius:0})};tn.props=["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","style","interactionWidth"],tn.inheritAttrs=!1;const wi=tn;function bi({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[a,l,i,s]=ko({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,a,l,i,s]}const nn=function(e){const[t,n,o]=bi(e);return r.h(ht,{path:t,labelX:n,labelY:o,...e})};nn.props=["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","style","interactionWidth"],nn.inheritAttrs=!1;const xi=nn,_i=(e,t,n)=>n===H.Left?e-t:n===H.Right?e+t:e,ki=(e,t,n)=>n===H.Top?e-t:n===H.Bottom?e+t:e,Ro=function({radius:e=10,centerX:t=0,centerY:n=0,position:o=H.Top}){const a=()=>{const i=_i(t,e,o);return isNaN(i)?0:i},l=()=>{const i=ki(n,e,o);return isNaN(i)?0:i};return r.h("circle",{class:"vue-flow__edgeupdater",cx:a(),cy:l(),r:e,stroke:"transparent",fill:"transparent"})};Ro.props=["radius","centerX","centerY","position"];const $o=Ro,Ei=()=>({doubleClick:L(),click:L(),mouseEnter:L(),mouseMove:L(),mouseLeave:L(),contextMenu:L(),updateStart:L(),update:L(),updateEnd:L()});function Ni(e,t){const n=Ei();return n.doubleClick.on(o=>{var a,l;t.edgeDoubleClick(o),(l=(a=e.events)==null?void 0:a.doubleClick)==null||l.call(a,o)}),n.click.on(o=>{var a,l;t.edgeClick(o),(l=(a=e.events)==null?void 0:a.click)==null||l.call(a,o)}),n.mouseEnter.on(o=>{var a,l;t.edgeMouseEnter(o),(l=(a=e.events)==null?void 0:a.mouseEnter)==null||l.call(a,o)}),n.mouseMove.on(o=>{var a,l;t.edgeMouseMove(o),(l=(a=e.events)==null?void 0:a.mouseMove)==null||l.call(a,o)}),n.mouseLeave.on(o=>{var a,l;t.edgeMouseLeave(o),(l=(a=e.events)==null?void 0:a.mouseLeave)==null||l.call(a,o)}),n.contextMenu.on(o=>{var a,l;t.edgeContextMenu(o),(l=(a=e.events)==null?void 0:a.contextMenu)==null||l.call(a,o)}),n.updateStart.on(o=>{var a,l;t.edgeUpdateStart(o),(l=(a=e.events)==null?void 0:a.updateStart)==null||l.call(a,o)}),n.update.on(o=>{var a,l;t.edgeUpdate(o),(l=(a=e.events)==null?void 0:a.update)==null||l.call(a,o)}),n.updateEnd.on(o=>{var a,l;t.edgeUpdateEnd(o),(l=(a=e.events)==null?void 0:a.updateEnd)==null||l.call(a,o)}),Object.entries(n).reduce((o,[a,l])=>(o.emit[a]=l.trigger,o.on[a]=l.on,o),{emit:{},on:{}})}const zo=(e,t,n)=>{var o,a,l,i;const s=((o=n==null?void 0:n.x)!=null?o:0)+t.x,u=((a=n==null?void 0:n.y)!=null?a:0)+t.y,c=(l=n==null?void 0:n.width)!=null?l:t.width,d=(i=n==null?void 0:n.height)!=null?i:t.height;switch(e){case H.Top:return{x:s+c/2,y:u};case H.Right:return{x:s+c,y:u+d/2};case H.Bottom:return{x:s+c/2,y:u+d};case H.Left:return{x:s,y:u+d/2}}},To=(e=[],t)=>{if(!e.length)return;let n;return!t&&e.length===1?n=e[0]:t&&(n=e.find(o=>o.id===t)),n||e[0]},Si=(e,t,n,o,a,l)=>{const i=zo(n,{...e.dimensions,...e.computedPosition},t),s=zo(l,{...o.dimensions,...o.computedPosition},a);return{sourceX:i.x,sourceY:i.y,targetX:s.x,targetY:s.y}};function Ci({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:a,targetHeight:l,width:i,height:s,viewport:u}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+a),y2:Math.max(e.y+o,t.y+l)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Yn({x:(0-u.x)/u.zoom,y:(0-u.y)/u.zoom,width:i/u.zoom,height:s/u.zoom}),f=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),h=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(f*h)>0}const Mi=(e,t)=>{let n=-1;const o=e.reduce((a,l)=>{const i=t(l.source),s=t(l.target);if(!i||!s)return a;const u=l.z?l.z:Math.max(i.computedPosition.z||0,s.computedPosition.z||0);return a[u]?a[u].push(l):a[u]=[l],n=u>n?u:n,a},{});return Object.entries(Object.keys(o).length?o:{0:[]}).map(([a,l])=>{const i=+a;return{edges:l,level:i,isMaxLevel:i===n}})},Bi=r.defineComponent({props:["name","type","id","updatable","selectable","edge","sourceNode","targetNode"],setup(e){const{addSelectedEdges:t,connectionMode:n,edgeUpdaterRadius:o,emits:a,nodesSelectionActive:l,getEdges:i,getEdgeTypes:s}=te(),u=Ni(e.edge,a),c=Oe(e,"edge");let d=r.ref(!1),f=r.ref(!1);const h=r.ref(""),g=r.ref(null),x=r.ref("source"),E=r.ref("source"),N=r.ref(),y=r.ref();r.provide(la,e.id),r.provide(ia,y);const b=()=>d.value=!0,$=()=>d.value=!1,w=_=>{jn(_,i.value)||u.emit.update({edge:c.value,connection:_})},P=()=>{!N.value||(u.emit.updateEnd({event:N.value,edge:c.value}),f.value=!1)},{onMouseDown:m}=Jn({nodeId:h,handleId:g,type:x,isValidConnection:void 0,elementEdgeUpdaterType:E,onEdgeUpdate:w,onEdgeUpdateEnd:P}),k=(_,B)=>{var V;h.value=B?c.value.target:c.value.source,g.value=(V=B?c.value.targetHandle:c.value.sourceHandle)!=null?V:"",x.value=B?"target":"source",E.value=x.value,N.value=_,u.emit.updateStart({event:_,edge:c.value}),m(_)},C=_=>{const B={event:_,edge:c.value};e.selectable&&(l.value=!1,t([c.value])),u.emit.click(B)},R=_=>u.emit.contextMenu({event:_,edge:c.value}),A=_=>u.emit.doubleClick({event:_,edge:c.value}),F=_=>u.emit.mouseEnter({event:_,edge:c.value}),Z=_=>u.emit.mouseMove({event:_,edge:c.value}),q=_=>u.emit.mouseLeave({event:_,edge:c.value}),v=_=>{f.value=!0,k(_,!0)},z=_=>{f.value=!0,k(_,!1)};return()=>{if(!e.sourceNode||!e.targetNode)return null;let _;n.value===Be.Strict?_=e.sourceNode.handleBounds.source:_=[...e.sourceNode.handleBounds.source||[],...e.sourceNode.handleBounds.target||[]];const B=To(_,c.value.sourceHandle);let V;n.value===Be.Strict?V=e.targetNode.handleBounds.target:V=[...e.targetNode.handleBounds.target||[],...e.targetNode.handleBounds.source||[]];const D=To(V,c.value.targetHandle),S=B?B.position:H.Bottom,O=D?D.position:H.Top,{sourceX:X,sourceY:G,targetY:K,targetX:ee}=Si(e.sourceNode,B,S,e.targetNode,D,O);return r.h("g",{ref:y,"data-id":e.id,class:["vue-flow__edge",`vue-flow__edge-${e.type===!1?"default":e.name}`,{updating:d.value,selected:c.value.selected,animated:c.value.animated,inactive:!e.selectable}],onClick:C,onContextmenu:R,onDblclick:A,onMouseenter:F,onMousemove:Z,onMouseleave:q},[f.value?null:r.h(e.type===!1?s.value.default:e.type,{id:e.id,sourceNode:e.sourceNode,targetNode:e.targetNode,source:c.value.source,target:c.value.target,type:c.value.type,updatable:e.updatable,selected:c.value.selected,animated:c.value.animated,label:c.value.label,labelStyle:c.value.labelStyle,labelShowBg:c.value.labelShowBg,labelBgStyle:c.value.labelBgStyle,labelBgPadding:c.value.labelBgPadding,labelBgBorderRadius:c.value.labelBgBorderRadius,data:c.value.data,events:{...c.value.events,...u.on},style:c.value.style instanceof Function?c.value.style(c.value):c.value.style,markerStart:`url(#${we(c.value.markerStart)})`,markerEnd:`url(#${we(c.value.markerEnd)})`,sourcePosition:S,targetPosition:O,sourceX:X,sourceY:G,targetX:ee,targetY:K,sourceHandleId:c.value.sourceHandle,targetHandleId:c.value.targetHandle,interactionWidth:c.value.interactionWidth}),[e.updatable==="source"||e.updatable===!0?[r.h("g",{onMousedown:v,onMouseenter:b,onMouseout:$},r.h($o,{position:S,centerX:X,centerY:G,radius:o.value,"data-type":"source"}))]:null,e.updatable==="target"||e.updatable===!0?[r.h("g",{onMousedown:z,onMouseenter:b,onMouseout:$},r.h($o,{position:O,centerX:ee,centerY:K,radius:o.value,"data-type":"target"}))]:null]])}}}),Pi=Bi,Ri={height:"0",width:"0"},$i={name:"EdgeLabelRenderer"},zi=r.defineComponent({...$i,setup(e){const{viewportRef:t}=te(),n=r.computed(()=>{var o;return(o=t.value)==null?void 0:o.getElementsByClassName("vue-flow__edge-labels")[0]});return(o,a)=>(r.openBlock(),r.createElementBlock("svg",null,[(r.openBlock(),r.createElementBlock("foreignObject",Ri,[(r.openBlock(),r.createBlock(r.Teleport,{to:r.unref(n),disabled:!r.unref(n)},[r.renderSlot(o.$slots,"default")],8,["to","disabled"]))]))]))}}),Ti={class:"vue-flow__connection"},Ii=["d","marker-end","marker-start"],Vi={name:"ConnectionLine"},Oi=r.defineComponent({...Vi,props:{sourceNode:null},setup(e){var t,n,o;const a=te(),l=r.toRef(a,"getNodes"),i=r.toRef(a,"connectionMode"),s=r.toRef(a,"connectionStartHandle"),u=r.toRef(a,"connectionPosition"),c=r.toRef(a,"connectionLineType"),d=r.toRef(a,"connectionLineStyle"),f=r.toRef(a,"connectionLineOptions"),h=r.toRef(a,"viewport"),g=(t=r.inject(at))==null?void 0:t["connection-line"],x=g==null?void 0:g({}),E=s.value.handleId;s.value.nodeId;const N=s.value.type,y=(i.value===Be.Strict?(n=e.sourceNode.handleBounds[N])==null?void 0:n.find(A=>A.id===E):[...e.sourceNode.handleBounds.source||[],...e.sourceNode.handleBounds.target||[]].find(A=>A.id===E))||((o=e.sourceNode.handleBounds[N??"source"])==null?void 0:o[0]),b=y?y.x+y.width/2:e.sourceNode.dimensions.width/2,$=y?y.y+y.height/2:e.sourceNode.dimensions.height,w=e.sourceNode.computedPosition.x+b,P=e.sourceNode.computedPosition.y+$,m=(y==null?void 0:y.position)===H.Left||(y==null?void 0:y.position)===H.Right?H.Left:H.Top,k=r.computed(()=>(u.value.x-h.value.x)/h.value.zoom),C=r.computed(()=>(u.value.y-h.value.y)/h.value.zoom),R=r.computed(()=>{let A=`M${w},${P} ${k.value},${C.value}`;const F={sourceX:w,sourceY:P,sourcePosition:y==null?void 0:y.position,targetX:k.value,targetY:C.value,targetPosition:m};switch(c.value||f.value.type){case be.Bezier:[A]=Gt(F);break;case be.Step:[A]=Jt({...F,borderRadius:0});break;case be.SmoothStep:[A]=Jt(F);break;case be.SimpleBezier:[A]=Co(F);break}return A});return(A,F)=>{var Z;return r.openBlock(),r.createElementBlock("g",Ti,[r.unref(x)?(r.openBlock(),r.createBlock(r.resolveDynamicComponent(r.unref(g)),r.normalizeProps(r.mergeProps({key:0},{sourceX:w,sourceY:P,sourcePosition:(Z=r.unref(y))==null?void 0:Z.position,targetX:k.value,targetY:C.value,targetPosition:r.unref(m),nodes:l.value,sourceNode:e.sourceNode,sourceHandle:r.unref(y),markerEnd:`url(#${r.unref(we)(f.value.markerEnd)})`,markerStart:`url(#${r.unref(we)(f.value.markerStart)})`})),null,16)):(r.openBlock(),r.createElementBlock("path",{key:1,d:r.unref(R),class:r.normalizeClass(["vue-flow__connection-path",f.value.class]),style:r.normalizeStyle(d.value||f.value.style||{}),"marker-end":`url(#${r.unref(we)(f.value.markerEnd)})`,"marker-start":`url(#${r.unref(we)(f.value.markerStart)})`},null,14,Ii))])}}}),Ai={name:"NodesSelection"},Di=r.defineComponent({...Ai,setup(e){const t=te(),n=r.toRef(t,"emits");r.toRef(t,"setState");const o=r.toRef(t,"viewport"),a=r.toRef(t,"getSelectedNodes");r.toRef(t,"snapToGrid"),r.toRef(t,"snapGrid");const l=r.toRef(t,"noPanClassName"),i=r.ref(),s=_o({el:i,onStart(f,h,g){n.value.selectionDragStart({event:f,node:h,nodes:g})},onDrag(f,h,g){n.value.selectionDrag({event:f,node:h,nodes:g})},onStop(f,h,g){n.value.selectionDragStop({event:f,node:h,nodes:g})}}),u=r.computed(()=>Fn(a.value)),c=r.computed(()=>({width:`${u.value.width}px`,height:`${u.value.height}px`,top:`${u.value.y}px`,left:`${u.value.x}px`})),d=f=>n.value.selectionContextMenu({event:f,nodes:a.value});return(f,h)=>(r.openBlock(),r.createElementBlock("div",{class:r.normalizeClass(["vue-flow__nodesselection vue-flow__container",l.value]),style:r.normalizeStyle({transform:`translate(${o.value.x}px,${o.value.y}px) scale(${o.value.zoom})`})},[r.createElementVNode("div",{ref_key:"el",ref:i,class:r.normalizeClass([{dragging:r.unref(s)},"vue-flow__nodesselection-rect"]),style:r.normalizeStyle(r.unref(c)),onContextmenu:d},null,38)],6))}}),Xi={name:"SelectionRect"},Li=r.defineComponent({...Xi,props:{width:null,height:null,x:null,y:null},setup(e){return(t,n)=>(r.openBlock(),r.createElementBlock("div",{class:"vue-flow__selection",style:r.normalizeStyle({width:`${e.width}px`,height:`${e.height}px`,transform:`translate(${e.x}px, ${e.y}px)`})},null,4))}});function Io(e){const t=e.target.closest(".vue-flow");if(!t)return;const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}const Hi={name:"UserSelection"},ji=r.defineComponent({...Hi,setup(e){const{userSelectionActive:t,nodesSelectionActive:n,getNodes:o,getEdges:a,viewport:l,addSelectedElements:i}=te();let s=r.ref(0),u=r.ref(0);const c=()=>({width:0,height:0,startX:0,startY:0,x:0,y:0,draw:!1});let d=r.ref(c());const f=()=>{d.value=c(),s.value=0,u.value=0,t.value=!1},h=E=>{const N=Io(E);!N||(d.value={width:0,height:0,startX:N.x,startY:N.y,x:N.x,y:N.y,draw:!0},t.value=!0)},g=E=>{if(!t||!d.value.draw)return;const N=Io(E);if(!N)return;const y=d.value.startX,b=d.value.startY,$={...d.value,x:N.x<y?N.x:d.value.x,y:N.y<b?N.y:d.value.y,width:Math.abs(N.x-y),height:Math.abs(N.y-b)},w=Un(o.value,d.value,l.value),P=ot(w,a.value);d.value=$,i([...w,...P]),s.value=w.length,u.value=P.length},x=()=>{d.value=c(),n.value=s.value>0,t.value=!1};return r.onBeforeUnmount(f),(E,N)=>(r.openBlock(),r.createElementBlock("div",{class:"vue-flow__selectionpane vue-flow__container",onMousedown:h,onMousemove:g,onClick:x,onMouseup:x},[d.value.draw?(r.openBlock(),r.createBlock(Li,{key:0,width:d.value.width,height:d.value.height,x:d.value.x,y:d.value.y},null,8,["width","height","x","y"])):r.createCommentVNode("",!0)],32))}}),Yi={input:fa,default:da,output:ha},Fi={default:pi,straight:xi,step:wi,smoothstep:Po,simplebezier:gi},Ui=()=>({vueFlowRef:null,viewportRef:null,nodes:[],edges:[],nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:rt.Free,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultZoom:1,defaultPosition:[0,0],nodesSelectionActive:!1,userSelectionActive:!1,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:be.Bezier,connectionLineOptions:{type:be.Bezier,style:{}},connectionMode:Be.Loose,connectionStartHandle:null,connectionClickStartHandle:null,connectionPosition:{x:NaN,y:NaN},connectOnClick:!0,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,nodesConnectable:!0,nodesDraggable:!0,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:"Meta",zoomActivationKeyCode:"Meta",deleteKeyCode:"Backspace",hooks:Gr(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,__experimentalFeatures:{nestedFlow:!1},vueFlowVersion:"1.5.11"});function Vo(e){const t=Ui();return e&&Object.keys(e).forEach(n=>{const o=e[n];J(o)&&(t[n]=o)}),t}function Zi(e){const t=r.computed(()=>e.nodes.map(x=>x.id)),n=r.computed(()=>e.edges.map(x=>x.id)),o=r.computed(()=>x=>e.nodes&&!t.value.length?e.nodes.find(E=>E.id===x):e.nodes[t.value.indexOf(x)]),a=r.computed(()=>x=>e.edges&&!n.value.length?e.edges.find(E=>E.id===x):e.edges[n.value.indexOf(x)]),l=r.computed(()=>{var x;const E={...Fi,...e.edgeTypes},N=Object.keys(E);return(x=e.edges)==null||x.forEach(y=>y.type&&!N.includes(y.type)&&(E[y.type]=y.type)),E}),i=r.computed(()=>{var x;const E={...Yi,...e.nodeTypes},N=Object.keys(E);return(x=e.nodes)==null||x.forEach(y=>y.type&&!N.includes(y.type)&&(E[y.type]=y.type)),E}),s=r.computed(()=>{const x=e.nodes.filter(E=>!E.hidden);return e.onlyRenderVisibleElements?x&&Un(x,{x:0,y:0,width:e.dimensions.width,height:e.dimensions.height},e.viewport,!0):x??[]}),u=(x,E,N)=>{if(E=E??o.value(x.source),N=N??o.value(x.target),!E||!N){e.edges=e.edges.filter(y=>y.id!==x.id),re(`Orphaned edge ${x.id} removed.`);return}return!x.hidden&&!N.hidden&&!E.hidden},c=r.computed(()=>e.onlyRenderVisibleElements?e.edges.filter(x=>{const E=o.value(x.source),N=o.value(x.target);return u(x,E,N)&&Ci({sourcePos:E.computedPosition||{x:0,y:0},targetPos:N.computedPosition||{x:0,y:0},sourceWidth:E.dimensions.width,sourceHeight:E.dimensions.height,targetWidth:N.dimensions.width,targetHeight:N.dimensions.height,width:e.dimensions.width,height:e.dimensions.height,viewport:e.viewport})}):e.edges.filter(x=>u(x))),d=r.computed(()=>[...s.value,...c.value]),f=r.computed(()=>e.nodes.filter(x=>x.selected)),h=r.computed(()=>e.edges.filter(x=>x.selected)),g=r.computed(()=>{var x,E;return[...(x=f.value)!=null?x:[],...(E=h.value)!=null?E:[]]});return{getNode:o,getEdge:a,getElements:d,getEdgeTypes:l,getNodeTypes:i,getEdges:c,getNodes:s,getSelectedElements:g,getSelectedNodes:f,getSelectedEdges:h}}function on(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Oo(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Ye(){}var Fe=.7,gt=1/Fe,ze="\\s*([+-]?\\d+)\\s*",Ue="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ue="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wi=/^#([0-9a-f]{3,8})$/,Ki=new RegExp(`^rgb\\(${ze},${ze},${ze}\\)$`),Gi=new RegExp(`^rgb\\(${ue},${ue},${ue}\\)$`),qi=new RegExp(`^rgba\\(${ze},${ze},${ze},${Ue}\\)$`),Qi=new RegExp(`^rgba\\(${ue},${ue},${ue},${Ue}\\)$`),Ji=new RegExp(`^hsl\\(${Ue},${ue},${ue}\\)$`),es=new RegExp(`^hsla\\(${Ue},${ue},${ue},${Ue}\\)$`),Ao={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};on(Ye,Ze,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Do,formatHex:Do,formatHex8:ts,formatHsl:ns,formatRgb:Xo,toString:Xo});function Do(){return this.rgb().formatHex()}function ts(){return this.rgb().formatHex8()}function ns(){return Fo(this).formatHsl()}function Xo(){return this.rgb().formatRgb()}function Ze(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wi.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Lo(t):n===3?new ne(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?mt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?mt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ki.exec(e))?new ne(t[1],t[2],t[3],1):(t=Gi.exec(e))?new ne(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qi.exec(e))?mt(t[1],t[2],t[3],t[4]):(t=Qi.exec(e))?mt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ji.exec(e))?Yo(t[1],t[2]/100,t[3]/100,1):(t=es.exec(e))?Yo(t[1],t[2]/100,t[3]/100,t[4]):Ao.hasOwnProperty(e)?Lo(Ao[e]):e==="transparent"?new ne(NaN,NaN,NaN,0):null}function Lo(e){return new ne(e>>16&255,e>>8&255,e&255,1)}function mt(e,t,n,o){return o<=0&&(e=t=n=NaN),new ne(e,t,n,o)}function os(e){return e instanceof Ye||(e=Ze(e)),e?(e=e.rgb(),new ne(e.r,e.g,e.b,e.opacity)):new ne}function rn(e,t,n,o){return arguments.length===1?os(e):new ne(e,t,n,o??1)}function ne(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}on(ne,rn,Oo(Ye,{brighter(e){return e=e==null?gt:Math.pow(gt,e),new ne(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Fe:Math.pow(Fe,e),new ne(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ne(xe(this.r),xe(this.g),xe(this.b),yt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ho,formatHex:Ho,formatHex8:rs,formatRgb:jo,toString:jo}));function Ho(){return`#${_e(this.r)}${_e(this.g)}${_e(this.b)}`}function rs(){return`#${_e(this.r)}${_e(this.g)}${_e(this.b)}${_e((isNaN(this.opacity)?1:this.opacity)*255)}`}function jo(){const e=yt(this.opacity);return`${e===1?"rgb(":"rgba("}${xe(this.r)}, ${xe(this.g)}, ${xe(this.b)}${e===1?")":`, ${e})`}`}function yt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xe(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function _e(e){return e=xe(e),(e<16?"0":"")+e.toString(16)}function Yo(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new le(e,t,n,o)}function Fo(e){if(e instanceof le)return new le(e.h,e.s,e.l,e.opacity);if(e instanceof Ye||(e=Ze(e)),!e)return new le;if(e instanceof le)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,a=Math.min(t,n,o),l=Math.max(t,n,o),i=NaN,s=l-a,u=(l+a)/2;return s?(t===l?i=(n-o)/s+(n<o)*6:n===l?i=(o-t)/s+2:i=(t-n)/s+4,s/=u<.5?l+a:2-l-a,i*=60):s=u>0&&u<1?0:i,new le(i,s,u,e.opacity)}function as(e,t,n,o){return arguments.length===1?Fo(e):new le(e,t,n,o??1)}function le(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}on(le,as,Oo(Ye,{brighter(e){return e=e==null?gt:Math.pow(gt,e),new le(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Fe:Math.pow(Fe,e),new le(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,a=2*n-o;return new ne(an(e>=240?e-240:e+120,a,o),an(e,a,o),an(e<120?e+240:e-120,a,o),this.opacity)},clamp(){return new le(Uo(this.h),vt(this.s),vt(this.l),yt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yt(this.opacity);return`${e===1?"hsl(":"hsla("}${Uo(this.h)}, ${vt(this.s)*100}%, ${vt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Uo(e){return e=(e||0)%360,e<0?e+360:e}function vt(e){return Math.max(0,Math.min(1,e||0))}function an(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Zo=e=>()=>e;function ls(e,t){return function(n){return e+n*t}}function is(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function ss(e){return(e=+e)==1?Wo:function(t,n){return n-t?is(t,n,e):Zo(isNaN(t)?n:t)}}function Wo(e,t){var n=t-e;return n?ls(e,n):Zo(isNaN(e)?t:e)}const Ko=function e(t){var n=ss(t);function o(a,l){var i=n((a=rn(a)).r,(l=rn(l)).r),s=n(a.g,l.g),u=n(a.b,l.b),c=Wo(a.opacity,l.opacity);return function(d){return a.r=i(d),a.g=s(d),a.b=u(d),a.opacity=c(d),a+""}}return o.gamma=e,o}(1);function ve(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ln=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sn=new RegExp(ln.source,"g");function us(e){return function(){return e}}function cs(e){return function(t){return e(t)+""}}function ds(e,t){var n=ln.lastIndex=sn.lastIndex=0,o,a,l,i=-1,s=[],u=[];for(e=e+"",t=t+"";(o=ln.exec(e))&&(a=sn.exec(t));)(l=a.index)>n&&(l=t.slice(n,l),s[i]?s[i]+=l:s[++i]=l),(o=o[0])===(a=a[0])?s[i]?s[i]+=a:s[++i]=a:(s[++i]=null,u.push({i,x:ve(o,a)})),n=sn.lastIndex;return n<t.length&&(l=t.slice(n),s[i]?s[i]+=l:s[++i]=l),s.length<2?u[0]?cs(u[0].x):us(t):(t=u.length,function(c){for(var d=0,f;d<t;++d)s[(f=u[d]).i]=f.x(c);return s.join("")})}var Go=180/Math.PI,qo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qo(e,t,n,o,a,l){var i,s,u;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(u=e*n+t*o)&&(n-=e*u,o-=t*u),(s=Math.sqrt(n*n+o*o))&&(n/=s,o/=s,u/=s),e*o<t*n&&(e=-e,t=-t,u=-u,i=-i),{translateX:a,translateY:l,rotate:Math.atan2(t,e)*Go,skewX:Math.atan(u)*Go,scaleX:i,scaleY:s}}var wt;function fs(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?qo:Qo(t.a,t.b,t.c,t.d,t.e,t.f)}function hs(e){return e==null||(wt||(wt=document.createElementNS("http://www.w3.org/2000/svg","g")),wt.setAttribute("transform",e),!(e=wt.transform.baseVal.consolidate()))?qo:(e=e.matrix,Qo(e.a,e.b,e.c,e.d,e.e,e.f))}function Jo(e,t,n,o){function a(c){return c.length?c.pop()+" ":""}function l(c,d,f,h,g,x){if(c!==f||d!==h){var E=g.push("translate(",null,t,null,n);x.push({i:E-4,x:ve(c,f)},{i:E-2,x:ve(d,h)})}else(f||h)&&g.push("translate("+f+t+h+n)}function i(c,d,f,h){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),h.push({i:f.push(a(f)+"rotate(",null,o)-2,x:ve(c,d)})):d&&f.push(a(f)+"rotate("+d+o)}function s(c,d,f,h){c!==d?h.push({i:f.push(a(f)+"skewX(",null,o)-2,x:ve(c,d)}):d&&f.push(a(f)+"skewX("+d+o)}function u(c,d,f,h,g,x){if(c!==f||d!==h){var E=g.push(a(g)+"scale(",null,",",null,")");x.push({i:E-4,x:ve(c,f)},{i:E-2,x:ve(d,h)})}else(f!==1||h!==1)&&g.push(a(g)+"scale("+f+","+h+")")}return function(c,d){var f=[],h=[];return c=e(c),d=e(d),l(c.translateX,c.translateY,d.translateX,d.translateY,f,h),i(c.rotate,d.rotate,f,h),s(c.skewX,d.skewX,f,h),u(c.scaleX,c.scaleY,d.scaleX,d.scaleY,f,h),c=d=null,function(g){for(var x=-1,E=h.length,N;++x<E;)f[(N=h[x]).i]=N.x(g);return f.join("")}}}var ps=Jo(fs,"px, ","px)","deg)"),gs=Jo(hs,", ",")",")"),ms=1e-12;function er(e){return((e=Math.exp(e))+1/e)/2}function ys(e){return((e=Math.exp(e))-1/e)/2}function vs(e){return((e=Math.exp(2*e))-1)/(e+1)}const ws=function e(t,n,o){function a(l,i){var s=l[0],u=l[1],c=l[2],d=i[0],f=i[1],h=i[2],g=d-s,x=f-u,E=g*g+x*x,N,y;if(E<ms)y=Math.log(h/c)/t,N=function(k){return[s+k*g,u+k*x,c*Math.exp(t*k*y)]};else{var b=Math.sqrt(E),$=(h*h-c*c+o*E)/(2*c*n*b),w=(h*h-c*c-o*E)/(2*h*n*b),P=Math.log(Math.sqrt($*$+1)-$),m=Math.log(Math.sqrt(w*w+1)-w);y=(m-P)/t,N=function(k){var C=k*y,R=er(P),A=c/(n*b)*(R*vs(t*C+P)-ys(P));return[s+A*g,u+A*x,c*R/er(t*C+P)]}}return N.duration=y*1e3*t/Math.SQRT2,N}return a.rho=function(l){var i=Math.max(.001,+l),s=i*i,u=s*s;return e(i,s,u)},a}(Math.SQRT2,2,4);var Te=0,We=0,Ke=0,tr=1e3,bt,Ge,xt=0,ke=0,_t=0,qe=typeof performance=="object"&&performance.now?performance:Date,nr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function un(){return ke||(nr(bs),ke=qe.now()+_t)}function bs(){ke=0}function kt(){this._call=this._time=this._next=null}kt.prototype=or.prototype={constructor:kt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?un():+n)+(t==null?0:+t),!this._next&&Ge!==this&&(Ge?Ge._next=this:bt=this,Ge=this),this._call=e,this._time=n,cn()},stop:function(){this._call&&(this._call=null,this._time=1/0,cn())}};function or(e,t,n){var o=new kt;return o.restart(e,t,n),o}function xs(){un(),++Te;for(var e=bt,t;e;)(t=ke-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Te}function rr(){ke=(xt=qe.now())+_t,Te=We=0;try{xs()}finally{Te=0,ks(),ke=0}}function _s(){var e=qe.now(),t=e-xt;t>tr&&(_t-=t,xt=e)}function ks(){for(var e,t=bt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:bt=n);Ge=e,cn(o)}function cn(e){if(!Te){We&&(We=clearTimeout(We));var t=e-ke;t>24?(e<1/0&&(We=setTimeout(rr,e-qe.now()-_t)),Ke&&(Ke=clearInterval(Ke))):(Ke||(xt=qe.now(),Ke=setInterval(_s,tr)),Te=1,nr(rr))}}function ar(e,t,n){var o=new kt;return t=t==null?0:+t,o.restart(a=>{o.stop(),e(a+t)},t,n),o}var Es=st("start","end","cancel","interrupt"),Ns=[],lr=0,ir=1,dn=2,Et=3,sr=4,fn=5,Nt=6;function St(e,t,n,o,a,l){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Ss(e,n,{name:t,index:o,group:a,on:Es,tween:Ns,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:lr})}function hn(e,t){var n=ie(e,t);if(n.state>lr)throw new Error("too late; already scheduled");return n}function ce(e,t){var n=ie(e,t);if(n.state>Et)throw new Error("too late; already running");return n}function ie(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ss(e,t,n){var o=e.__transition,a;o[t]=n,n.timer=or(l,0,n.time);function l(c){n.state=ir,n.timer.restart(i,n.delay,n.time),n.delay<=c&&i(c-n.delay)}function i(c){var d,f,h,g;if(n.state!==ir)return u();for(d in o)if(g=o[d],g.name===n.name){if(g.state===Et)return ar(i);g.state===sr?(g.state=Nt,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete o[d]):+d<t&&(g.state=Nt,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete o[d])}if(ar(function(){n.state===Et&&(n.state=sr,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=dn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===dn){for(n.state=Et,a=new Array(h=n.tween.length),d=0,f=-1;d<h;++d)(g=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(a[++f]=g);a.length=f+1}}function s(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=fn,1),f=-1,h=a.length;++f<h;)a[f].call(e,d);n.state===fn&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Nt,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function Ct(e,t){var n=e.__transition,o,a,l=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((o=n[i]).name!==t){l=!1;continue}a=o.state>dn&&o.state<fn,o.state=Nt,o.timer.stop(),o.on.call(a?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[i]}l&&delete e.__transition}}function Cs(e){return this.each(function(){Ct(this,e)})}function Ms(e,t){var n,o;return function(){var a=ce(this,e),l=a.tween;if(l!==n){o=n=l;for(var i=0,s=o.length;i<s;++i)if(o[i].name===t){o=o.slice(),o.splice(i,1);break}}a.tween=o}}function Bs(e,t,n){var o,a;if(typeof n!="function")throw new Error;return function(){var l=ce(this,e),i=l.tween;if(i!==o){a=(o=i).slice();for(var s={name:t,value:n},u=0,c=a.length;u<c;++u)if(a[u].name===t){a[u]=s;break}u===c&&a.push(s)}l.tween=a}}function Ps(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ie(this.node(),n).tween,a=0,l=o.length,i;a<l;++a)if((i=o[a]).name===e)return i.value;return null}return this.each((t==null?Ms:Bs)(n,e,t))}function pn(e,t,n){var o=e._id;return e.each(function(){var a=ce(this,o);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return ie(a,o).value[t]}}function ur(e,t){var n;return(typeof t=="number"?ve:t instanceof Ze?Ko:(n=Ze(t))?(t=n,Ko):ds)(e,t)}function Rs(e){return function(){this.removeAttribute(e)}}function $s(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zs(e,t,n){var o,a=n+"",l;return function(){var i=this.getAttribute(e);return i===a?null:i===o?l:l=t(o=i,n)}}function Ts(e,t,n){var o,a=n+"",l;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===o?l:l=t(o=i,n)}}function Is(e,t,n){var o,a,l;return function(){var i,s=n(this),u;return s==null?void this.removeAttribute(e):(i=this.getAttribute(e),u=s+"",i===u?null:i===o&&u===a?l:(a=u,l=t(o=i,s)))}}function Vs(e,t,n){var o,a,l;return function(){var i,s=n(this),u;return s==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),u=s+"",i===u?null:i===o&&u===a?l:(a=u,l=t(o=i,s)))}}function Os(e,t){var n=ct(e),o=n==="transform"?gs:ur;return this.attrTween(e,typeof t=="function"?(n.local?Vs:Is)(n,o,pn(this,"attr."+e,t)):t==null?(n.local?$s:Rs)(n):(n.local?Ts:zs)(n,o,t))}function As(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Ds(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Xs(e,t){var n,o;function a(){var l=t.apply(this,arguments);return l!==o&&(n=(o=l)&&Ds(e,l)),n}return a._value=t,a}function Ls(e,t){var n,o;function a(){var l=t.apply(this,arguments);return l!==o&&(n=(o=l)&&As(e,l)),n}return a._value=t,a}function Hs(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=ct(e);return this.tween(n,(o.local?Xs:Ls)(o,t))}function js(e,t){return function(){hn(this,e).delay=+t.apply(this,arguments)}}function Ys(e,t){return t=+t,function(){hn(this,e).delay=t}}function Fs(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?js:Ys)(t,e)):ie(this.node(),t).delay}function Us(e,t){return function(){ce(this,e).duration=+t.apply(this,arguments)}}function Zs(e,t){return t=+t,function(){ce(this,e).duration=t}}function Ws(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Us:Zs)(t,e)):ie(this.node(),t).duration}function Ks(e,t){if(typeof t!="function")throw new Error;return function(){ce(this,e).ease=t}}function Gs(e){var t=this._id;return arguments.length?this.each(Ks(t,e)):ie(this.node(),t).ease}function qs(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ce(this,e).ease=n}}function Qs(e){if(typeof e!="function")throw new Error;return this.each(qs(this._id,e))}function Js(e){typeof e!="function"&&(e=uo(e));for(var t=this._groups,n=t.length,o=new Array(n),a=0;a<n;++a)for(var l=t[a],i=l.length,s=o[a]=[],u,c=0;c<i;++c)(u=l[c])&&e.call(u,u.__data__,c,l)&&s.push(u);return new fe(o,this._parents,this._name,this._id)}function eu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,a=n.length,l=Math.min(o,a),i=new Array(o),s=0;s<l;++s)for(var u=t[s],c=n[s],d=u.length,f=i[s]=new Array(d),h,g=0;g<d;++g)(h=u[g]||c[g])&&(f[g]=h);for(;s<o;++s)i[s]=t[s];return new fe(i,this._parents,this._name,this._id)}function tu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function nu(e,t,n){var o,a,l=tu(t)?hn:ce;return function(){var i=l(this,e),s=i.on;s!==o&&(a=(o=s).copy()).on(t,n),i.on=a}}function ou(e,t){var n=this._id;return arguments.length<2?ie(this.node(),n).on.on(e):this.each(nu(n,e,t))}function ru(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function au(){return this.on("end.remove",ru(this._id))}function lu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ft(e));for(var o=this._groups,a=o.length,l=new Array(a),i=0;i<a;++i)for(var s=o[i],u=s.length,c=l[i]=new Array(u),d,f,h=0;h<u;++h)(d=s[h])&&(f=e.call(d,d.__data__,h,s))&&("__data__"in d&&(f.__data__=d.__data__),c[h]=f,St(c[h],t,n,h,c,ie(d,n)));return new fe(l,this._parents,t,n)}function iu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=so(e));for(var o=this._groups,a=o.length,l=[],i=[],s=0;s<a;++s)for(var u=o[s],c=u.length,d,f=0;f<c;++f)if(d=u[f]){for(var h=e.call(d,d.__data__,f,u),g,x=ie(d,n),E=0,N=h.length;E<N;++E)(g=h[E])&&St(g,t,n,E,h,x);l.push(h),i.push(d)}return new fe(l,i,t,n)}var su=He.prototype.constructor;function uu(){return new su(this._groups,this._parents)}function cu(e,t){var n,o,a;return function(){var l=Re(this,e),i=(this.style.removeProperty(e),Re(this,e));return l===i?null:l===n&&i===o?a:a=t(n=l,o=i)}}function cr(e){return function(){this.style.removeProperty(e)}}function du(e,t,n){var o,a=n+"",l;return function(){var i=Re(this,e);return i===a?null:i===o?l:l=t(o=i,n)}}function fu(e,t,n){var o,a,l;return function(){var i=Re(this,e),s=n(this),u=s+"";return s==null&&(u=s=(this.style.removeProperty(e),Re(this,e))),i===u?null:i===o&&u===a?l:(a=u,l=t(o=i,s))}}function hu(e,t){var n,o,a,l="style."+t,i="end."+l,s;return function(){var u=ce(this,e),c=u.on,d=u.value[l]==null?s||(s=cr(t)):void 0;(c!==n||a!==d)&&(o=(n=c).copy()).on(i,a=d),u.on=o}}function pu(e,t,n){var o=(e+="")=="transform"?ps:ur;return t==null?this.styleTween(e,cu(e,o)).on("end.style."+e,cr(e)):typeof t=="function"?this.styleTween(e,fu(e,o,pn(this,"style."+e,t))).each(hu(this._id,e)):this.styleTween(e,du(e,o,t),n).on("end.style."+e,null)}function gu(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function mu(e,t,n){var o,a;function l(){var i=t.apply(this,arguments);return i!==a&&(o=(a=i)&&gu(e,i,n)),o}return l._value=t,l}function yu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,mu(e,t,n??""))}function vu(e){return function(){this.textContent=e}}function wu(e){return function(){var t=e(this);this.textContent=t??""}}function bu(e){return this.tween("text",typeof e=="function"?wu(pn(this,"text",e)):vu(e==null?"":e+""))}function xu(e){return function(t){this.textContent=e.call(this,t)}}function _u(e){var t,n;function o(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&xu(a)),t}return o._value=e,o}function ku(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,_u(e))}function Eu(){for(var e=this._name,t=this._id,n=dr(),o=this._groups,a=o.length,l=0;l<a;++l)for(var i=o[l],s=i.length,u,c=0;c<s;++c)if(u=i[c]){var d=ie(u,t);St(u,e,n,c,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new fe(o,this._parents,e,n)}function Nu(){var e,t,n=this,o=n._id,a=n.size();return new Promise(function(l,i){var s={value:i},u={value:function(){--a===0&&l()}};n.each(function(){var c=ce(this,o),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),c.on=t}),a===0&&l()})}var Su=0;function fe(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function dr(){return++Su}var he=He.prototype;fe.prototype={constructor:fe,select:lu,selectAll:iu,selectChild:he.selectChild,selectChildren:he.selectChildren,filter:Js,merge:eu,selection:uu,transition:Eu,call:he.call,nodes:he.nodes,node:he.node,size:he.size,empty:he.empty,each:he.each,on:ou,attr:Os,attrTween:Hs,style:pu,styleTween:yu,text:bu,textTween:ku,remove:au,tween:Ps,delay:Fs,duration:Ws,ease:Gs,easeVarying:Qs,end:Nu,[Symbol.iterator]:he[Symbol.iterator]};function Cu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Mu={time:null,delay:0,duration:250,ease:Cu};function Bu(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Pu(e){var t,n;e instanceof fe?(t=e._id,e=e._name):(t=dr(),(n=Mu).time=un(),e=e==null?null:e+"");for(var o=this._groups,a=o.length,l=0;l<a;++l)for(var i=o[l],s=i.length,u,c=0;c<s;++c)(u=i[c])&&St(u,e,t,c,i,n||Bu(u,t));return new fe(o,this._parents,e,t)}He.prototype.interrupt=Cs,He.prototype.transition=Pu;const Mt=e=>()=>e;function Ru(e,{sourceEvent:t,target:n,transform:o,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:a}})}function pe(e,t,n){this.k=e,this.x=t,this.y=n}pe.prototype={constructor:pe,scale:function(e){return e===1?this:new pe(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new pe(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Bt=new pe(1,0,0);pe.prototype;function gn(e){e.stopImmediatePropagation()}function Qe(e){e.preventDefault(),e.stopImmediatePropagation()}function $u(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function zu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function fr(){return this.__zoom||Bt}function Tu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Iu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a),i>l?(l+i)/2:Math.min(0,l)||Math.max(0,i))}function Ou(){var e=$u,t=zu,n=Vu,o=Tu,a=Iu,l=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,u=ws,c=st("start","zoom","end"),d,f,h,g=500,x=150,E=0,N=10;function y(v){v.property("__zoom",fr).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",A).filter(a).on("touchstart.zoom",F).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(v,z,_,B){var V=v.selection?v.selection():v;V.property("__zoom",fr),v!==V?P(v,z,_,B):V.interrupt().each(function(){m(this,arguments).event(B).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},y.scaleBy=function(v,z,_,B){y.scaleTo(v,function(){var V=this.__zoom.k,D=typeof z=="function"?z.apply(this,arguments):z;return V*D},_,B)},y.scaleTo=function(v,z,_,B){y.transform(v,function(){var V=t.apply(this,arguments),D=this.__zoom,S=_==null?w(V):typeof _=="function"?_.apply(this,arguments):_,O=D.invert(S),X=typeof z=="function"?z.apply(this,arguments):z;return n($(b(D,X),S,O),V,i)},_,B)},y.translateBy=function(v,z,_,B){y.transform(v,function(){return n(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof _=="function"?_.apply(this,arguments):_),t.apply(this,arguments),i)},null,B)},y.translateTo=function(v,z,_,B,V){y.transform(v,function(){var D=t.apply(this,arguments),S=this.__zoom,O=B==null?w(D):typeof B=="function"?B.apply(this,arguments):B;return n(Bt.translate(O[0],O[1]).scale(S.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof _=="function"?-_.apply(this,arguments):-_),D,i)},B,V)};function b(v,z){return z=Math.max(l[0],Math.min(l[1],z)),z===v.k?v:new pe(z,v.x,v.y)}function $(v,z,_){var B=z[0]-_[0]*v.k,V=z[1]-_[1]*v.k;return B===v.x&&V===v.y?v:new pe(v.k,B,V)}function w(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function P(v,z,_,B){v.on("start.zoom",function(){m(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){m(this,arguments).event(B).end()}).tween("zoom",function(){var V=this,D=arguments,S=m(V,D).event(B),O=t.apply(V,D),X=_==null?w(O):typeof _=="function"?_.apply(V,D):_,G=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),K=V.__zoom,ee=typeof z=="function"?z.apply(V,D):z,p=u(K.invert(X).concat(G/K.k),ee.invert(X).concat(G/ee.k));return function(M){if(M===1)M=ee;else{var T=p(M),I=G/T[2];M=new pe(I,X[0]-T[0]*I,X[1]-T[1]*I)}S.zoom(null,M)}})}function m(v,z,_){return!_&&v.__zooming||new k(v,z)}function k(v,z){this.that=v,this.args=z,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,z),this.taps=0}k.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,z){return this.mouse&&v!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var z=ae(this.that).datum();c.call(v,this.that,new Ru(v,{sourceEvent:this.sourceEvent,target:y,type:v,transform:this.that.__zoom,dispatch:c}),z)}};function C(v,...z){if(!e.apply(this,arguments))return;var _=m(this,z).event(v),B=this.__zoom,V=Math.max(l[0],Math.min(l[1],B.k*Math.pow(2,o.apply(this,arguments)))),D=se(v);if(_.wheel)(_.mouse[0][0]!==D[0]||_.mouse[0][1]!==D[1])&&(_.mouse[1]=B.invert(_.mouse[0]=D)),clearTimeout(_.wheel);else{if(B.k===V)return;_.mouse=[D,B.invert(D)],Ct(this),_.start()}Qe(v),_.wheel=setTimeout(S,x),_.zoom("mouse",n($(b(B,V),_.mouse[0],_.mouse[1]),_.extent,i));function S(){_.wheel=null,_.end()}}function R(v,...z){if(h||!e.apply(this,arguments))return;var _=v.currentTarget,B=m(this,z,!0).event(v),V=ae(v.view).on("mousemove.zoom",X,!0).on("mouseup.zoom",G,!0),D=se(v,_),S=v.clientX,O=v.clientY;bo(v.view),gn(v),B.mouse=[D,this.__zoom.invert(D)],Ct(this),B.start();function X(K){if(Qe(K),!B.moved){var ee=K.clientX-S,p=K.clientY-O;B.moved=ee*ee+p*p>E}B.event(K).zoom("mouse",n($(B.that.__zoom,B.mouse[0]=se(K,_),B.mouse[1]),B.extent,i))}function G(K){V.on("mousemove.zoom mouseup.zoom",null),xo(K.view,B.moved),Qe(K),B.event(K).end()}}function A(v,...z){if(e.apply(this,arguments)){var _=this.__zoom,B=se(v.changedTouches?v.changedTouches[0]:v,this),V=_.invert(B),D=_.k*(v.shiftKey?.5:2),S=n($(b(_,D),B,V),t.apply(this,z),i);Qe(v),s>0?ae(this).transition().duration(s).call(P,S,B,v):ae(this).call(y.transform,S,B,v)}}function F(v,...z){if(e.apply(this,arguments)){var _=v.touches,B=_.length,V=m(this,z,v.changedTouches.length===B).event(v),D,S,O,X;for(gn(v),S=0;S<B;++S)O=_[S],X=se(O,this),X=[X,this.__zoom.invert(X),O.identifier],V.touch0?!V.touch1&&V.touch0[2]!==X[2]&&(V.touch1=X,V.taps=0):(V.touch0=X,D=!0,V.taps=1+!!d);d&&(d=clearTimeout(d)),D&&(V.taps<2&&(f=X[0],d=setTimeout(function(){d=null},g)),Ct(this),V.start())}}function Z(v,...z){if(this.__zooming){var _=m(this,z).event(v),B=v.changedTouches,V=B.length,D,S,O,X;for(Qe(v),D=0;D<V;++D)S=B[D],O=se(S,this),_.touch0&&_.touch0[2]===S.identifier?_.touch0[0]=O:_.touch1&&_.touch1[2]===S.identifier&&(_.touch1[0]=O);if(S=_.that.__zoom,_.touch1){var G=_.touch0[0],K=_.touch0[1],ee=_.touch1[0],p=_.touch1[1],M=(M=ee[0]-G[0])*M+(M=ee[1]-G[1])*M,T=(T=p[0]-K[0])*T+(T=p[1]-K[1])*T;S=b(S,Math.sqrt(M/T)),O=[(G[0]+ee[0])/2,(G[1]+ee[1])/2],X=[(K[0]+p[0])/2,(K[1]+p[1])/2]}else if(_.touch0)O=_.touch0[0],X=_.touch0[1];else return;_.zoom("touch",n($(S,O,X),_.extent,i))}}function q(v,...z){if(this.__zooming){var _=m(this,z).event(v),B=v.changedTouches,V=B.length,D,S;for(gn(v),h&&clearTimeout(h),h=setTimeout(function(){h=null},g),D=0;D<V;++D)S=B[D],_.touch0&&_.touch0[2]===S.identifier?delete _.touch0:_.touch1&&_.touch1[2]===S.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&(S=se(S,this),Math.hypot(f[0]-S[0],f[1]-S[1])<N)){var O=ae(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return y.wheelDelta=function(v){return arguments.length?(o=typeof v=="function"?v:Mt(+v),y):o},y.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Mt(!!v),y):e},y.touchable=function(v){return arguments.length?(a=typeof v=="function"?v:Mt(!!v),y):a},y.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Mt([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),y):t},y.scaleExtent=function(v){return arguments.length?(l[0]=+v[0],l[1]=+v[1],y):[l[0],l[1]]},y.translateExtent=function(v){return arguments.length?(i[0][0]=+v[0][0],i[1][0]=+v[1][0],i[0][1]=+v[0][1],i[1][1]=+v[1][1],y):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},y.constrain=function(v){return arguments.length?(n=v,y):n},y.duration=function(v){return arguments.length?(s=+v,y):s},y.interpolate=function(v){return arguments.length?(u=v,y):u},y.on=function(){var v=c.on.apply(c,arguments);return v===c?y:v},y.clickDistance=function(v){return arguments.length?(E=(v=+v)*v,y):Math.sqrt(E)},y.tapDistance=function(v){return arguments.length?(N=+v,y):N},y}const mn=.1,yn=(e,t=0)=>e.transition().duration(t),Ie=async(e,t)=>("screen"in Ae()&&(await Ce(e).toMatch(({height:o,width:a})=>!isNaN(a)&&a>0&&!isNaN(o)&&o>0),t.length>0&&await Ce(t).toMatch(o=>!!o.filter(({dimensions:{width:a,height:l}})=>!isNaN(a)&&a>0&&!isNaN(l)&&l>0).length)),!0),Au=e=>{const t=te({id:e}),n=r.toRef(t,"onPaneReady"),o=r.toRef(t,"nodes"),a=r.toRef(t,"d3Zoom"),l=r.toRef(t,"d3Selection"),i=r.toRef(t,"dimensions"),s=r.toRef(t,"translateExtent"),u=r.toRef(t,"minZoom"),c=r.toRef(t,"maxZoom"),d=r.toRef(t,"viewport"),f=r.toRef(t,"snapToGrid"),h=r.toRef(t,"snapGrid"),g=r.toRef(t,"getNodes");let x=r.ref(!1);n.value(()=>x.value=!0);const E=async(w,P)=>{x.value||await Ie(i.value,g.value),l.value&&a.value&&a.value.scaleTo(yn(l.value,P==null?void 0:P.duration),w)},N=async(w,P)=>{x.value||await Ie(i.value,g.value),l.value&&a.value&&a.value.scaleBy(yn(l.value,P),w)},y=async w=>{await N(1.2,w==null?void 0:w.duration)},b=async w=>{await N(1/1.2,w==null?void 0:w.duration)},$=(w,P,m,k)=>{const{x:C,y:R}=Vt({x:-w,y:-P},s.value),A=Bt.translate(-C,-R).scale(m);l.value&&a.value&&a.value.transform(yn(l.value,k),A)};return{zoomIn:y,zoomOut:b,zoomTo:E,setTransform:async(w,P)=>{x.value||await Ie(i.value,g.value),$(w.x,w.y,w.zoom,P==null?void 0:P.duration)},getTransform:()=>({x:d.value.x,y:d.value.y,zoom:d.value.zoom}),fitView:async(w={padding:mn,includeHiddenNodes:!1,duration:0})=>{var P,m,k;if(x.value||await Ie(i.value,g.value),!g.value.length)return;let C=[];w.nodes&&(C=o.value.filter(q=>{var v;return(v=w.nodes)==null?void 0:v.includes(q.id)})),(!C||!C.length)&&(C=w.includeHiddenNodes?C:g.value);const R=Fn(C),{x:A,y:F,zoom:Z}=Zn(R,i.value.width,i.value.height,(P=w.minZoom)!=null?P:u.value,(m=w.maxZoom)!=null?m:c.value,(k=w.padding)!=null?k:mn,w.offset);$(A,F,Z,w==null?void 0:w.duration)},setCenter:async(w,P,m)=>{x.value||await Ie(i.value,g.value);const k=typeof(m==null?void 0:m.zoom)<"u"?m.zoom:c.value,C=i.value.width/2-w*k,R=i.value.height/2-P*k;$(C,R,k,m==null?void 0:m.duration)},fitBounds:async(w,P={padding:mn})=>{x.value||await Ie(i.value,g.value);const{x:m,y:k,zoom:C}=Zn(w,i.value.width,i.value.height,u.value,c.value,P.padding);$(m,k,C,P==null?void 0:P.duration)},project:w=>Dt(w,d.value,f.value,h.value)}};function hr(e,t){var n,o;if(t){const a=e.position.x+e.dimensions.width-t.dimensions.width,l=e.position.y+e.dimensions.height-t.dimensions.height;if(a>0||l>0||e.position.x<0||e.position.y<0){if(t.style={...t.style},t.style.width=(n=t.style.width)!=null?n:t.dimensions.width,t.style.height=(o=t.style.height)!=null?o:t.dimensions.height,a>0)if(typeof t.style.width=="string"){const i=parseInt(t.style.width,10);t.style.width=`${i+a}px`}else t.style.width+=a;if(l>0)if(typeof t.style.height=="string"){const i=parseInt(t.style.height,10);t.style.height=`${i+l}px`}else t.style.height+=l;if(e.position.x<0){const i=Math.abs(e.position.x);if(t.position.x=t.position.x-i,typeof t.style.width=="string"){const s=parseInt(t.style.width,10);t.style.width=`${s+i}px`}else t.style.width+=i;e.position.x=0}if(e.position.y<0){const i=Math.abs(e.position.y);if(t.position.y=t.position.y-i,typeof t.style.height=="string"){const s=parseInt(t.style.height,10);t.style.height=`${s+i}px`}else t.style.height+=i;e.position.y=0}}}}const pr=(e,t)=>{let n=t.map(o=>o.id);return e.forEach(o=>{if(o.type==="add"){const i=o.item;return t.push(i)}const a=n.indexOf(o.id),l=t[a];switch(o.type){case"select":l.selected=o.selected;break;case"position":if(ye(l)&&(typeof o.position<"u"&&(l.position=o.position),l.expandParent&&l.parentNode)){const i=t[n.indexOf(l.parentNode)];i&&ye(i)&&hr(l,i)}break;case"dimensions":if(ye(l)&&(typeof o.dimensions<"u"&&(l.dimensions=o.dimensions),l.expandParent&&l.parentNode)){const i=t[n.indexOf(l.parentNode)];i&&ye(i)&&hr(l,i)}break;case"remove":n.includes(o.id)&&(t.splice(a,1),n=t.map(i=>i.id));break}}),t},ge=(e,t)=>({id:e,type:"select",selected:t}),gr=e=>({item:e,type:"add"}),vn=e=>({id:e,type:"remove"}),wn=(e,t)=>e.reduce((n,o)=>{const a=t.includes(o.id),l=ye(o)?"changedNodes":"changedEdges";return!o.selected&&a?n[l].push(ge(o.id,!0)):o.selected&&!a&&n[l].push(ge(o.id,!1)),n},{changedNodes:[],changedEdges:[]});function Du(e,t){const n=p=>{e.hooks.updateNodeInternals.trigger(p)},o=r.ref();e.hooks.paneReady.on(({id:p})=>{o.value=Au(p)});const a=async()=>new Promise(p=>{o.value?p(o.value):Ce(o).not.toBeUndefined().then(()=>p(o.value))}),l=r.computed(()=>e.nodes.map(p=>p.id)),i=r.computed(()=>e.edges.map(p=>p.id)),s=p=>e.nodes&&!l.value.length?e.nodes.find(M=>M.id===p):e.nodes[l.value.indexOf(p)],u=p=>e.edges&&!i.value.length?e.edges.find(M=>M.id===p):e.edges[i.value.indexOf(p)],c=(p,M,T)=>{const I=[];p.forEach(Y=>{var j,U,W,Q;const Ee={id:Y.id,type:"position",dragging:T,from:Y.from};if(M&&(Ee.position=Y.position,Y.parentNode)){const Ne=s(Y.parentNode);Ee.position={x:Ee.position.x-((U=(j=Ne==null?void 0:Ne.computedPosition)==null?void 0:j.x)!=null?U:0),y:Ee.position.y-((Q=(W=Ne==null?void 0:Ne.computedPosition)==null?void 0:W.y)!=null?Q:0)}}I.push(Ee)}),I!=null&&I.length&&e.hooks.nodesChange.trigger(I)},d=p=>{var M;if(!e.vueFlowRef)return;const T=e.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!T)return;let I;if((M=e.__experimentalFeatures)!=null&&M.nestedFlow){let j=[T],U=T,W;for(;!W&&U;)U=U.parentElement,W=U==null?void 0:U.classList.contains("vue-flow__transformationpane"),W&&(j=[U,...j]);j.forEach(Q=>{const Ee=window.getComputedStyle(Q),{m22:Ne}=new window.DOMMatrixReadOnly(Ee.transform);I?I*=Ne:I=Ne})}else{const j=window.getComputedStyle(T),{m22:U}=new window.DOMMatrixReadOnly(j.transform);I=U}const Y=p.reduce((j,U)=>{const W=t.getNode.value(U.id);if(W){const Q=De(U.nodeElement);(Q.width&&Q.height&&(W.dimensions.width!==Q.width||W.dimensions.height!==Q.height)||U.forceUpdate)&&(W.handleBounds.source=eo(".source",U.nodeElement,I),W.handleBounds.target=eo(".target",U.nodeElement,I),W.dimensions=Q,j.push({id:W.id,type:"dimensions",dimensions:Q}))}return j},[]);Y.length&&e.hooks.nodesChange.trigger(Y)},f=(p,M)=>{const T=p.map(j=>j.id);let I,Y=[];if(e.multiSelectionActive)I=T.map(j=>ge(j,M));else{const j=wn([...e.nodes,...e.edges],T);I=j.changedNodes,Y=j.changedEdges}I.length&&e.hooks.nodesChange.trigger(I),Y.length&&e.hooks.edgesChange.trigger(Y)},h=(p,M)=>{const T=p.map(j=>j.id);let I=[],Y;if(e.multiSelectionActive)Y=T.map(j=>ge(j,M));else{const j=wn([...e.nodes,...e.edges],T);I=j.changedNodes,Y=j.changedEdges}I.length&&e.hooks.nodesChange.trigger(I),Y.length&&e.hooks.edgesChange.trigger(Y)},g=(p,M)=>{const T=p.filter(ye),I=p.filter(At),Y=T.map(Q=>Q.id),j=I.map(Q=>Q.id);let{changedNodes:U,changedEdges:W}=wn([...e.nodes,...e.edges],[...Y,...j]);e.multiSelectionActive&&(U=Y.map(Q=>ge(Q,M))),e.multiSelectionActive&&(W=j.map(Q=>ge(Q,M))),U.length&&e.hooks.nodesChange.trigger(U),W.length&&e.hooks.edgesChange.trigger(W)},x=p=>{f(p,!0)},E=p=>{h(p,!0)},N=p=>{g(p,!0)},y=p=>{if(!p.length)return f(p,!1);const M=p.map(T=>T.id).map(T=>ge(T,!1));M.length&&e.hooks.nodesChange.trigger(M)},b=p=>{if(!p.length)return h(p,!1);const M=p.map(T=>T.id).map(T=>ge(T,!1));M.length&&e.hooks.edgesChange.trigger(M)},$=p=>{if(!p||!p.length)return g([],!1);const{changedNodes:M,changedEdges:T}=p.reduce((I,Y)=>{const j=ge(Y.id,!1);return ye(Y)?I.changedNodes.push(j):I.changedEdges.push(j),I},{changedNodes:[],changedEdges:[]});M.length&&e.hooks.nodesChange.trigger(M),T.length&&e.hooks.edgesChange.trigger(T)},w=p=>{var M;(M=e.d3Zoom)==null||M.scaleExtent([p,e.maxZoom]),e.minZoom=p},P=p=>{var M;(M=e.d3Zoom)==null||M.scaleExtent([e.minZoom,p]),e.maxZoom=p},m=p=>{var M;(M=e.d3Zoom)==null||M.translateExtent(p),e.translateExtent=p},k=async p=>{if(e.nodeExtent=p,o.value){const M=t.getNodes.value.map(T=>T.id);n(M)}},C=p=>{e.nodesDraggable=p,e.nodesConnectable=p,e.elementsSelectable=p},R=(p,M)=>{if(!e.initialized&&!p.length)return;e.nodes||(e.nodes=[]);const T=p instanceof Function?p(e.nodes):p;e.nodes=Kn(T,t.getNode.value,e.nodes,M??e.nodeExtent)},A=p=>{if(!e.initialized&&!p.length)return;const M=p instanceof Function?p(e.edges):p;e.edges=M.reduce((T,I)=>{const Y=t.getNode.value(I.source),j=t.getNode.value(I.target),U=!Y||typeof Y>"u",W=!j||typeof j>"u";if(U&&re(`Couldn't create edge for source id: ${I.source}; edge id: ${I.id}`),W&&re(`Couldn't create edge for target id: ${I.target}; edge id: ${I.id}`),U||W)return T;const Q=t.getEdge.value(I.id);return T.push({...Ln(I,Object.assign({},Q,e.defaultEdgeOptions)),sourceNode:Y,targetNode:j}),T},[])},F=(p,M)=>{if(!e.initialized&&!p.length||!p)return;const T=p instanceof Function?p([...e.nodes,...e.edges]):p;R(T.filter(Xn),M),A(T.filter(Xe))},Z=(p,M)=>{const T=p instanceof Function?p(e.nodes):p,I=Kn(T,t.getNode.value,e.nodes,M??e.nodeExtent).map(gr);I.length&&e.hooks.nodesChange.trigger(I)},q=p=>{const M=(p instanceof Function?p(e.edges):p).reduce((T,I)=>{const Y=ra({...I,...e.defaultEdgeOptions},e.edges);if(Y){const j=t.getNode.value(Y.source),U=t.getNode.value(Y.target),W=!j||typeof j>"u",Q=!U||typeof U>"u";if(W&&re(`Couldn't create edge for source id: ${Y.source}; edge id: ${Y.id}`),Q&&re(`Couldn't create edge for target id: ${Y.target}; edge id: ${Y.id}`),Q||W)return T;T.push(gr({...Y,sourceNode:j,targetNode:U}))}return T},[]);M.length&&e.hooks.edgesChange.trigger(M)},v=(p,M=!0)=>{const T=p instanceof Function?p(e.nodes):p,I=[],Y=[];T.forEach(j=>{if(I.push(vn(typeof j=="string"?j:j.id)),M){const U=ot([typeof j=="string"?{id:j}:j],e.edges);Y.push(...U.map(W=>vn(W.id)))}}),I.length&&e.hooks.nodesChange.trigger(I),Y.length&&e.hooks.edgesChange.trigger(Y)},z=p=>{const M=p instanceof Function?p(e.edges):p,T=[];M.forEach(I=>{T.push(vn(typeof I=="string"?I:I.id))}),e.hooks.edgesChange.trigger(T)},_=(p,M)=>aa(p,M,e.edges),B=p=>pr(p,e.nodes),V=p=>pr(p,e.edges),D=(p,M,T,I=!1)=>{I?e.connectionClickStartHandle=p:e.connectionStartHandle=p,M&&(e.connectionPosition=M),e.hooks.connectStart.trigger({event:T,nodeId:p.nodeId,handleId:p.handleId,handleType:p.type})},S=p=>{e.connectionPosition=p},O=(p,M)=>{e.connectionPosition={x:NaN,y:NaN},M?e.connectionClickStartHandle=null:e.connectionStartHandle=null,e.hooks.connectEnd.trigger(p)},X=p=>{const M=Jr(p),T=M?null:s(p.id);return!M&&!T?[null,null,M]:[M?p:Dn(T),T,M]},G=(p,M=!0,T)=>{const[I,Y,j]=X(p);return I?(T||e.nodes).filter(U=>{if(!j&&(U.id===Y.id||!U.computedPosition))return!1;const W=Dn(U),Q=Tt(W,I);return M&&Q>0||Q>=Number(p.width)*Number(p.height)}):[]},K=(p,M,T=!0)=>{const[I]=X(p);if(!I)return!1;const Y=Tt(I,M);return T&&Y>0||Y>=Number(p.width)*Number(p.height)},ee=p=>{var M,T;const I=p instanceof Function?p(e):p,Y=["modelValue","nodes","edges","maxZoom","minZoom","translateExtent","nodeExtent","hooks"];typeof I.modelValue<"u"&&F(I.modelValue,(M=I.nodeExtent)!=null?M:e.nodeExtent),typeof I.nodes<"u"&&R(I.nodes,(T=I.nodeExtent)!=null?T:e.nodeExtent),typeof I.edges<"u"&&A(I.edges);const j=()=>{typeof I.maxZoom<"u"&&P(I.maxZoom),typeof I.minZoom<"u"&&w(I.minZoom),typeof I.translateExtent<"u"&&m(I.translateExtent),typeof I.nodeExtent<"u"&&k(I.nodeExtent)};Object.keys(I).forEach(U=>{const W=I[U];!Y.includes(U)&&J(W)&&(e[U]=W)}),e.d3Zoom?j():Ce(()=>e.d3Zoom).not.toBeUndefined().then(j),e.initialized||(e.initialized=!0)};return{updateNodePositions:c,updateNodeDimensions:d,setElements:F,setNodes:R,setEdges:A,addNodes:Z,addEdges:q,removeNodes:v,removeEdges:z,findNode:s,findEdge:u,updateEdge:_,applyEdgeChanges:V,applyNodeChanges:B,addSelectedElements:N,addSelectedNodes:x,addSelectedEdges:E,setMinZoom:w,setMaxZoom:P,setTranslateExtent:m,setNodeExtent:k,removeSelectedElements:$,removeSelectedNodes:y,removeSelectedEdges:b,startConnection:D,updateConnection:S,endConnection:O,setInteractive:C,setState:ee,getIntersectingNodes:G,isNodeIntersecting:K,fitView:async(p={padding:.1})=>{const{fitView:M}=await a();M(p)},zoomIn:async p=>{const{zoomIn:M}=await a();M(p)},zoomOut:async p=>{const{zoomOut:M}=await a();M(p)},zoomTo:async(p,M)=>{const{zoomTo:T}=await a();T(p,M)},setTransform:async(p,M)=>{const{setTransform:T}=await a();T(p,M)},getTransform:()=>({x:e.viewport.x,y:e.viewport.y,zoom:e.viewport.zoom}),setCenter:async(p,M,T)=>{const{setCenter:I}=await a();I(p,M,T)},fitBounds:async(p,M)=>{const{fitBounds:T}=await a();T(p,M)},project:p=>Dt(p,e.viewport,e.snapToGrid,e.snapGrid),toObject:()=>JSON.parse(JSON.stringify({nodes:e.nodes,edges:e.edges,position:[e.viewport.x,e.viewport.y],zoom:e.viewport.zoom})),updateNodeInternals:n,$reset:()=>{ee(Vo())},$destroy:()=>{}}}const Je=class{constructor(){Pt(this,"currentId",0),Pt(this,"flows",new Map)}static getInstance(){return Je.instance||(Je.instance=new Je),Je.instance}set(e,t){return this.flows.set(e,t)}get(e){return this.flows.get(e)}remove(e){return this.flows.delete(e)}create(e,t){const n=Vo(t),o=r.reactive(n),a=Zi(o),l=Du(o,a),i={};Object.entries(o.hooks).forEach(([c,d])=>{const f=`on${c.charAt(0).toUpperCase()+c.slice(1)}`;i[f]=d.on});const s={};Object.entries(o.hooks).forEach(([c,d])=>{s[c]=d.trigger}),l.setState(o),t&&(t.modelValue&&l.setElements(t.modelValue),t.nodes&&l.setNodes(t.nodes),t.edges&&l.setEdges(t.edges));const u={...i,...a,...l,...r.toRefs(o),emits:s,id:e,$destroy:()=>{this.remove(e)}};return this.set(e,u),u}getId(){return`vue-flow-${this.currentId++}`}};let mr=Je;Pt(mr,"instance");const te=e=>{const t=mr.getInstance(),n=r.getCurrentScope(),o=e==null?void 0:e.id,a=(n==null?void 0:n.vueFlowId)||o;let l,i=!1;if(n){const s=r.inject(Gn,null);typeof s<"u"&&s!==null&&(l=s)}if(l||a&&(l=t.get(a)),!l||l&&o&&o!==l.id){const s=o??t.getId();l=t.create(s,e),n&&(i=!0)}else e&&l.setState(e);if(!l)throw new Error("[vueflow]: store instance not found.");return n&&(r.provide(Gn,l),n.vueFlowId=l.id,i&&Ve(()=>{t.get(l.id)&&l.$destroy(),l=null})),l},Xu=(e,t,n)=>{const o=r.effectScope();return o.run(()=>{[()=>{o.run(()=>{let a,l;const i=!!(e.modelValue&&e.modelValue.value&&e.modelValue.value.length);a=Me([e.modelValue,()=>{var s,u;return(u=(s=e.modelValue)==null?void 0:s.value)==null?void 0:u.length}],([s])=>{s&&Array.isArray(s)&&(l==null||l.pause(),n.setElements(s),l=Me([n.nodes,n.edges,()=>n.edges.value.length,()=>n.nodes.value.length],([u,c])=>{var d;(d=e.modelValue)!=null&&d.value&&Array.isArray(e.modelValue.value)&&(a==null||a.pause(),e.modelValue.value=[...u,...c],r.nextTick(()=>{a==null||a.resume()}))},{immediate:!0}),r.nextTick(()=>{l==null||l.resume()}))},{immediate:i}),r.onScopeDispose(()=>{a==null||a.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let a,l;const i=!!(e.nodes&&e.nodes.value&&e.nodes.value.length);a=Me([e.nodes,()=>{var s,u;return(u=(s=e.nodes)==null?void 0:s.value)==null?void 0:u.length}],([s])=>{s&&Array.isArray(s)&&(l==null||l.pause(),n.setNodes(s),l=Me([n.nodes,()=>n.nodes.value.length],([u])=>{var c;(c=e.nodes)!=null&&c.value&&Array.isArray(e.nodes.value)&&(a==null||a.pause(),e.nodes.value=[...u],r.nextTick(()=>{a==null||a.resume()}))},{immediate:!0}),r.nextTick(()=>{l==null||l.resume()}))},{immediate:i}),r.onScopeDispose(()=>{a==null||a.stop(),l==null||l.stop()})})},()=>{o.run(()=>{let a,l;const i=!!(e.edges&&e.edges.value&&e.edges.value.length);a=Me([e.edges,()=>{var s,u;return(u=(s=e.edges)==null?void 0:s.value)==null?void 0:u.length}],([s])=>{s&&Array.isArray(s)&&(l==null||l.pause(),n.setEdges(s),l=Me([n.edges,()=>n.edges.value.length],([u])=>{var c;(c=e.edges)!=null&&c.value&&Array.isArray(e.edges.value)&&(a==null||a.pause(),e.edges.value=[...u],r.nextTick(()=>{a==null||a.resume()}))},{immediate:!0}),r.nextTick(()=>{l==null||l.resume()}))},{immediate:i}),r.onScopeDispose(()=>{a==null||a.stop(),l==null||l.stop()})})},()=>{o.run(()=>{r.watch(()=>t.minZoom,()=>{t.minZoom&&J(t.minZoom)&&n.setMinZoom(t.minZoom)},{immediate:J(t.minZoom)})})},()=>{o.run(()=>{r.watch(()=>t.maxZoom,()=>{t.maxZoom&&J(t.maxZoom)&&n.setMaxZoom(t.maxZoom)},{immediate:J(t.maxZoom)})})},()=>{o.run(()=>{r.watch(()=>t.translateExtent,()=>{t.translateExtent&&J(t.translateExtent)&&n.setTranslateExtent(t.translateExtent)},{immediate:J(t.translateExtent)})})},()=>{o.run(()=>{r.watch(()=>t.nodeExtent,()=>{t.nodeExtent&&J(t.nodeExtent)&&n.setNodeExtent(t.nodeExtent)},{immediate:J(t.nodeExtent)})})},()=>{o.run(()=>{r.watch(()=>t.applyDefault,()=>{J(t.applyDefault)&&(n.applyDefault.value=t.applyDefault)},{immediate:J(t.applyDefault)}),r.watch(n.applyDefault,(a,l,i)=>{n.applyDefault.value?(n.onNodesChange(n.applyNodeChanges),n.onEdgesChange(n.applyEdgeChanges)):(n.hooks.value.nodesChange.off(n.applyNodeChanges),n.hooks.value.edgesChange.off(n.applyEdgeChanges)),i(()=>{n.hooks.value.nodesChange.off(n.applyNodeChanges),n.hooks.value.edgesChange.off(n.applyEdgeChanges)})},{immediate:!0})})},()=>{o.run(()=>{const a=async l=>{let i=l;me(t.autoConnect)&&(i=await t.autoConnect(l)),i!==!1&&n.addEdges([i])};r.watch(()=>t.autoConnect,()=>{J(t.autoConnect)&&(n.autoConnect.value=t.autoConnect)},{immediate:J(t.autoConnect)}),r.watch(n.autoConnect,(l,i,s)=>{l?n.onConnect(a):n.hooks.value.connect.off(a),s(()=>{n.hooks.value.connect.off(a)})},{immediate:!0})})},()=>{const a=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];Object.keys(t).forEach(l=>{if(!a.includes(l)){const i=r.toRef(t,l),s=n[l];o.run(()=>{r.watch(i,()=>{J(i)&&(s.value=i.value)},{immediate:J(i)})})}})}].forEach(a=>a())}),()=>o.stop()};function yr(e){const t=e.composedPath()[0],n=me(t.hasAttribute)?t.hasAttribute("contenteditable"):!1,o=me(t.closest)?t.closest(".nokey"):null;return["INPUT","SELECT","TEXTAREA"].includes(t==null?void 0:t.nodeName)||n||!!o}const et=(e,t)=>{const n=Ae();let o=r.ref(r.unref(e)===!0);return r.watch(o,()=>{t&&typeof t=="function"&&t(o.value)}),r.watchEffect(()=>{const a=r.unref(e);if(_r(a)){o.value=a;return}a&&($n(a,l=>{yr(l)||(l.preventDefault(),o.value=!0)},{eventName:"keydown"}),$n(a,l=>{yr(l)||(l.preventDefault(),o.value=!1)},{eventName:"keyup"}))}),typeof n.addEventListener<"u"&&zt(n,"blur",()=>{o.value=!1}),o},Lu={name:"SelectionPane",inheritAttrs:!1},Hu=r.defineComponent({...Lu,setup(e){const{id:t,deleteKeyCode:n,selectionKeyCode:o,multiSelectionKeyCode:a,emits:l,nodesSelectionActive:i,userSelectionActive:s,multiSelectionActive:u,elementsSelectable:c,getNodes:d,getSelectedEdges:f,removeSelectedElements:h,removeNodes:g,removeEdges:x}=te(),E=m=>{l.paneClick(m),i.value=!1,h()},N=m=>l.paneContextMenu(m),y=m=>l.paneScroll(m),b=m=>l.paneMouseEnter(m),$=m=>l.paneMouseLeave(m),w=m=>l.paneMouseMove(m);et(n,m=>{if(!m)return;const k=d.value.reduce((C,R)=>((!R.selected&&R.parentNode&&C.find(A=>A.id===R.parentNode)||R.selected)&&C.push(R),C),[]);(k||f.value)&&(f.value.length>0&&x(f.value),k.length>0&&g(k),i.value=!1,h())}),et(a,m=>{u.value=m});const P=et(o,m=>{s.value&&m||(s.value=m&&c.value)});return(m,k)=>(r.openBlock(),r.createElementBlock(r.Fragment,null,[r.unref(P)&&r.unref(s)?(r.openBlock(),r.createBlock(r.unref(ji),{key:0})):r.createCommentVNode("",!0),r.unref(i)?(r.openBlock(),r.createBlock(r.unref(Di),{key:1})):r.createCommentVNode("",!0),(r.openBlock(),r.createElementBlock("div",r.mergeProps({key:`pane-${r.unref(t)}`},m.$attrs,{class:"vue-flow__pane vue-flow__container",onClick:E,onContextmenu:N,onWheel:y,onMouseenter:b,onMousemove:w,onMouseleave:$}),null,16))],64))}}),ju={class:"vue-flow__nodes vue-flow__container"},Yu={name:"Nodes"},Fu=r.defineComponent({...Yu,setup(e){const t=r.inject(at),n=te(),o=r.toRef(n,"nodesDraggable"),a=r.toRef(n,"elementsSelectable"),l=r.toRef(n,"nodesConnectable"),i=r.toRef(n,"getNodes"),s=r.toRef(n,"getNodeTypes"),u=r.toRef(n,"updateNodeDimensions"),c=r.toRef(n,"emits"),d=E=>typeof E>"u"?o.value:E,f=E=>typeof E>"u"?a.value:E,h=E=>typeof E>"u"?l.value:E,g=r.ref();r.onMounted(()=>{const E=[];let N=!1;const y=b=>{E.push(b),E.length===i.value.length&&r.nextTick(()=>{N=!0,c.value.nodesInitialized()})};g.value=new ResizeObserver(b=>{const $=b.map(w=>{const P=w.target.getAttribute("data-id");return N||y(P),{id:P,nodeElement:w.target,forceUpdate:!0}});u.value($)})}),r.onBeforeUnmount(()=>{var E;return(E=g.value)==null?void 0:E.disconnect()});const x=(E,N)=>{const y=E||"default";let b=N??s.value[y];const $=r.getCurrentInstance();if(typeof b=="string"&&$){const P=Object.keys($.appContext.components);P&&P.includes(y)&&(b=r.resolveComponent(y,!1))}if(typeof b!="string")return b;const w=t==null?void 0:t[`node-${y}`];return w!=null&&w({})?w:(re(`Node type "${E}" not found and no node-slot detected. Using fallback type "default".`),!1)};return(E,N)=>(r.openBlock(),r.createElementBlock("div",ju,[g.value?(r.openBlock(!0),r.createElementBlock(r.Fragment,{key:0},r.renderList(i.value,y=>(r.openBlock(),r.createBlock(r.unref(si),{id:y.id,key:y.id,"resize-observer":g.value,type:x(y.type,y.template),name:y.type||"default",draggable:d(y.draggable),selectable:f(y.selectable),connectable:h(y.connectable),node:y},null,8,["id","resize-observer","type","name","draggable","selectable","connectable","node"]))),128)):r.createCommentVNode("",!0)]))}}),Uu=["id","markerWidth","markerHeight","markerUnits","orient"],Zu=["stroke","stroke-width","fill"],Wu=["stroke","stroke-width"],Ku={name:"MarkerType"},Gu=r.defineComponent({...Ku,props:{id:null,type:null,color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(e){return(t,n)=>(r.openBlock(),r.createElementBlock("marker",{id:e.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${e.width}`,markerHeight:`${e.height}`,markerUnits:e.markerUnits,orient:e.orient},[e.type==="arrowclosed"?(r.openBlock(),r.createElementBlock("polyline",{key:0,stroke:e.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":e.strokeWidth,fill:e.color,points:"-5,-4 0,0 -5,4 -5,-4"},null,8,Zu)):r.createCommentVNode("",!0),e.type==="arrow"?(r.openBlock(),r.createElementBlock("polyline",{key:1,stroke:e.color,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":e.strokeWidth,fill:"none",points:"-5,-4 0,0 -5,4"},null,8,Wu)):r.createCommentVNode("",!0)],8,Uu))}}),qu={name:"MarkerDefinitions"},Qu=r.defineComponent({...qu,setup(e){const t=te(),n=r.toRef(t,"edges"),o=r.toRef(t,"connectionLineOptions"),a=r.toRef(t,"defaultMarkerColor"),l=r.computed(()=>{const i=[],s=[],u=c=>{if(c){const d=we(c);i.includes(d)||(typeof c=="object"?s.push({...c,id:d,color:c.color||a.value}):s.push({id:d,color:a.value,type:c}),i.push(d))}};return[o.value.markerEnd,o.value.markerStart].forEach(u),n.value.reduce((c,d)=>([d.markerStart,d.markerEnd].forEach(u),c.sort((f,h)=>f.id.localeCompare(h.id))),s),s});return(i,s)=>(r.openBlock(),r.createElementBlock("defs",null,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(r.unref(l),u=>(r.openBlock(),r.createBlock(Gu,{id:u.id,key:u.id,type:u.type,color:u.color,width:u.width,height:u.height,markerUnits:u.markerUnits,"stroke-width":u.strokeWidth,orient:u.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))]))}}),Ju={key:0,class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},ec={name:"Edges"},tc=r.defineComponent({...ec,setup(e){const t=r.inject(at),n=te();r.toRef(n,"emits"),r.toRef(n,"connectionMode"),r.toRef(n,"edgeUpdaterRadius");const o=r.toRef(n,"onPaneReady"),a=r.toRef(n,"connectionStartHandle"),l=r.toRef(n,"nodesConnectable"),i=r.toRef(n,"edgesUpdatable"),s=r.toRef(n,"elementsSelectable"),u=r.toRef(n,"getSelectedNodes");r.toRef(n,"nodesSelectionActive");const c=r.toRef(n,"getNode");r.toRef(n,"getNodes");const d=r.toRef(n,"getEdges"),f=r.toRef(n,"getEdgeTypes");r.toRef(n,"addSelectedEdges");const h=r.toRef(n,"noPanClassName"),g=r.toRef(n,"elevateEdgesOnSelect"),x=m=>typeof m>"u"?s.value:m,E=m=>typeof m>"u"?i.value:m,N=Nn(()=>{var m;return(m=a.value)==null?void 0:m.nodeId},()=>{var m;return(m=a.value)!=null&&m.nodeId?c.value(a.value.nodeId):!1}),y=Nn(()=>{var m;return(m=a.value)==null?void 0:m.nodeId},()=>{var m,k;return!!(N.value&&(typeof N.value.connectable>"u"?l.value:N.value.connectable)&&((m=a.value)!=null&&m.nodeId)&&((k=a.value)!=null&&k.type))});let b=r.ref([]),$=r.effectScope();o.value(()=>{$||($=r.effectScope()),$.run(()=>{r.watch([u,d],()=>{g.value?r.nextTick(()=>b.value=Mi(d.value,c.value)):b.value=[{isMaxLevel:!0,edges:d.value,level:0}]},{immediate:!0})})}),r.onBeforeUnmount(()=>{$==null||$.stop(),$=null});const w=(m,k)=>{const C=m||"default";let R=k??f.value[C];const A=r.getCurrentInstance();if(typeof R=="string"&&A){const Z=Object.keys(A.appContext.components);Z&&Z.includes(C)&&(R=r.resolveComponent(C,!1))}if(R&&typeof R!="string")return R;const F=t==null?void 0:t[`edge-${C}`];return F!=null&&F({})?F:(re(`Edge type "${m}" not found and no edge-slot detected. Using fallback type "default".`),!1)},P=m=>{const k=m.class instanceof Function?m.class(m):m.class;return[h.value,k]};return(m,k)=>(r.openBlock(),r.createElementBlock(r.Fragment,null,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(b.value,C=>(r.openBlock(),r.createElementBlock("svg",{key:C.level,class:"vue-flow__edges vue-flow__container",style:r.normalizeStyle(`z-index: ${C.level}`)},[C.isMaxLevel?(r.openBlock(),r.createBlock(Qu,{key:0})):r.createCommentVNode("",!0),r.createElementVNode("g",null,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(C.edges,R=>(r.openBlock(),r.createBlock(r.unref(Pi),{id:R.id,key:R.id,edge:R,type:w(R.type,R.template),name:R.type||"default","source-node":c.value(R.source),"target-node":c.value(R.target),selectable:x(R.selectable),updatable:E(R.updatable),class:r.normalizeClass(P(R))},null,8,["id","edge","type","name","source-node","target-node","selectable","updatable","class"]))),128))])],4))),128)),y.value&&N.value?(r.openBlock(),r.createElementBlock("svg",Ju,[r.createVNode(Oi,{"source-node":N.value},null,8,["source-node"])])):r.createCommentVNode("",!0)],64))}}),nc=r.createElementVNode("div",{class:"vue-flow__edge-labels"},null,-1),oc={name:"Transform"},rc=r.defineComponent({...oc,setup(e){const{id:t,viewport:n,dimensions:o,fitViewOnInit:a,emits:l,fitView:i,...s}=te(),u=async d=>("screen"in Ae()&&await Ce(d).toMatch(({height:h,width:g})=>!isNaN(g)&&g>0&&!isNaN(h)&&h>0),!0);let c=r.ref(!1);return r.onMounted(async()=>{await u(o.value),c.value=!0,l.paneReady({id:t,viewport:n,dimensions:o,fitViewOnInit:a,fitView:i,emits:l,...s}),a!=null&&a.value&&i()}),(d,f)=>(r.openBlock(),r.createElementBlock("div",{key:`transform-${r.unref(t)}`,class:"vue-flow__transformationpane vue-flow__container",style:r.normalizeStyle({transform:`translate(${r.unref(n).x}px,${r.unref(n).y}px) scale(${r.unref(n).zoom})`,opacity:c.value?void 0:0})},[r.createVNode(tc),nc,r.createVNode(Fu),r.renderSlot(d.$slots,"default")],4))}}),ac={name:"Viewport"},lc=r.defineComponent({...ac,setup(e){const t=te(),n=r.toRef(t,"id"),o=r.toRef(t,"minZoom"),a=r.toRef(t,"maxZoom"),l=r.toRef(t,"defaultZoom"),i=r.toRef(t,"defaultPosition"),s=r.toRef(t,"translateExtent"),u=r.toRef(t,"dimensions"),c=r.toRef(t,"zoomActivationKeyCode"),d=r.toRef(t,"selectionKeyCode"),f=r.toRef(t,"panOnScroll"),h=r.toRef(t,"panOnScrollMode"),g=r.toRef(t,"panOnScrollSpeed"),x=r.toRef(t,"panOnDrag"),E=r.toRef(t,"zoomOnDoubleClick"),N=r.toRef(t,"zoomOnPinch"),y=r.toRef(t,"zoomOnScroll"),b=r.toRef(t,"preventScrolling"),$=r.toRef(t,"noWheelClassName"),w=r.toRef(t,"noPanClassName"),P=r.toRef(t,"setState"),m=r.toRef(t,"emits"),k=r.toRef(t,"connectionStartHandle"),C=Dr("viewport",null);let R=r.ref(!1),A=r.ref(!1);const F=r.computed(()=>!!k.value),Z=(_,B)=>_.x!==B.x&&!isNaN(B.x)||_.y!==B.y&&!isNaN(B.y)||_.zoom!==B.k&&!isNaN(B.k),q=_=>({x:_.x,y:_.y,zoom:_.k}),v=(_,B)=>_.target.closest(`.${B}`);let z=r.ref({x:0,y:0,zoom:0});return r.onMounted(()=>{Fr(C,()=>{if(!C.value)return;const{width:B,height:V}=De(C.value);u.value.width=B,u.value.height=V});const _=Ae();zt(_,"resize",()=>{if(!C.value)return;const{width:B,height:V}=De(C.value);u.value.width=B,u.value.height=V})}),r.onMounted(()=>{const _=C.value.getBoundingClientRect(),B=Ou().scaleExtent([o.value,a.value]).translateExtent(s.value),V=ae(C.value).call(B),D=V.on("wheel.zoom"),S=Bt.translate(i.value[0],i.value[1]).scale(l.value),O=[[0,0],[_.width,_.height]],X=B.constrain()(S,O,s.value);B.transform(V,X),P.value({d3Zoom:B,d3Selection:V,d3ZoomHandler:D,viewport:{x:S.x,y:S.y,zoom:S.k},viewportRef:C.value});const G=p=>{p&&!R.value?B.on("zoom",null):p||B.on("zoom",M=>{P.value({viewport:{x:M.transform.x,y:M.transform.y,zoom:M.transform.k}});const T=q(M.transform);m.value.move({event:M,flowTransform:T})})},K=et(d.value,G);G(!1);const ee=et(c.value);B.on("start",p=>{var M;if(!p.sourceEvent)return null;R.value=!0;const T=q(p.transform);((M=p.sourceEvent)==null?void 0:M.type)==="mousedown"&&(A.value=!0),z.value=T,m.value.moveStart({event:p,flowTransform:T})}),B.on("end",p=>{if(!p.sourceEvent)return null;if(R.value=!1,A.value=!1,Z(z.value,p.transform)){const M=q(p.transform);z.value=M,m.value.moveEnd({event:p,flowTransform:M})}}),r.watchEffect(()=>{f.value&&!ee.value?V.on("wheel",p=>{var M;if(v(p,(M=$.value)==null?void 0:M.value))return!1;p.preventDefault(),p.stopImmediatePropagation();const T=V.property("__zoom").k||1;if(p.ctrlKey&&N.value){const U=se(p),W=-p.deltaY*(p.deltaMode===1?.05:p.deltaMode?1:.002)*10,Q=T*2**W;B.scaleTo(V,Q,U);return}const I=p.deltaMode===1?20:1,Y=h.value===rt.Vertical?0:p.deltaX*I,j=h.value===rt.Horizontal?0:p.deltaY*I;B.translateBy(V,-(Y/T)*g.value,-(j/T)*g.value)}).on("wheel.zoom",null):typeof D<"u"&&V.on("wheel",p=>{var M;if(!b.value||v(p,(M=$.value)==null?void 0:M.value))return null;p.preventDefault()}).on("wheel.zoom",D)}),B.filter(p=>{var M,T;const I=ee.value||y.value,Y=N.value&&p.ctrlKey;return p.button===1&&p.type==="mousedown"&&((M=p.target)!=null&&M.closest(".vue-flow__node")||(T=p.target)!=null&&T.closest(".vue-flow__edge"))?!0:!x.value&&!I&&!f.value&&!E.value&&!N.value||K.value&&d.value!==!0||!E.value&&p.type==="dblclick"||v(p,$.value)&&p.type==="wheel"||v(p,w.value)&&p.type!=="wheel"||!N.value&&p.ctrlKey&&p.type==="wheel"||!I&&!f.value&&!Y&&p.type==="wheel"||!x.value&&(p.type==="mousedown"||p.type==="touchstart")?!1:(!p.ctrlKey||p.type==="wheel")&&(!p.button||p.button<=1)})}),(_,B)=>(r.openBlock(),r.createElementBlock("div",{ref:"viewport",key:`viewport-${n.value}`,class:"vue-flow__viewport vue-flow__container"},[r.createVNode(rc,null,{default:r.withCtx(()=>[r.renderSlot(_.$slots,"default")]),_:3}),r.createVNode(Hu,{class:r.normalizeClass({connecting:F.value,dragging:A.value,draggable:x.value})},null,8,["class"])]))}}),ic={name:"VueFlow"},sc=r.defineComponent({...ic,props:{id:null,modelValue:null,nodes:null,edges:null,edgeTypes:null,nodeTypes:null,connectionMode:null,connectionLineType:null,connectionLineStyle:{default:void 0},connectionLineOptions:null,deleteKeyCode:null,selectionKeyCode:null,multiSelectionKeyCode:null,zoomActivationKeyCode:null,snapToGrid:{type:Boolean,default:void 0},snapGrid:null,onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:Boolean,default:void 0},minZoom:null,maxZoom:null,defaultZoom:null,defaultPosition:null,translateExtent:null,nodeExtent:null,defaultMarkerColor:null,zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:null,panOnScrollMode:null,zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},edgeUpdaterRadius:null,fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:null,noWheelClassName:null,noPanClassName:null,defaultEdgeOptions:null,elevateEdgesOnSelect:{type:Boolean,default:void 0},__experimentalFeatures:null},emits:["nodesChange","edgesChange","nodeDoubleClick","nodeClick","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeContextMenu","nodeDragStart","nodeDrag","nodeDragStop","nodesInitialized","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","connect","connectStart","connectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","paneReady","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdate","edgeUpdateEnd","updateNodeInternals","update:modelValue","update:nodes","update:edges"],setup(e,{expose:t,emit:n}){const o=e,a=Oe(o,"modelValue",n),l=Oe(o,"nodes",n),i=Oe(o,"edges",n),{vueFlowRef:s,id:u,hooks:c,getNodeTypes:d,getEdgeTypes:f,$reset:h,...g}=te({id:o.id}),x=Xu({modelValue:a,nodes:l,edges:i},o,{vueFlowRef:s,id:u,hooks:c,getNodeTypes:d,getEdgeTypes:f,$reset:h,...g}),E=r.ref();return r.onUnmounted(()=>{x()}),r.onMounted(()=>{s.value=E.value}),qr(n,c),r.provide(at,r.useSlots()),t({vueFlowRef:s,id:u,hooks:c,getNodeTypes:d,getEdgeTypes:f,$reset:h,...g}),(N,y)=>(r.openBlock(),r.createElementBlock("div",{ref_key:"el",ref:E,class:"vue-flow"},[r.createVNode(lc,null,{nodes:r.withCtx(()=>[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(Object.keys(r.unref(d)),b=>r.renderSlot(N.$slots,`node-${b}`)),256))]),edges:r.withCtx(()=>[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(Object.keys(r.unref(f)),b=>r.renderSlot(N.$slots,`edge-${b}`)),256))]),"connection-name":r.withCtx(()=>[r.renderSlot(N.$slots,"connection-line")]),default:r.withCtx(()=>[r.renderSlot(N.$slots,"zoom-pane")]),_:3}),r.renderSlot(N.$slots,"default")],512))}}),Sc="",Cc="",uc={key:0,class:"label-input-wrapper"},cc=["onKeypress"],dc=r.defineComponent({__name:"EditableNode",props:{id:null,label:null,sourcePosition:null,targetPosition:null,data:null},emits:["change"],setup(e,{emit:t}){const n=e,o={top:H.Top,right:H.Right,bottom:H.Bottom,left:H.Left},a=r.computed(()=>o[n.sourcePosition]),l=r.computed(()=>o[n.targetPosition]),i=r.ref(),s=r.ref(""),u=r.ref(!1);let c=0;const d=()=>{let g=Date.now();g-c<500&&!u.value&&f(),c=g},f=async()=>{s.value=n.label,u.value=!0,await r.nextTick(),i.value.focus()},h=()=>{u.value=!1,t("change",s.value)};return(g,x)=>(r.openBlock(),r.createElementBlock("div",{onClick:x[2]||(x[2]=E=>d())},[r.createElementVNode("div",null,r.toDisplayString(n.label),1),u.value?(r.openBlock(),r.createElementBlock("div",uc,[r.withDirectives(r.createElementVNode("input",{ref_key:"labelInput",ref:i,class:"label-input","onUpdate:modelValue":x[0]||(x[0]=E=>s.value=E),onBlur:x[1]||(x[1]=E=>u.value=!1),onKeypress:r.withKeys(h,["enter"])},null,40,cc),[[r.vModelText,s.value]])])):r.createCommentVNode("",!0),n.data.hasInput?(r.openBlock(),r.createBlock(r.unref(Pe),{key:1,id:"a",type:"target",position:r.unref(l)},null,8,["position"])):r.createCommentVNode("",!0),n.data.hasOutput?(r.openBlock(),r.createBlock(r.unref(Pe),{key:2,id:"b",type:"source",position:r.unref(a)},null,8,["position"])):r.createCommentVNode("",!0)]))}}),Mc="",fc=["id","d","marker-end"],hc={class:"vue-flow__edge-label"},pc={key:0,class:"label-input-wrapper"},gc=["onKeypress"],mc={inheritAttrs:!1},yc=r.defineComponent({...mc,__name:"EditableEdge",props:{id:null,sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null,data:null,markerEnd:null,style:null,label:null},emits:["change"],setup(e,{emit:t}){const n=e;te();const o=r.ref(),a=r.ref(""),l=r.ref(!1);let i=0;const s=()=>{let f=Date.now();f-i<500&&!l.value&&u(),i=f},u=async()=>{a.value=n.label,l.value=!0,await r.nextTick(),o.value.focus()},c=()=>{l.value=!1,t("change",a.value)},d=r.computed(()=>Gt(n));return(f,h)=>(r.openBlock(),r.createElementBlock(r.Fragment,null,[r.createElementVNode("path",{id:e.id,style:r.normalizeStyle(e.style),class:"vue-flow__edge-path",d:r.unref(d)[0],"marker-end":e.markerEnd},null,12,fc),r.createVNode(r.unref(zi),null,{default:r.withCtx(()=>[r.createElementVNode("div",{style:r.normalizeStyle({pointerEvents:"all",position:"absolute",transform:`translate(-50%, -50%) translate(${r.unref(d)[1]}px,${r.unref(d)[2]}px)`}),class:"nodrag nopan editable-edge-label",onClick:h[2]||(h[2]=g=>s())},[r.createElementVNode("div",hc,r.toDisplayString(n.label),1),l.value?(r.openBlock(),r.createElementBlock("div",pc,[r.withDirectives(r.createElementVNode("input",{ref_key:"labelInput",ref:o,class:"label-input","onUpdate:modelValue":h[0]||(h[0]=g=>a.value=g),onBlur:h[1]||(h[1]=g=>l.value=!1),onKeypress:r.withKeys(c,["enter"])},null,40,gc),[[r.vModelText,a.value]])])):r.createCommentVNode("",!0)],4)]),_:1})],64))}}),Bc="",vc={class:"chart-controls"},wc={class:"chart-controls-left"},bc=r.createElementVNode("b",null,"Selected Node:",-1),xc={class:"chart-controls-right"},_c={key:0},kc={key:1},bn=r.defineComponent({__name:"NodeEditor",props:{modelValue:null,nodeContainerClass:null},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=r.ref(""),a=r.ref({}),l=r.ref(!1);r.ref({x:0,y:0});const i=r.ref(""),s=r.ref([]),u=r.computed(()=>{for(let m=0;m<s.value.length;m++)if(s.value[m].id==i.value)return m;return-1}),c=r.computed({get:()=>{let m=n.modelValue;n.nodeContainerClass?o.value=n.nodeContainerClass:o.value="defaultContainerClass";for(let k=0;k<m.length;k++)m[k].data={},m[k].type=="input"?(m[k].data.hasInput=!1,m[k].data.hasOutput=!0):m[k].type=="output"?(m[k].data.hasInput=!0,m[k].data.hasOutput=!1):(m[k].data.hasInput=!0,m[k].data.hasOutput=!0),m[k].class="vue-flow__node-default",m[k].type="editable";for(let k=0;k<m.length;k++){let C=m[k].id;m[k],m[k].events={click:()=>{i.value=C}}}return m},set:m=>{t("update:modelValue",JSON.parse(JSON.stringify(m)))}}),{getNodes:d,onPaneReady:f}=te({});f(m=>{a.value=m}),s.value=c.value,r.onMounted(()=>{document.removeEventListener("keypress",N),document.addEventListener("keypress",N)}),r.onBeforeUnmount(()=>{document.removeEventListener("keypress",N)});const h=m=>({top:"right",right:"bottom",bottom:"left",left:"top"})[m],g=()=>{u.value>-1&&(s.value[u.value].sourcePosition=h(s.value[u.value].sourcePosition))},x=()=>{u.value>-1&&(s.value[u.value].targetPosition=h(s.value[u.value].targetPosition))},E=m=>{window.scrollBy(0,m.deltaY)},N=m=>{l.value&&m.ctrlKey==!0&&((m.key=="+"||m.key=="=")&&a.value.zoomIn(),m.key=="-"&&a.value.zoomOut())},y=()=>{a.value.fitView()},b=()=>{let m={x:Math.random()*200,y:Math.random()*200},k=!1;if(u.value>-1){const A=s.value[u.value];A.data.hasOutput&&(m={x:A.position.x+200,y:A.position.y+50},k=!0)}let C=s.value.length,R=`node-${C}`;if(s.value.push({id:R,label:"Node "+C,sourcePosition:"right",targetPosition:"left",class:"vue-flow__node-default",type:"editable",data:{hasInput:!0,hasOutput:!0},events:{click:()=>{i.value=R}},position:m}),k){let A=`edge-${C+1}`;s.value.push({id:A,source:i.value,target:R,type:"editable",label:`EDGE ${C+1}`,animated:!0,events:{click:()=>{i.value=A}}})}},$=m=>{console.log("edge connect",m)},w=m=>{console.log("edge double click",m)},P=(m,k)=>{for(let C=0;C<s.value.length;C++)if(s.value[C].id==k){s.value[C].label=m;break}};return(m,k)=>(r.openBlock(),r.createElementBlock("div",{class:r.normalizeClass(["node-editor-wrapper",o.value]),onMouseover:k[8]||(k[8]=C=>l.value=!0),onMouseleave:k[9]||(k[9]=C=>l.value=!1)},[r.createElementVNode("div",vc,[r.createElementVNode("div",wc,[r.createElementVNode("div",null,[bc,r.createTextVNode(" "+r.toDisplayString(i.value?i.value:"none"),1)])]),r.createElementVNode("div",xc,[r.createElementVNode("div",null,[r.createElementVNode("button",{class:"button-default",onClick:k[0]||(k[0]=C=>b())},"Add Node")]),r.createElementVNode("div",null,[r.createElementVNode("button",{class:"button-default",onClick:k[1]||(k[1]=C=>y())},"Center")]),r.unref(u)>-1?(r.openBlock(),r.createElementBlock("div",_c,[r.createElementVNode("button",{class:"button-default",onClick:k[2]||(k[2]=C=>x())},"Shift Input Position")])):r.createCommentVNode("",!0),r.unref(u)>-1?(r.openBlock(),r.createElementBlock("div",kc,[r.createElementVNode("button",{class:"button-default",onClick:k[3]||(k[3]=C=>g())},"Shift Output Position")])):r.createCommentVNode("",!0)])]),s.value&&s.value.length?(r.openBlock(),r.createBlock(r.unref(sc),{key:0,onWheel:k[4]||(k[4]=r.withModifiers(C=>E(C),["prevent"])),class:"nowheel","prevent-scrolling":!0,"zoom-on-scroll":!1,"fit-view-on-init":!0,modelValue:s.value,"onUpdate:modelValue":k[5]||(k[5]=C=>s.value=C),onConnect:k[6]||(k[6]=C=>$(C)),onEdgeDoubleClick:k[7]||(k[7]=C=>w(C))},{"node-editable":r.withCtx(C=>[r.createVNode(dc,r.mergeProps(C,{onChange:R=>P(R,C.id)}),null,16,["onChange"])]),"edge-editable":r.withCtx(C=>[r.createVNode(yc,r.mergeProps(C,{onChange:R=>P(R,C.id)}),null,16,["onChange"])]),_:1},8,["modelValue"])):r.createCommentVNode("",!0)],34))}}),Pc="",vr=r.defineComponent({__name:"StateEditor",props:["layout","nodeContainerClass","modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=r.computed({get:()=>{let l=n.modelValue,i={},s={},u=0,c=[];for(let d in l){c.length;let f={id:d,label:d,position:n.layout[d]&&n.layout[d].position?n.layout[d].position:{x:200*u,y:100},targetPosition:n.layout[d]&&n.layout[d].targetPosition?n.layout[d].targetPosition:"left",sourcePosition:n.layout[d]&&n.layout[d].sourcePosition?n.layout[d].sourcePosition:"right"};l[d].type&&l[d].type=="final"&&(f.type="output",f.class="default-output-node"),i[d]=f;let h=l[d].on;for(let g in l[d].on){let x=h[g];typeof x=="object"&&x.constructor===Object&&(x=x.target),c.push({id:`${d}-${h[g]}-${g}`,target:x,source:d,label:g,animated:!0}),s[x]=!0}u++}for(let d in i)s[d]||(i[d].type="input",i[d].class="default-input-node"),c.push(i[d]);return c},set:l=>{a(l)}}),a=l=>{let i={},s={},u={};for(let c=0;c<l.length;c++){let d=l[c];d.type=="input"?i[d.label]={on:{}}:d.type=="output"?i[d.label]={type:"final"}:d.source&&d.target?(s[d.source]=s[d.source]||{},s[d.source][d.label]={target:d.target}):i[d.label]={on:{}},u[d.id]=d.label}for(let c in s){let d=u[c];for(let f in s[c])i[d].on[f]=s[c][f]}t("update:modelValue",i)};return(l,i)=>(r.openBlock(),r.createElementBlock("div",null,[r.createVNode(bn,{modelValue:r.unref(o),"onUpdate:modelValue":i[0]||(i[0]=s=>r.isRef(o)?o.value=s:null),"node-container-class":e.nodeContainerClass},null,8,["modelValue","node-container-class"])]))}});function Ec(e){e.component("NodeEditor",bn),e.component("StateEditor",vr)}de.NodeEditor=bn,de.StateEditor=vr,de.install=Ec,Object.defineProperty(de,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=node-editor.umd.cjs.map
