{"version":3,"file":"atable.umd.cjs","sources":["../../utilities/dist/utilities.js","../src/components/ACell.vue","../src/components/AExpansionRow.vue","../src/components/ARow.vue","../../common/temp/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/rng.js","../../common/temp/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/stringify.js","../../common/temp/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/native.js","../../common/temp/node_modules/.pnpm/uuid@9.0.1/node_modules/uuid/dist/esm-browser/v4.js","../src/components/index.ts","../src/components/ATableHeader.vue","../src/components/ATableModal.vue","../src/components/ATable.vue","../src/index.ts"],"sourcesContent":["import { unref as Q, getCurrentScope as U, onScopeDispose as K, ref as B, watch as D, onMounted as W, onBeforeUnmount as V } from \"vue\";\nvar v;\nconst M = typeof window < \"u\", F = (e) => typeof e == \"string\", j = () => {\n};\nM && ((v = window == null ? void 0 : window.navigator) != null && v.userAgent) && /iP(ad|hone|od)/.test(window.navigator.userAgent);\nfunction H(e) {\n  return typeof e == \"function\" ? e() : Q(e);\n}\nfunction q(e) {\n  return e;\n}\nfunction G(e) {\n  return U() ? (K(e), !0) : !1;\n}\nfunction y(e) {\n  var t;\n  const r = H(e);\n  return (t = r == null ? void 0 : r.$el) != null ? t : r;\n}\nconst N = M ? window : void 0;\nfunction z(...e) {\n  let t, r, n, o;\n  if (F(e[0]) || Array.isArray(e[0]) ? ([r, n, o] = e, t = N) : [t, r, n, o] = e, !t)\n    return j;\n  Array.isArray(r) || (r = [r]), Array.isArray(n) || (n = [n]);\n  const l = [], s = () => {\n    l.forEach((c) => c()), l.length = 0;\n  }, a = (c, g, p, i) => (c.addEventListener(g, p, i), () => c.removeEventListener(g, p, i)), C = D(() => [y(t), H(o)], ([c, g]) => {\n    s(), c && l.push(...r.flatMap((p) => n.map((i) => a(c, p, i, g))));\n  }, { immediate: !0, flush: \"post\" }), d = () => {\n    C(), s();\n  };\n  return G(d), d;\n}\nconst O = typeof globalThis < \"u\" ? globalThis : typeof window < \"u\" ? window : typeof global < \"u\" ? global : typeof self < \"u\" ? self : {}, T = \"__vueuse_ssr_handlers__\";\nO[T] = O[T] || {};\nfunction J(e, { window: t = N, scrollTarget: r } = {}) {\n  const n = B(!1), o = () => {\n    if (!t)\n      return;\n    const l = t.document, s = y(e);\n    if (!s)\n      n.value = !1;\n    else {\n      const a = s.getBoundingClientRect();\n      n.value = a.top <= (t.innerHeight || l.documentElement.clientHeight) && a.left <= (t.innerWidth || l.documentElement.clientWidth) && a.bottom >= 0 && a.right >= 0;\n    }\n  };\n  return D(() => y(e), () => o(), { immediate: !0, flush: \"post\" }), t && z(r || t, \"scroll\", o, {\n    capture: !1,\n    passive: !0\n  }), n;\n}\nvar P;\n(function(e) {\n  e.UP = \"UP\", e.RIGHT = \"RIGHT\", e.DOWN = \"DOWN\", e.LEFT = \"LEFT\", e.NONE = \"NONE\";\n})(P || (P = {}));\nvar X = Object.defineProperty, I = Object.getOwnPropertySymbols, Y = Object.prototype.hasOwnProperty, Z = Object.prototype.propertyIsEnumerable, _ = (e, t, r) => t in e ? X(e, t, { enumerable: !0, configurable: !0, writable: !0, value: r }) : e[t] = r, ee = (e, t) => {\n  for (var r in t || (t = {}))\n    Y.call(t, r) && _(e, r, t[r]);\n  if (I)\n    for (var r of I(t))\n      Z.call(t, r) && _(e, r, t[r]);\n  return e;\n};\nconst te = {\n  easeInSine: [0.12, 0, 0.39, 0],\n  easeOutSine: [0.61, 1, 0.88, 1],\n  easeInOutSine: [0.37, 0, 0.63, 1],\n  easeInQuad: [0.11, 0, 0.5, 0],\n  easeOutQuad: [0.5, 1, 0.89, 1],\n  easeInOutQuad: [0.45, 0, 0.55, 1],\n  easeInCubic: [0.32, 0, 0.67, 0],\n  easeOutCubic: [0.33, 1, 0.68, 1],\n  easeInOutCubic: [0.65, 0, 0.35, 1],\n  easeInQuart: [0.5, 0, 0.75, 0],\n  easeOutQuart: [0.25, 1, 0.5, 1],\n  easeInOutQuart: [0.76, 0, 0.24, 1],\n  easeInQuint: [0.64, 0, 0.78, 0],\n  easeOutQuint: [0.22, 1, 0.36, 1],\n  easeInOutQuint: [0.83, 0, 0.17, 1],\n  easeInExpo: [0.7, 0, 0.84, 0],\n  easeOutExpo: [0.16, 1, 0.3, 1],\n  easeInOutExpo: [0.87, 0, 0.13, 1],\n  easeInCirc: [0.55, 0, 1, 0.45],\n  easeOutCirc: [0, 0.55, 0.45, 1],\n  easeInOutCirc: [0.85, 0, 0.15, 1],\n  easeInBack: [0.36, 0, 0.66, -0.56],\n  easeOutBack: [0.34, 1.56, 0.64, 1],\n  easeInOutBack: [0.68, -0.6, 0.32, 1.6]\n};\nee({\n  linear: q\n}, te);\nconst f = (e) => {\n  let t = J(e).value;\n  return t = t && e.offsetHeight > 0, t;\n}, u = (e) => e.tabIndex >= 0, A = (e) => {\n  const t = e.target;\n  return E(t);\n}, E = (e) => {\n  var r;\n  let t;\n  if (e instanceof HTMLTableCellElement) {\n    const n = (r = e.parentElement) == null ? void 0 : r.previousElementSibling;\n    if (n) {\n      const l = Array.from(n.children)[e.cellIndex];\n      l && (t = l);\n    }\n  } else if (e instanceof HTMLTableRowElement) {\n    const n = e.previousElementSibling;\n    n && (t = n);\n  }\n  return t && (!u(t) || !f(t)) ? E(t) : t;\n}, ne = (e) => {\n  var n;\n  const t = e.target;\n  let r;\n  if (t instanceof HTMLTableCellElement) {\n    const o = (n = t.parentElement) == null ? void 0 : n.parentElement;\n    if (o) {\n      const s = o.firstElementChild.children[t.cellIndex];\n      s && (r = s);\n    }\n  } else if (t instanceof HTMLTableRowElement) {\n    const o = t.parentElement;\n    if (o) {\n      const l = o.firstElementChild;\n      l && (r = l);\n    }\n  }\n  return r && (!u(r) || !f(r)) ? w(r) : r;\n}, x = (e) => {\n  const t = e.target;\n  return w(t);\n}, w = (e) => {\n  var r;\n  let t;\n  if (e instanceof HTMLTableCellElement) {\n    const n = (r = e.parentElement) == null ? void 0 : r.nextElementSibling;\n    if (n) {\n      const l = Array.from(n.children)[e.cellIndex];\n      l && (t = l);\n    }\n  } else if (e instanceof HTMLTableRowElement) {\n    const n = e.nextElementSibling;\n    n && (t = n);\n  }\n  return t && (!u(t) || !f(t)) ? w(t) : t;\n}, re = (e) => {\n  var n;\n  const t = e.target;\n  let r;\n  if (t instanceof HTMLTableCellElement) {\n    const o = (n = t.parentElement) == null ? void 0 : n.parentElement;\n    if (o) {\n      const s = o.lastElementChild.children[t.cellIndex];\n      s && (r = s);\n    }\n  } else if (t instanceof HTMLTableRowElement) {\n    const o = t.parentElement;\n    if (o) {\n      const l = o.lastElementChild;\n      l && (r = l);\n    }\n  }\n  return r && (!u(r) || !f(r)) ? E(r) : r;\n}, k = (e) => {\n  const t = e.target;\n  return h(t);\n}, h = (e) => {\n  var r;\n  let t;\n  if (e.previousElementSibling)\n    t = e.previousElementSibling;\n  else {\n    const n = (r = e.parentElement) == null ? void 0 : r.previousElementSibling;\n    t = n == null ? void 0 : n.lastElementChild;\n  }\n  return t && (!u(t) || !f(t)) ? h(t) : t;\n}, S = (e) => {\n  const t = e.target;\n  return b(t);\n}, b = (e) => {\n  var r;\n  let t;\n  if (e.nextElementSibling)\n    t = e.nextElementSibling;\n  else {\n    const n = (r = e.parentElement) == null ? void 0 : r.nextElementSibling;\n    t = n == null ? void 0 : n.firstElementChild;\n  }\n  return t && (!u(t) || !f(t)) ? b(t) : t;\n}, L = (e) => {\n  const n = e.target.parentElement.firstElementChild;\n  return n && (!u(n) || !f(n)) ? b(n) : n;\n}, R = (e) => {\n  const n = e.target.parentElement.lastElementChild;\n  return n && (!u(n) || !f(n)) ? h(n) : n;\n}, m = [\"alt\", \"control\", \"shift\", \"meta\"], oe = {\n  ArrowUp: \"up\",\n  ArrowDown: \"down\",\n  ArrowLeft: \"left\",\n  ArrowRight: \"right\"\n}, le = {\n  \"keydown.up\": (e) => {\n    const t = A(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.down\": (e) => {\n    const t = x(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.left\": (e) => {\n    const t = k(e);\n    e.preventDefault(), e.stopPropagation(), t && t.focus();\n  },\n  \"keydown.right\": (e) => {\n    const t = S(e);\n    e.preventDefault(), e.stopPropagation(), t && t.focus();\n  },\n  \"keydown.control.up\": (e) => {\n    const t = ne(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.control.down\": (e) => {\n    const t = re(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.control.left\": (e) => {\n    const t = L(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.control.right\": (e) => {\n    const t = R(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.end\": (e) => {\n    const t = R(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.enter\": (e) => {\n    if (e.target instanceof HTMLTableCellElement) {\n      e.preventDefault(), e.stopPropagation();\n      const r = x(e);\n      r && r.focus();\n    }\n  },\n  \"keydown.shift.enter\": (e) => {\n    if (e.target instanceof HTMLTableCellElement) {\n      e.preventDefault(), e.stopPropagation();\n      const r = A(e);\n      r && r.focus();\n    }\n  },\n  \"keydown.home\": (e) => {\n    const t = L(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.tab\": (e) => {\n    const t = S(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  },\n  \"keydown.shift.tab\": (e) => {\n    const t = k(e);\n    t && (e.preventDefault(), e.stopPropagation(), t.focus());\n  }\n};\nfunction ie(e) {\n  const t = (n) => {\n    let o = null;\n    n.parent && (typeof n.parent == \"string\" ? o = document.querySelector(n.parent) : n.parent instanceof Element ? o = n.parent : o = n.parent.value);\n    let l = [];\n    if (n.selectors)\n      if (typeof n.selectors == \"string\")\n        l = o ? Array.from(o.querySelectorAll(n.selectors)) : Array.from(document.querySelectorAll(n.selectors));\n      else if (n.selectors instanceof Element)\n        l.push(n.selectors);\n      else if (Array.isArray(n.selectors.value))\n        for (const s of n.selectors.value)\n          s instanceof Element ? l.push(s) : l.push(s.$el);\n      else\n        l.push(n.selectors.value);\n    else\n      l = Array.from(o.children).filter((a) => u(a) && f(a));\n    return l;\n  }, r = (n) => (o) => {\n    const l = oe[o.key] || o.key.toLowerCase();\n    if (m.includes(l))\n      return;\n    const s = n.handlers || le;\n    for (const a of Object.keys(s)) {\n      const [C, ...d] = a.split(\".\");\n      if (C === \"keydown\" && d.includes(l)) {\n        const c = s[a], g = d.filter((i) => m.includes(i)), p = m.some((i) => {\n          const $ = i.charAt(0).toUpperCase() + i.slice(1);\n          return o.getModifierState($);\n        });\n        if (g.length > 0) {\n          if (p) {\n            for (const i of m)\n              if (d.includes(i)) {\n                const $ = i.charAt(0).toUpperCase() + i.slice(1);\n                o.getModifierState($) && c(o);\n              }\n          }\n        } else\n          p || c(o);\n      }\n    }\n  };\n  W(() => {\n    for (const n of e) {\n      const o = t(n);\n      for (const l of o)\n        l.addEventListener(\"keydown\", r(n));\n    }\n  }), V(() => {\n    for (const n of e) {\n      const o = t(n);\n      for (const l of o)\n        l.removeEventListener(\"keydown\", r(n));\n    }\n  });\n}\nfunction ae(e) {\n}\nexport {\n  le as defaultKeypressHandlers,\n  ae as install,\n  ie as useKeyboardNav\n};\n//# sourceMappingURL=utilities.js.map\n","<template>\r\n\t<td\r\n\t\tref=\"cell\"\r\n\t\t:data-colindex=\"colIndex\"\r\n\t\t:data-rowindex=\"rowIndex\"\r\n\t\t:data-editable=\"tableData.columns[colIndex].edit\"\r\n\t\t:contenteditable=\"tableData.columns[colIndex].edit\"\r\n\t\t:tabindex=\"tabIndex\"\r\n\t\t:spellcheck=\"false\"\r\n\t\t:style=\"cellStyle\"\r\n\t\t@focus=\"onFocus\"\r\n\t\t@paste=\"onChange\"\r\n\t\t@blur=\"onChange\"\r\n\t\t@input=\"onChange\"\r\n\t\t@click=\"handleInput\"\r\n\t\t@mousedown=\"handleInput\">\r\n\t\t<component\r\n\t\t\tv-if=\"tableData.columns[colIndex].cellComponent\"\r\n\t\t\t:is=\"tableData.columns[colIndex].cellComponent\"\r\n\t\t\t:value=\"displayValue\"\r\n\t\t\tv-bind=\"tableData.columns[colIndex].cellComponentProps\">\r\n\t\t</component>\r\n\t\t<span v-else>{{ displayValue }}</span>\r\n\t</td>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, CSSProperties, inject, ref } from 'vue'\r\n\r\nimport { defaultKeypressHandlers, useKeyboardNav } from '@stonecrop/utilities'\r\nimport TableDataStore from '.'\r\n\r\nconst props = withDefaults(\r\n\tdefineProps<{\r\n\t\tcolIndex: number\r\n\t\trowIndex: number\r\n\t\ttableid: string\r\n\t\taddNavigation?: boolean | object\r\n\t\ttabIndex?: number\r\n\t\tclickHandler?: (event: MouseEvent) => void\r\n\t}>(),\r\n\t{\r\n\t\ttabIndex: 0,\r\n\t\taddNavigation: true,\r\n\t}\r\n)\r\n\r\nconst tableData = inject<TableDataStore>(props.tableid)\r\nconst cell = ref<HTMLTableCellElement>(null)\r\n\r\nlet cellModified = ref(false)\r\nconst displayValue = computed(() => {\r\n\tconst data = tableData.cellData<any>(props.colIndex, props.rowIndex)\r\n\tif (tableData.columns[props.colIndex].format) {\r\n\t\tconst format = tableData.columns[props.colIndex].format\r\n\t\tif (typeof format === 'function') {\r\n\t\t\treturn format(data)\r\n\t\t} else if (typeof format === 'string') {\r\n\t\t\t// parse format function from string\r\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-implied-eval\r\n\t\t\tconst formatFn: (args: any) => any = Function(`\"use strict\";return (${format})`)()\r\n\t\t\treturn formatFn(data)\r\n\t\t} else {\r\n\t\t\treturn data\r\n\t\t}\r\n\t} else {\r\n\t\treturn data\r\n\t}\r\n})\r\n\r\nconst handleInput = (event: MouseEvent) => {\r\n\t// Not sure if click handler is needed anymore?\r\n\tif (props.clickHandler) {\r\n\t\tprops.clickHandler(event)\r\n\t\treturn\r\n\t}\r\n\r\n\tif (tableData.columns[props.colIndex].mask) {\r\n\t\t// TODO: add masking to cell values\r\n\t\t// tableData.columns[props.colIndex].mask(event)\r\n\t}\r\n\r\n\tif (tableData.columns[props.colIndex].modalComponent) {\r\n\t\tconst domRect = cell.value.getBoundingClientRect()\r\n\t\ttableData.modal.visible = true\r\n\t\ttableData.modal.colIndex = props.colIndex\r\n\t\ttableData.modal.rowIndex = props.rowIndex\r\n\t\ttableData.modal.parent = cell.value\r\n\t\ttableData.modal.top = domRect.top + domRect.height\r\n\t\ttableData.modal.left = domRect.left\r\n\t\ttableData.modal.width = cellWidth.value\r\n\t\ttableData.modal.component = tableData.columns[props.colIndex].modalComponent\r\n\t\ttableData.modal.componentProps = tableData.columns[props.colIndex].modalComponentProps\r\n\t}\r\n}\r\n\r\nif (props.addNavigation) {\r\n\tlet handlers = {\r\n\t\t...defaultKeypressHandlers,\r\n\t\t...{\r\n\t\t\t'keydown.f2': handleInput,\r\n\t\t\t'keydown.alt.up': handleInput,\r\n\t\t\t'keydown.alt.down': handleInput,\r\n\t\t\t'keydown.alt.left': handleInput,\r\n\t\t\t'keydown.alt.right': handleInput,\r\n\t\t},\r\n\t}\r\n\r\n\tif (typeof props.addNavigation === 'object') {\r\n\t\thandlers = {\r\n\t\t\t...handlers,\r\n\t\t\t...props.addNavigation,\r\n\t\t}\r\n\t}\r\n\r\n\tuseKeyboardNav([\r\n\t\t{\r\n\t\t\tselectors: cell,\r\n\t\t\thandlers: handlers,\r\n\t\t},\r\n\t])\r\n}\r\n\r\n// const updateData = (event: Event) => {\r\n// \tif (event) {\r\n// \t\t// custom components need to handle their own updateData, this is the default\r\n// \t\tif (!tableData.columns[props.colIndex].component) {\r\n// \t\t\ttableData.setCellData(props.rowIndex, props.colIndex, cell.value.innerHTML)\r\n// \t\t}\r\n// \t\tcellModified.value = true\r\n// \t}\r\n// }\r\n\r\nconst textAlign = computed(() => {\r\n\treturn tableData.columns[props.colIndex].align || 'center'\r\n})\r\n\r\nconst cellWidth = computed(() => {\r\n\treturn tableData.columns[props.colIndex].width || '40ch'\r\n})\r\n\r\nlet currentData = ''\r\nconst onFocus = () => {\r\n\tif (cell.value) {\r\n\t\tcurrentData = cell.value.innerText\r\n\t}\r\n}\r\n\r\nconst onChange = () => {\r\n\tif (cell.value) {\r\n\t\tif (cell.value.innerHTML !== currentData) {\r\n\t\t\tcurrentData = cell.value.innerText\r\n\t\t\tcell.value.dispatchEvent(new Event('change'))\r\n\t\t\tcellModified.value = true // set display instead\r\n\t\t\tif (!tableData.columns[props.colIndex].format) {\r\n\t\t\t\t// TODO: need to setup reverse format function\r\n\t\t\t\ttableData.setCellData(props.rowIndex, props.colIndex, currentData)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst getIndent = (colKey: number, indent: number) => {\r\n\tif (indent && colKey === 0 && indent > 0) {\r\n\t\treturn `${indent}ch`\r\n\t} else {\r\n\t\treturn 'inherit'\r\n\t}\r\n}\r\n\r\nconst cellStyle: CSSProperties = {\r\n\ttextAlign: textAlign.value,\r\n\twidth: cellWidth.value,\r\n\tbackgroundColor: !cellModified.value ? 'inherit' : 'var(--cell-modified-color)',\r\n\tfontWeight: !cellModified.value ? 'inherit' : 'bold',\r\n\tpaddingLeft: getIndent(props.colIndex, tableData.display[props.rowIndex]?.indent),\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\ntd {\r\n\tborder-radius: 0px;\r\n\tbox-sizing: border-box;\r\n\tmargin: 0px;\r\n\toutline: none;\r\n\tbox-shadow: none;\r\n\tcolor: var(--cell-text-color);\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\tpadding-left: 0.5ch !important;\r\n\tpadding-right: 0.5ch;\r\n\r\n\tpadding-top: var(--atable-row-padding);\r\n\tpadding-bottom: var(--atable-row-padding);\r\n\r\n\tborder-spacing: 0px;\r\n\tborder-collapse: collapse;\r\n}\r\n\r\ntd:focus,\r\ntd:focus-within {\r\n\tbackground-color: var(--focus-cell-background);\r\n\toutline-width: 2px;\r\n\toutline-style: solid;\r\n\toutline-color: var(--focus-cell-outline);\r\n\tbox-shadow: none;\r\n\toverflow: hidden;\r\n\tmin-height: 1.15em;\r\n\tmax-height: 1.15em;\r\n\toverflow: hidden;\r\n}\r\n</style>\r\n","<template>\r\n\t<tr v-bind=\"$attrs\" ref=\"rowEl\" :tabindex=\"tabIndex\" class=\"expandable-row\">\r\n\t\t<td :tabIndex=\"-1\" @click=\"tableData.toggleRowExpand(rowIndex)\" class=\"row-index\">\r\n\t\t\t{{ getRowExpandSymbol() }}\r\n\t\t</td>\r\n\t\t<slot name=\"row\" />\r\n\t</tr>\r\n\t<tr v-if=\"tableData.display[props.rowIndex].expanded\" ref=\"rowExpanded\" :tabindex=\"tabIndex\" class=\"expanded-row\">\r\n\t\t<td :tabIndex=\"-1\" :colspan=\"tableData.columns.length + 1\" class=\"expanded-row-content\">\r\n\t\t\t<slot name=\"content\" />\r\n\t\t</td>\r\n\t</tr>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { TableRow } from 'types'\r\nimport { inject, ref } from 'vue'\r\n\r\nimport { useKeyboardNav } from '@stonecrop/utilities'\r\n\r\nimport TableDataStore from '.'\r\n\r\nconst props = withDefaults(\r\n\tdefineProps<{\r\n\t\trow: TableRow\r\n\t\trowIndex: number\r\n\t\ttableid: string\r\n\t\ttabIndex?: number\r\n\t\taddNavigation?: {\r\n\t\t\t[key: string]: (ev: KeyboardEvent) => any\r\n\t\t}\r\n\t}>(),\r\n\t{\r\n\t\ttabIndex: -1,\r\n\t}\r\n)\r\n\r\nconst tableData = inject<TableDataStore>(props.tableid)\r\nconst rowEl = ref<HTMLTableRowElement>(null)\r\nconst rowExpanded = ref<HTMLDivElement>(null)\r\n\r\nconst getRowExpandSymbol = () => {\r\n\treturn tableData.display[props.rowIndex].expanded ? '▼' : '►'\r\n}\r\n\r\nif (props.addNavigation !== undefined) {\r\n\tconst keyboardNav = Object.assign({}, props.addNavigation)\r\n\tkeyboardNav['keydown.control.g'] = (event: KeyboardEvent) => {\r\n\t\tevent.stopPropagation()\r\n\t\tevent.preventDefault()\r\n\t\ttableData.toggleRowExpand(props.rowIndex)\r\n\t}\r\n\r\n\tuseKeyboardNav([\r\n\t\t{\r\n\t\t\tselectors: rowEl,\r\n\t\t\thandlers: keyboardNav,\r\n\t\t},\r\n\t])\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\n.row-index {\r\n\tcolor: var(--header-text-color);\r\n\tfont-weight: bold;\r\n\ttext-align: center;\r\n\tuser-select: none;\r\n\twidth: 2ch;\r\n}\r\n\r\n.expandable-row {\r\n\tborder-top: 1px solid var(--row-border-color);\r\n\theight: var(--atable-row-height);\r\n}\r\n\r\n.expanded-row {\r\n\tborder-bottom: 1px solid var(--row-border-color);\r\n\tborder-top: 1px solid var(--row-border-color);\r\n}\r\n\r\n.expanded-row-content {\r\n\tborder-bottom: 1px solid var(--row-border-color);\r\n\tborder-top: 1px solid var(--row-border-color);\r\n\tpadding: 1.5rem;\r\n}\r\n</style>\r\n","<template>\r\n\t<tr ref=\"rowEl\" :tabindex=\"tabIndex\" v-show=\"rowVisible()\" class=\"table-row\">\r\n\t\t<!-- render numbered/tree view index -->\r\n\t\t<td v-if=\"tableData.config.view === 'list'\" :tabIndex=\"-1\" class=\"list-index\">\r\n\t\t\t{{ rowIndex + 1 }}\r\n\t\t</td>\r\n\t\t<td\r\n\t\t\tv-else-if=\"tableData.config.view === 'tree'\"\r\n\t\t\t:tabIndex=\"-1\"\r\n\t\t\tclass=\"tree-index\"\r\n\t\t\t@click=\"toggleRowExpand(rowIndex)\">\r\n\t\t\t{{ getRowExpandSymbol() }}\r\n\t\t</td>\r\n\t\t<slot v-else name=\"indexCell\"></slot>\r\n\r\n\t\t<!-- render cell content -->\r\n\t\t<slot></slot>\r\n\t</tr>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { TableRow } from 'types'\r\nimport { inject, ref } from 'vue'\r\nimport { useKeyboardNav } from '@stonecrop/utilities'\r\n\r\nimport TableDataStore from '.'\r\n\r\nconst props = withDefaults(\r\n\tdefineProps<{\r\n\t\trow: TableRow\r\n\t\trowIndex: number\r\n\t\ttableid: string\r\n\t\ttabIndex?: number\r\n\t\taddNavigation?: object\r\n\t}>(),\r\n\t{\r\n\t\ttabIndex: -1,\r\n\t}\r\n)\r\n\r\nconst tableData = inject<TableDataStore>(props.tableid)\r\nconst rowEl = ref<HTMLTableRowElement>(null)\r\nconst numberedRowWidth = tableData.numberedRowWidth.value\r\n\r\nconst getRowExpandSymbol = () => {\r\n\tif (tableData.config.view !== 'tree') {\r\n\t\treturn ''\r\n\t}\r\n\r\n\tif (tableData.display[props.rowIndex].isRoot) {\r\n\t\tif (tableData.display[props.rowIndex].childrenOpen) {\r\n\t\t\treturn '-'\r\n\t\t} else {\r\n\t\t\treturn '+'\r\n\t\t}\r\n\t}\r\n\r\n\tif (tableData.display[props.rowIndex].isParent) {\r\n\t\tif (tableData.display[props.rowIndex].childrenOpen) {\r\n\t\t\treturn '-'\r\n\t\t} else {\r\n\t\t\treturn '+'\r\n\t\t}\r\n\t} else {\r\n\t\treturn ''\r\n\t}\r\n}\r\n\r\nconst rowVisible = () => {\r\n\treturn (\r\n\t\ttableData.config.view !== 'tree' ||\r\n\t\ttableData.display[props.rowIndex].isRoot ||\r\n\t\ttableData.display[props.rowIndex].open\r\n\t)\r\n}\r\n\r\nconst toggleRowExpand = (rowIndex: number) => {\r\n\ttableData.toggleRowExpand(rowIndex)\r\n}\r\n\r\nif (props.addNavigation) {\r\n\tuseKeyboardNav([\r\n\t\t{\r\n\t\t\tselectors: rowEl,\r\n\t\t\thandlers: props.addNavigation,\r\n\t\t},\r\n\t])\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\n.table-row {\r\n\tborder-top: 1px solid var(--row-border-color);\r\n\theight: var(--atable-row-height);\r\n}\r\n\r\n.list-index {\r\n\tcolor: var(--header-text-color);\r\n\tfont-weight: bold;\r\n\tpadding-left: var(--atable-row-padding);\r\n\tpadding-right: 1em;\r\n\ttext-align: center;\r\n\tuser-select: none;\r\n\twidth: v-bind(numberedRowWidth);\r\n\tmax-width: v-bind(numberedRowWidth);\r\n}\r\n\r\n.tree-index {\r\n\tcolor: var(--header-text-color);\r\n\tfont-weight: bold;\r\n\ttext-align: center;\r\n\tuser-select: none;\r\n\twidth: 2ch;\r\n}\r\n</style>\r\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 } from 'uuid'\r\nimport { computed, reactive } from 'vue'\r\n\r\nimport type { TableDisplay, TableRow, TableColumn, TableConfig, TableModal } from '../../types'\r\n\r\nexport default class TableDataStore {\r\n\tid: string\r\n\trows: TableRow[]\r\n\tcolumns: TableColumn[]\r\n\tconfig: TableConfig\r\n\ttable: { [key: string]: any }\r\n\tdisplay: TableDisplay[]\r\n\tmodal: TableModal\r\n\r\n\tconstructor(\r\n\t\tid?: string,\r\n\t\tcolumns?: TableColumn[],\r\n\t\trows?: TableRow[],\r\n\t\tconfig?: TableConfig,\r\n\t\ttable?: { [key: string]: any },\r\n\t\tdisplay?: TableDisplay[]\r\n\t) {\r\n\t\tthis.id = id || v4()\r\n\t\tthis.rows = rows\r\n\t\tthis.columns = reactive(columns)\r\n\t\tthis.config = reactive(config)\r\n\t\tthis.table = table || reactive(this.createTableObject())\r\n\t\tthis.display = this.createDisplayObject(display)\r\n\t\tthis.modal = reactive({ visible: false })\r\n\t}\r\n\r\n\tcreateTableObject() {\r\n\t\tconst table = {}\r\n\t\tfor (const [colIndex, column] of this.columns.entries()) {\r\n\t\t\tfor (const [rowIndex, row] of this.rows.entries()) {\r\n\t\t\t\ttable[`${colIndex}:${rowIndex}`] = row[column.name]\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn table\r\n\t}\r\n\r\n\tcreateDisplayObject(display?: TableDisplay[]) {\r\n\t\tconst defaultDisplay: TableDisplay[] = [Object.assign({}, { modified: false })]\r\n\r\n\t\t// TODO: (typing) what is the type of `display` here?\r\n\t\tif (display) {\r\n\t\t\tif ('0:0' in display) {\r\n\t\t\t\treturn display\r\n\t\t\t}\r\n\t\t\t// else if ('default' in display) {\r\n\t\t\t// \t// TODO: (typing) what is the possible input here for 'default'?\r\n\t\t\t// \tdefaultDisplay = display.default\r\n\t\t\t// }\r\n\t\t}\r\n\r\n\t\t// TODO: (typing) is this type correct for the parent set?\r\n\t\tconst parents = new Set<string | number>()\r\n\t\tfor (let rowIndex = this.rows.length - 1; rowIndex >= 0; rowIndex--) {\r\n\t\t\tconst row = this.rows[rowIndex]\r\n\t\t\tif (row.parent) {\r\n\t\t\t\tparents.add(row.parent)\r\n\t\t\t}\r\n\r\n\t\t\tdefaultDisplay[rowIndex] = {\r\n\t\t\t\tchildrenOpen: false,\r\n\t\t\t\texpanded: false,\r\n\t\t\t\tindent: row.indent || null,\r\n\t\t\t\tisParent: parents.has(rowIndex),\r\n\t\t\t\tisRoot: row.parent === null || row.parent === undefined,\r\n\t\t\t\tmodified: false,\r\n\t\t\t\topen: row.parent === null || row.parent === undefined,\r\n\t\t\t\tparent: row.parent,\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn reactive(defaultDisplay)\r\n\t}\r\n\r\n\tget zeroColumn() {\r\n\t\treturn ['list', 'tree', 'list-expansion'].includes(this.config.view)\r\n\t}\r\n\r\n\tget numberedRowWidth() {\r\n\t\treturn computed(() => {\r\n\t\t\treturn String(Math.ceil(this.rows.length / 100) + 1) + 'ch'\r\n\t\t})\r\n\t}\r\n\r\n\tcellData<T>(colIndex: number, rowIndex: number): T {\r\n\t\treturn this.table[`${colIndex}:${rowIndex}`]\r\n\t}\r\n\r\n\tsetCellData(rowIndex: number, colIndex: number, value: any) {\r\n\t\tif (this.table[`${colIndex}:${rowIndex}`] !== value) {\r\n\t\t\tthis.display[rowIndex].modified = true\r\n\t\t}\r\n\t\tthis.table[`${colIndex}:${rowIndex}`] = value\r\n\t\tconst col = this.columns[colIndex]\r\n\t\tthis.rows[rowIndex][col.name] = value\r\n\t\treturn this.table[`${colIndex}:${rowIndex}`]\r\n\t}\r\n\r\n\ttoggleRowExpand(rowIndex: number) {\r\n\t\tif (this.config.view === 'tree') {\r\n\t\t\tthis.display[rowIndex].childrenOpen = !this.display[rowIndex].childrenOpen\r\n\t\t\tfor (let index = this.rows.length - 1; index >= 0; index--) {\r\n\t\t\t\tif (this.display[index].parent === rowIndex) {\r\n\t\t\t\t\tthis.display[index].open = !this.display[index].open\r\n\t\t\t\t\tif (this.display[index].childrenOpen) {\r\n\t\t\t\t\t\tthis.toggleRowExpand(index)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (this.config.view === 'list-expansion') {\r\n\t\t\tthis.display[rowIndex].expanded = !this.display[rowIndex].expanded\r\n\t\t}\r\n\t}\r\n}\r\n","<template>\r\n\t<thead v-if=\"columns.length\">\r\n\t\t<tr class=\"atable-header-row\" tabindex=\"-1\">\r\n\t\t\t<th v-if=\"tableData.zeroColumn\" id=\"header-index\" />\r\n\t\t\t<th v-for=\"(column, colKey) in columns\" :key=\"colKey\" tabindex=\"-1\" :style=\"getHeaderCellStyle(column)\">\r\n\t\t\t\t<slot>{{ column.label || String.fromCharCode(colKey + 97).toUpperCase() }}</slot>\r\n\t\t\t</th>\r\n\t\t</tr>\r\n\t</thead>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { CSSProperties, inject } from 'vue'\r\n\r\nimport { TableColumn, TableConfig } from 'types'\r\nimport TableDataStore from '.'\r\n\r\nconst props = defineProps<{\r\n\tcolumns: TableColumn[]\r\n\tconfig?: TableConfig\r\n\ttableid?: string\r\n}>()\r\n\r\nconst tableData = inject<TableDataStore>(props.tableid)\r\n\r\nconst numberedRowWidth = tableData.numberedRowWidth.value\r\nconst getHeaderCellStyle = (column: TableColumn): CSSProperties => ({\r\n\tminWidth: column.width || '40ch',\r\n\ttextAlign: column.align || 'center',\r\n\twidth: tableData.config.fullWidth ? 'auto' : null,\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\nthead {\r\n\tbackground-color: var(--gray-5);\r\n}\r\n\r\n#header-index {\r\n\twidth: v-bind(numberedRowWidth);\r\n\tmax-width: v-bind(numberedRowWidth);\r\n}\r\n\r\nth {\r\n\tborder-width: 0px;\r\n\tborder-style: solid;\r\n\tborder-radius: 0px;\r\n\tpadding-left: 0.5ch;\r\n\tpadding-right: 0.5ch;\r\n\tpadding-top: var(--atable-row-padding);\r\n\tpadding-bottom: var(--atable-row-padding);\r\n\tcolor: var(--gray-60);\r\n\theight: var(--atable-row-height);\r\n}\r\n\r\nth:focus {\r\n\toutline: none;\r\n}\r\n</style>\r\n","<template>\r\n\t<div ref=\"amodal\" class=\"amodal\" tabindex=\"-1\" @click=\"handleInput\" @input=\"handleInput\">\r\n\t\t<slot />\r\n\t</div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { inject } from 'vue'\r\n\r\nimport TableDataStore from '.'\r\n\r\nconst props = defineProps<{\r\n\tcolIndex?: number\r\n\trowIndex?: number\r\n\ttableid?: string\r\n}>()\r\n\r\nconst tableData = inject<TableDataStore>(props.tableid)\r\n\r\nconst handleInput = (event: Event) => {\r\n\tevent.stopPropagation()\r\n}\r\n\r\n// const cellBackgroundColor = computed(() => {\r\n// \tif (tableData.modal.parent) {\r\n// \t\tlet computedstyle = window.getComputedStyle(tableData.modal.parent)\r\n// \t\treturn 'blue'\r\n// \t} else {\r\n// \t\treturn 'inherit'\r\n// \t}\r\n// })\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\ndiv {\r\n\tz-index: 100;\r\n\tposition: absolute;\r\n\tbackground-color: var(--row-color-zebra-dark);\r\n\t/* margin: 0px;\r\n\toutline: none;\r\n\tbox-shadow: none;\r\n\tcolor: var(--cell-text-color);\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\tpadding-left: 0.5ch;\r\n\tpadding-right: 0.5ch;\r\n\tfont-size: var(--table-font-size); */\r\n}\r\n</style>\r\n","<template>\r\n\t<table class=\"atable\" :style=\"{ width: tableData.config.fullWidth ? '100%' : 'auto' }\">\r\n\t\t<slot name=\"header\" :data=\"tableData\">\r\n\t\t\t<ATableHeader :columns=\"tableData.columns\" :config=\"tableData.config\" :tableid=\"tableData.id\" />\r\n\t\t</slot>\r\n\r\n\t\t<tbody>\r\n\t\t\t<slot name=\"body\" :data=\"tableData\">\r\n\t\t\t\t<ARow\r\n\t\t\t\t\tv-for=\"(row, rowIndex) in tableData.rows\"\r\n\t\t\t\t\t:key=\"row.id || v4()\"\r\n\t\t\t\t\t:row=\"row\"\r\n\t\t\t\t\t:rowIndex=\"rowIndex\"\r\n\t\t\t\t\t:tableid=\"tableData.id\">\r\n\t\t\t\t\t<ACell\r\n\t\t\t\t\t\tv-for=\"(col, colIndex) in tableData.columns\"\r\n\t\t\t\t\t\t:key=\"`${colIndex}:${rowIndex}`\"\r\n\t\t\t\t\t\t:tableid=\"tableData.id\"\r\n\t\t\t\t\t\t:col=\"col\"\r\n\t\t\t\t\t\tspellcheck=\"false\"\r\n\t\t\t\t\t\t:rowIndex=\"rowIndex\"\r\n\t\t\t\t\t\t:colIndex=\"colIndex + (tableData.zeroColumn ? 0 : -1)\"\r\n\t\t\t\t\t\t:component=\"col.cellComponent\"\r\n\t\t\t\t\t\t:style=\"{\r\n\t\t\t\t\t\t\ttextAlign: col?.align || 'center',\r\n\t\t\t\t\t\t\tminWidth: col?.width || '40ch',\r\n\t\t\t\t\t\t\twidth: tableData.config.fullWidth ? 'auto' : null,\r\n\t\t\t\t\t\t}\" />\r\n\t\t\t\t</ARow>\r\n\t\t\t</slot>\r\n\t\t</tbody>\r\n\r\n\t\t<slot name=\"footer\" :data=\"tableData\" />\r\n\t\t<slot name=\"modal\" :data=\"tableData\">\r\n\t\t\t<ATableModal\r\n\t\t\t\tv-show=\"tableData.modal.visible\"\r\n\t\t\t\t:colIndex=\"tableData.modal.colIndex\"\r\n\t\t\t\t:rowIndex=\"tableData.modal.rowIndex\"\r\n\t\t\t\t:tableid=\"tableData.id\"\r\n\t\t\t\t:style=\"{\r\n\t\t\t\t\tleft: tableData.modal.left + 'px',\r\n\t\t\t\t\ttop: tableData.modal.top + 'px',\r\n\t\t\t\t\tmaxWidth: tableData.modal.width + 'px',\r\n\t\t\t\t}\">\r\n\t\t\t\t<template #default>\r\n\t\t\t\t\t<component\r\n\t\t\t\t\t\t:key=\"`${tableData.modal.rowIndex}:${tableData.modal.colIndex}`\"\r\n\t\t\t\t\t\t:is=\"tableData.modal.component\"\r\n\t\t\t\t\t\t:colIndex=\"tableData.modal.colIndex\"\r\n\t\t\t\t\t\t:rowIndex=\"tableData.modal.rowIndex\"\r\n\t\t\t\t\t\t:tableid=\"tableData.id\"\r\n\t\t\t\t\t\tv-bind=\"tableData.modal.componentProps\" />\r\n\t\t\t\t</template>\r\n\t\t\t</ATableModal>\r\n\t\t</slot>\r\n\t</table>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { v4 } from 'uuid'\r\nimport { nextTick, provide, watch } from 'vue'\r\n\r\nimport { TableColumn, TableConfig, TableRow } from 'types'\r\nimport TableDataStore from '.'\r\nimport ACell from '@/components/ACell.vue'\r\nimport ARow from '@/components/ARow.vue'\r\nimport ATableHeader from '@/components/ATableHeader.vue'\r\nimport ATableModal from '@/components/ATableModal.vue'\r\n\r\nconst props = withDefaults(\r\n\tdefineProps<{\r\n\t\tid?: string\r\n\t\tmodelValue: TableRow[]\r\n\t\tcolumns: TableColumn[]\r\n\t\trows?: TableRow[]\r\n\t\tconfig?: TableConfig\r\n\t\ttableid?: string\r\n\t}>(),\r\n\t{\r\n\t\trows: () => [],\r\n\t\tconfig: () => new Object(),\r\n\t}\r\n)\r\n\r\nconst emit = defineEmits(['update:modelValue'])\r\n\r\nlet rows = props.modelValue ? props.modelValue : props.rows\r\n\r\nlet tableData = new TableDataStore(props.id, props.columns, rows, props.config)\r\nprovide(tableData.id, tableData)\r\n\r\nwatch(\r\n\t() => tableData.rows,\r\n\tnewValue => {\r\n\t\temit('update:modelValue', newValue)\r\n\t},\r\n\t{ deep: true }\r\n)\r\n\r\nconst formatCell = (event?: KeyboardEvent, column?: TableColumn, cellData?: any) => {\r\n\tlet colIndex: number\r\n\tconst target = event?.target as HTMLTableCellElement\r\n\tif (event) {\r\n\t\tcolIndex = target.cellIndex + (tableData.zeroColumn ? -1 : 0)\r\n\t} else if (column && cellData) {\r\n\t\tcolIndex = tableData.columns.indexOf(column)\r\n\t}\r\n\r\n\tif (!column && 'format' in tableData.columns[colIndex]) {\r\n\t\t// TODO: (utils) create helper to extract format from string\r\n\t\tconst format = tableData.columns[colIndex].format\r\n\t\tif (typeof format === 'function') {\r\n\t\t\treturn format(target.innerHTML)\r\n\t\t} else if (typeof format === 'string') {\r\n\t\t\t// parse format function from string\r\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-implied-eval\r\n\t\t\tconst formatFn: (args: any) => any = Function(`\"use strict\";return (${format})`)()\r\n\t\t\treturn formatFn(target.innerHTML)\r\n\t\t} else {\r\n\t\t\treturn target.innerHTML\r\n\t\t}\r\n\t} else if (cellData && 'format' in column) {\r\n\t\tconst format = column.format\r\n\t\tif (typeof format === 'function') {\r\n\t\t\treturn format(cellData)\r\n\t\t} else if (typeof format === 'string') {\r\n\t\t\t// parse format function from string\r\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-implied-eval\r\n\t\t\tconst formatFn: (args: any) => any = Function(`\"use strict\";return (${format})`)()\r\n\t\t\treturn formatFn(cellData)\r\n\t\t} else {\r\n\t\t\treturn cellData\r\n\t\t}\r\n\t} else if (cellData && column.type.toLowerCase() in ['int', 'decimal', 'float', 'number', 'percent']) {\r\n\t\treturn cellData\r\n\t\t// TODO: number formatting\r\n\t} else {\r\n\t\treturn cellData\r\n\t}\r\n}\r\n\r\n// const moveCursorToEnd = (target: HTMLElement) => {\r\n// \ttarget.focus()\r\n// \tdocument.execCommand('selectAll', false, null)\r\n// \tdocument.getSelection().collapseToEnd()\r\n// }\r\n\r\nconst clickOutside = (event: MouseEvent) => {\r\n\tif (!tableData.modal.parent?.contains(event.target as HTMLElement)) {\r\n\t\tif (tableData.modal.visible) {\r\n\t\t\t// call set data\r\n\t\t\ttableData.modal.visible = false\r\n\t\t}\r\n\t}\r\n}\r\n\r\nwindow.addEventListener('click', clickOutside)\r\nwindow.addEventListener('keydown', (event: KeyboardEvent) => {\r\n\tif (event.key === 'Escape') {\r\n\t\tif (tableData.modal.visible) {\r\n\t\t\ttableData.modal.visible = false\r\n\r\n\t\t\t// focus on the parent cell again\r\n\t\t\tconst $parent = tableData.modal.parent\r\n\t\t\tif ($parent) {\r\n\t\t\t\t// wait for the modal to close\r\n\t\t\t\tvoid nextTick().then(() => {\r\n\t\t\t\t\t// for some reason, the parent is not immediately visible in the DOM;\r\n\t\t\t\t\t// re-fetching the cell to add focus instead\r\n\t\t\t\t\tconst rowIndex = $parent.dataset.rowindex\r\n\t\t\t\t\tconst colIndex = $parent.dataset.colindex\r\n\t\t\t\t\tconst $parentCell = document.querySelectorAll(`[data-rowindex='${rowIndex}'][data-colindex='${colIndex}']`)\r\n\t\t\t\t\tif ($parentCell) {\r\n\t\t\t\t\t\t;($parentCell[0] as HTMLTableCellElement).focus()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n@import url('@stonecrop/themes/default/default.css');\r\n\r\ntable {\r\n\tdisplay: table;\r\n\tborder-collapse: collapse;\r\n\tcaret-color: var(--brand-color);\r\n}\r\n\r\ntable.atable,\r\n.atable {\r\n\tfont-family: var(--atable-font-family);\r\n\t-webkit-font-smoothing: antialiased;\r\n\t-moz-osx-font-smoothing: grayscale;\r\n\tfont-size: var(--table-font-size);\r\n\tborder-collapse: collapse;\r\n}\r\n\r\nth {\r\n\tbox-sizing: border-box;\r\n\tbackground-color: var(--brand-color);\r\n\tborder-width: 1px;\r\n\tborder-style: solid;\r\n\tborder-color: var(--header-border-color);\r\n\tborder-radius: 0px;\r\n\tcolor: var(--header-text-color);\r\n}\r\n</style>\r\n","import { App } from 'vue'\r\n\r\nimport ACell from '@/components/ACell.vue'\r\nimport AExpansionRow from '@/components/AExpansionRow.vue'\r\nimport ARow from '@/components/ARow.vue'\r\nimport ATable from '@/components/ATable.vue'\r\nimport ATableHeader from '@/components/ATableHeader.vue'\r\nimport ATableModal from '@/components/ATableModal.vue'\r\nimport TableDataStore from './components'\r\n\r\nfunction install(app: App /* options */) {\r\n\tapp.component('ACell', ACell)\r\n\tapp.component('AExpansionRow', AExpansionRow)\r\n\tapp.component('ARow', ARow)\r\n\tapp.component('ATable', ATable)\r\n\tapp.component('ATableHeader', ATableHeader)\r\n\tapp.component('ATableModal', ATableModal)\r\n}\r\n\r\nexport { install, ACell, AExpansionRow, ARow, ATable, ATableHeader, ATableModal, TableDataStore }\r\n"],"names":["v","M","F","e","j","H","Q","q","G","U","K","y","t","r","N","z","n","o","l","s","c","a","g","p","i","C","D","d","O","T","J","B","P","X","I","Y","Z","_","ee","f","u","A","E","ne","w","x","re","k","h","S","b","L","R","m","oe","le","ie","$","W","V","props","__props","tableData","inject","cell","ref","cellModified","displayValue","computed","data","format","handleInput","event","domRect","cellWidth","handlers","defaultKeypressHandlers","useKeyboardNav","textAlign","currentData","onFocus","onChange","getIndent","colKey","indent","cellStyle","_a","rowEl","rowExpanded","getRowExpandSymbol","keyboardNav","numberedRowWidth","rowVisible","toggleRowExpand","rowIndex","getRandomValues","rnds8","rng","byteToHex","unsafeStringify","arr","offset","native","v4","options","buf","rnds","TableDataStore","id","columns","rows","config","table","display","reactive","colIndex","column","row","defaultDisplay","parents","value","col","index","getHeaderCellStyle","emit","__emit","provide","watch","newValue","clickOutside","$parent","nextTick","$parentCell","install","app","ACell","AExpansionRow","ARow","ATable","ATableHeader","ATableModal"],"mappings":"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","x_google_ignoreList":[4,5,6,7]}